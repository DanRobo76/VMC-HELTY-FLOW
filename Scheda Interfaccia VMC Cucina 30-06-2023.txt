type: vertical-stack
cards:
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state_not: ON-Line
    card:
      type: entities
      entities:
        - entity: sensor.vmc_cucina_nome_status
          secondary_info: last-updated
        - entity: sensor.vmc_cucina_status_ip_interfaccia
          secondary_info: last-updated
        - entity: sensor.vmc_cucina_ip
          secondary_info: last-updated
        - entity: script.vmc_cucina_upgrade_sensors
          secondary_info: last-updated
      state_color: true
      show_header_toggle: false
      title: Ventilazione Meccanica Controllata
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
      - entity: sensor.vmc_cucina_alert_monitoraggio_offset_tutti_min
        state: NOT OK
    card:
      type: markdown
      content: >-
        {% if
        is_state('sensor.vmc_cucina_alert_monitoraggio_offset_tutti_min','NOT
        OK') and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+2"><strong> ALLERTA OFFSET MINIMI</strong></font>

        Valore Offset Minimo settato per la Temeratura Esterna: {{
        state_attr('input_number.vmc_cucina_offset_temp_esterna', 'min') |
        float  }}

        Valore Offset Minimo settato per la Temperatura Interna: {{
        state_attr('input_number.vmc_cucina_offset_temp_interna', 'min') |
        float  }}

        Valore Offset Minimo settato per l' Umidità Esterna: {{
        state_attr('input_number.vmc_cucina_offset_umidita_esterna', 'min') |
        float  }}

        Valore Offset Minimo settato per l' Umidità Interna: {{
        state_attr('input_number.vmc_cucina_offset_umidita_interna', 'min') |
        float  }}


        {% elif
        is_state('sensor.vmc_cucina_alert_monitoraggio_offset_tutti_min','OK')
        and is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')%}
         <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA OFFSET</strong></font>
                 
        Valore Offset settato per la Temeratura Esterna: {{
        states('input_number.vmc_cucina_offset_temp_esterna') | float  }}

        Valore Offset settato per la Temperatura Interna: {{
        states('input_number.vmc_cucina_offset_temp_interna') | float  }}

        Valore Offset settato per l' Umidità Esterna: {{
        states('input_number.vmc_cucina_offset_umidita_esterna') | float  }}

        Valore Offset settato per l' Umidità Interna: {{
        states('input_number.vmc_cucina_offset_umidita_interna') | float  }}


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_umidita_interna_status
        state: '[Non Calcolabile]'
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_cucina_umidita_interna_status','[Non
        Calcolabile]') and
        is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' NON CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] NON CALCOLABILE
         - Umidità Assoluta [g/m³] NON CALCOLABILE       
        {% elif states('sensor.vmc_cucina_umidita_interna_status')!='[Non
        Calcolabile]' and is_state('sensor.vmc_cucina_status_ip_interfaccia',
        'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] CALCOLABILE
         - Umidità Assoluta [g/m³] CALCOLABILE  
        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_umidita_esterna_status
        state: '[Non Calcolabile]'
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_cucina_umidita_esterna_status','[Non
        Calcolabile]') and
        is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' ESTERNA NON CALCOLABILE</strong></font>
         - Punto di Rugiada Esterno [°C] NON CALCOLABILE
         - Umidità Assoluta Esterna [g/m³] NON CALCOLABILE      
        {% elif states('sensor.vmc_cucina_umidita_esterna_status')!='[Non
        Calcolabile]' and is_state('sensor.vmc_cucina_status_ip_interfaccia',
        'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' ESTERNA CALCOLABILE</strong></font>
         - Punto di Rugiada Esterno [°C] CALCOLABILE
         - Umidità Assoluta Esterna [g/m³] CALCOLABILE
        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_alert_monitoraggio_umidita
        state: Allerta
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_cucina_alert_monitoraggio_umidita','Allerta')
        and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_cucina_umidita_interna_status_verifica_soglia_valore')!='[Non
        Calcolabile]' %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>
                    
        {{states('sensor.vmc_cucina_umidita_interna_status_verifica_soglia_valore')}}


        {% elif is_state('sensor.vmc_cucina_alert_monitoraggio_umidita','Nessuna
        Allerta') and is_state('sensor.vmc_cucina_status_ip_interfaccia',
        'ON-Line') and
        states('sensor.vmc_cucina_umidita_interna_status_verifica_soglia_valore')!='[Non
        Calcolabile]'%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA UMIDITA'</strong></font>
                  
        {{states('sensor.vmc_cucina_umidita_interna_status_verifica_soglia_valore')}}


        {% elif is_state('sensor.vmc_cucina_alert_monitoraggio_umidita','Nessuna
        Allerta') and
        is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_cucina_umidita_interna_status_verifica_soglia_valore')=='[Non
        Calcolabile]' %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' NON CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] NON CALCOLABILE
         - Umidità Assoluta [g/m³] NON CALCOLABILE
        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_alert_monitoraggio_pdr
        state: Allerta
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-

        {% if states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto') ==
        "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
        =='on' and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_cucina_status_ventola_lettura_codice_interpretato')
        != "Velocità 0") %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>ARRESTO DELLA VMC</strong>


        RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ PRECEDENTEMENTE IMPOSTATA,
        NON APPENA:
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_cucina_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_cucina_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_cucina_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        ALTRIMENTI, VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO L'ARRESTO
        DELLA VMC.


        {% elif states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
        =='on' and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_cucina_status_ventola_lettura_codice_interpretato')
        == "Velocità 0")  and
        (states('input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>ARRESTO DELLA VMC</strong>


        RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ PRECEDENTEMENTE IMPOSTATA,
        NON APPENA:
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_cucina_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_cucina_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_cucina_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        ALTRIMENTI, VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO L'ARRESTO
        DELLA VMC.



        {% elif states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
        =='on' and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_cucina_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio')
        =='off')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC.</strong>



        {% elif states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_cucina_status_ventola_lettura_codice_interpretato')
        != "Velocità 0")%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI ARRESTARE LA VMC NEL CASO IN CUI NON SIA GIÀ
        STATA ARRESTATA A CAUSA DI ALTRE ALLERTE.</strong>


        {% elif states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_cucina_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio')
        =='off')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC.</strong>


        {% elif states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')
        == "Si può impiegare" and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA PER SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>

        {{
        states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto_valore')}}


        {% elif states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')
        == "[Non Calcolabile]" and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> LIM. Δ PUNTO DI RUGIADA NON CALCOLABILE</strong></font>

        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_alert_monitoraggio_congelamento
        state: Allerta
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if
        is_state('sensor.vmc_cucina_alert_monitoraggio_congelamento','Allerta')
        and is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line') %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+2"><strong> ALLERTA CONGELAMENTO</strong></font>

        {{states('sensor.vmc_cucina_congelamento_verifica_soglia_valore')}}


        {% elif
        is_state('sensor.vmc_cucina_alert_monitoraggio_congelamento','Nessuna
        Allerta') and is_state('sensor.vmc_cucina_status_ip_interfaccia',
        'ON-Line')%}
         <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA CONGELAMENTO</strong></font>
                 
        {{states('sensor.vmc_cucina_congelamento_verifica_soglia_valore')}}


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_alert_monitoraggio_delta
        state: Allerta
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_cucina_alert_monitoraggio_delta', 'Allerta')
        and is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA DIFF. TEMP. (INT-EST) > 23 °C</strong></font>

        {{states('sensor.vmc_cucina_delta_temp_verifica_soglia_valore')}}

        {% elif is_state('sensor.vmc_cucina_alert_monitoraggio_delta', 'Nessuna
        Allerta') and
        is_state('sensor.vmc_cucina_status_ip_interfaccia','ON-Line')%}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA DIFF. TEMP. (INT-EST) > 23 °C</strong></font>


        {{states('sensor.vmc_cucina_delta_temp_verifica_soglia_valore')}}


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: >-
          sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling_smart_allert_senza_programmazione
        state: NOT OK
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
      - entity: >-
          input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
        state: 'off'
      - entity: >-
          input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
        state: 'off'
    card:
      type: markdown
      content: >
        <!-- ALLERTA FREE HEATING E NESSUNA ALLERTA FREE COOLING [ESCLUSA LA
        VERIFICA VMC ON/OFF IN FUNZIONE DELLA VELOCITA' FREE HEATING, VELOCITA'
        FREE HEATING IN FUNZIONE, MESE PROGRAMMATO IN FREE HEATING ] -->

        {% if
        is_state('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling',
        'Allerta Raffrescamento in atto') and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RAFFRESCAMENTO IN ATTO</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI ARRESTARE LA VMC O DI CAMBIARE
        VELOCITA'</strong>





        <!-- ALLERTA FREE COOLING E NESSUNA ALLERTA FREE HEATING  [ESCLUSA LA
        VERIFICA VMC ON/OFF IN FUNZIONE DELLA VELOCITA' FREE COOLING, VELOCITA'
        FREE COOLING IN FUNZIONE, MESE PROGRAMMATO IN FREE COOLING] -->

        {% elif
        is_state('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling','Allerta
        Riscaldamento in atto') and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RISCALDAMENTO IN ATTO</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI ARRESTARE LA VMC O DI CAMBIARE
        VELOCITA'</strong>





        <!-- ALLERTA FREE HEATING E NESSUNA ALLERTA FREE COOLING  [ESCLUSA LA
        VERIFICA VMC ON/OFF IN FUNZIONE DELLA VELOCITA' FREE HEATING, VELOCITA'
        FREE HEATING IN FUNZIONE, MESE NON PROGRAMMATO IN FREE HEATING] -->

        {% elif
        is_state('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling',
        'Raffrescamento in atto') and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RAFFRESCAMENTO IN ATTO</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI ARRESTARE LA VMC O DI CAMBIARE
        VELOCITA'</strong>



        <!-- ALLERTA FREE COOLING E NESSUNA ALLERTA FREE HEATING  [ESCLUSA LA
        VERIFICA VMC ON/OFF IN FUNZIONE DELLA VELOCITA' FREE COOLING, VELOCITA'
        FREE COOLING IN FUNZIONE, MESE NON PROGRAMMATO IN FREE COOLING] -->

        {% elif
        is_state('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling','Riscaldamento
        in atto') and is_state('sensor.vmc_cucina_status_ip_interfaccia',
        'ON-Line')%}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RISCALDAMENTO IN ATTO</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI ARRESTARE LA VMC O DI CAMBIARE
        VELOCITA'</strong>





        <!-- ALLERTA FREE HEATING E NESSUNA ALLERTA FREE COOLING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif
        (states('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling')
        != "Allerta Raffrescamento in atto") and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')
        != "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE HEATING" and
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')
        == "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE COOLING" %}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]





        <!-- ALLERTA FREE COOLING E NESSUNA ALLERTA FREE HEATING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif
        (states('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling')
        != "Allerta Raffrescamento in atto") and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')
        == "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE HEATING" and
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')
        != "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE COOLING" %}


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MINORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]



        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]





        <!-- ALLERTA FREE HEATING E NESSUNA ALLERTA FREE COOLING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif
        (states('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling')
        != "Allerta Riscaldamento in atto") and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')
        == "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE COOLING" and
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')
        != "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE HEATING" %}


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]





        <!-- ALLERTA FREE COOLING NESSUNA ALLERTA FREE HEATING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif
        (states('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling')
        != "Allerta Riscaldamento in atto") and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')
        != "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE COOLING" and
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')
        == "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE HEATING" %}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MINORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]





        <!-- NESSUNA ALLERTA FREE HEATING E FREE COOLING [INDIPENDENTEMENTE
        DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif
        (states('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling')
        != "Allerta Raffrescamento in atto") and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')
        == "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE HEATING" and
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')
        == "NESSUNA ALLERTA PER IMPIEGO DELLA VELOCITÀ FREE COOLING" %}


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}</strong></font>


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]




        <!-- OFF LINE -->

        {% else %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:help-circle-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+0"> STATO NON
        DISPONIBILE</font>

        {% endif %}
  - type: conditional
    conditions:
      - entity: >-
          input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
        state: 'on'
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if  is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and
        states('input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
        %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RISCALDAMENTO</strong></font></br></br>


        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C]
                    
        RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:
          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA;
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO;
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING;

        , DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC.



        <!-- NESSUNA ALLERTA FREE COOLING PROGRAMMATO E NESSUNA ALLERTA FREE
        HEATING PROGRAMMATO [INDIPENDENTEMENTE DALLA VELOCITA', PROGRAMMAZIONE
        DEL MESE: FREE COOLING] -->

        {% elif (states('sensor.vmc_cucina_temp_interna_status') | float(0) ==
        states('sensor.vmc_cucina_temp_esterna_status') | float(0))  and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')=="Free
        Cooling"%}


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]




        <!-- ALLERTA FREE HEATING PROGRAMMATO E NESSUNA ALLERTA FREE COOLING
        [INDIPENDENTEMENTE DALLA VELOCITA', PROGRAMMAZIONE DEL MESE: FREE
        COOLING] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_interna_status') | float(0) > 
        states('sensor.vmc_cucina_temp_esterna_status') | float(0)) and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')=="Free
        Cooling"%}


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]




        <!-- ALLERTA FREE COOLING E NESSUNA ALLERTA FREE HEATING
        [INDIPENDENTEMENTE DALLA VELOCITA', PROGRAMMAZIONE DEL MESE: FREE
        COOLING] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_esterna_status') | float(0) >
        states('sensor.vmc_cucina_temp_interna_status') | float(0)) and 
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')=="Free
        Cooling" %}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_programmato_senza_velocita')}}</strong></font>


        <font color="rgb(100, 100, 100)">LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]
















        <!-- ALLERTA FREE HEATING NON PROGRAMMATO E NESSUNA ALLERTA FREE COOLING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_interna_status') | float(0) > 
        states('sensor.vmc_cucina_temp_esterna_status') | float(0)) and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')!="Free
        Cooling"%}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>VELOCITA'
        FREE COOLING NON PROGRAMMATA</strong></font>


        <font color="rgb(128, 0, 128)">{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}


        <font color="rgb(128, 0, 128)">LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]






        <!-- ALLERTA FREE COOLING NON E NESSUNA ALLERTA FREE HEATING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_esterna_status') | float(0) >
        states('sensor.vmc_cucina_temp_interna_status') | float(0)) and 
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')!="Free
        Cooling" %}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>VELOCITA'
        FREE COOLING NON PROGRAMMATA</strong></font>


        {{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]



        <!-- NESSUNA ALLERTA FREE COOLING PROGRAMMATO E NESSUNA ALLERTA FREE
        HEATING PROGRAMMATO [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA
        PROGRAMMAZIONE DEL MESE] -->

        {% elif (states('sensor.vmc_cucina_temp_interna_status') | float(0) ==
        states('sensor.vmc_cucina_temp_esterna_status') | float(0))  and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')!="Free
        Cooling"%}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>VELOCITA'
        FREE COOLING NON PROGRAMMATA</strong></font>


        <font color="rgb(128, 0, 128)">{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_cooling_non_programmato_senza_velocita')}}


        <font color="rgb(128, 0, 128)">LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]










        <!-- OFF LINE -->

        {% else %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:help-circle-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+0"> STATO NON
        DISPONIBILE</font>

        {% endif %}
  - type: conditional
    conditions:
      - entity: >-
          input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
        state: 'on'
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if  is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and(states('input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA RAFFRESCAMENTO</strong></font></br></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C]


        RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:
          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA;
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO;
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING;

        , DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC.





        <!-- NESSUNA ALLERTA FREE COOLING PROGRAMMATO E NESSUNA ALLERTA FREE
        HEATING PROGRAMMATO [INDIPENDENTEMENTE DALLA VELOCITA', PROGRAMMAZIONE
        DEL MESE: FREE HEATING] -->

        {% elif (states('sensor.vmc_cucina_temp_interna_status') | float(0) ==
        states('sensor.vmc_cucina_temp_esterna_status') | float(0))  and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')=="Free
        Heating"%}


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]




        <!-- ALLERTA FREE HEATING PROGRAMMATO E NESSUNA ALLERTA FREE COOLING
        [INDIPENDENTEMENTE DALLA VELOCITA', PROGRAMMAZIONE DEL MESE: FREE
        HEATING] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_interna_status') | float(0) > 
        states('sensor.vmc_cucina_temp_esterna_status') | float(0)) and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')=="Free
        Heating"%}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_programmato_senza_velocita')}}</strong></font>


        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]


        <!-- ALLERTA FREE COOLING E NESSUNA ALLERTA FREE HEATING
        [INDIPENDENTEMENTE DALLA VELOCITA', PROGRAMMAZIONE DEL MESE: FREE
        HEATING] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_esterna_status') | float(0) >
        states('sensor.vmc_cucina_temp_interna_status') | float(0)) and 
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')=="Free
        Heating" %}


        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_programmato_senza_velocita')}}</strong></font>


        <font color="rgb(128, 0, 128)">LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MINORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]
















        <!-- ALLERTA FREE HEATING NON PROGRAMMATO E NESSUNA ALLERTA FREE COOLING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_interna_status') | float(0) > 
        states('sensor.vmc_cucina_temp_esterna_status') | float(0)) and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')!="Free
        Heating"%}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>VELOCITA'
        FREE HEATING NON PROGRAMMATA</strong></font>


        <font color="rgb(100, 100, 100)">{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}


        <font color="rgb(100, 100, 100)">LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]






        <!-- ALLERTA FREE COOLING NON E NESSUNA ALLERTA FREE HEATING
        [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA PROGRAMMAZIONE DEL MESE] -->

        {% elif is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line')
        and (states('sensor.vmc_cucina_temp_esterna_status') | float(0) >
        states('sensor.vmc_cucina_temp_interna_status') | float(0)) and 
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')!="Free
        Heating" %}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>VELOCITA'
        FREE HEATING NON PROGRAMMATA</strong></font>


        <font color="rgb(128, 0, 128)">{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}


        <font color="rgb(128, 0, 128)">LA TEMPERATURA INTERNA {{
        states('sensor.vmc_cucina_temp_interna_status')}} [°C] È MINORE DELLA
        TEMPERATURA ESTERNA {{ states('sensor.vmc_cucina_temp_esterna_status')}}
        [°C]






        <!-- NESSUNA ALLERTA FREE COOLING PROGRAMMATO E NESSUNA ALLERTA FREE
        HEATING PROGRAMMATO [INDIPENDENTEMENTE DALLA VELOCITA' O DALLA
        PROGRAMMAZIONE DEL MESE] -->

        {% elif (states('sensor.vmc_cucina_temp_interna_status') | float(0) ==
        states('sensor.vmc_cucina_temp_esterna_status') | float(0))  and
        is_state('sensor.vmc_cucina_status_ip_interfaccia', 'ON-Line') and
        states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling')!="Free
        Heating"%}


        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>VELOCITA'
        FREE HEATING NON PROGRAMMATA</strong></font>


        <font color="rgb(128, 0, 128)">{{
        states('sensor.vmc_cucina_alert_monitoraggio_free_heating_non_programmato_senza_velocita')}}


        <font color="rgb(128, 0, 128)">LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_cucina_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_cucina_temp_interna_status')}}
        [°C]










        <!-- OFF LINE -->

        {% else %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:help-circle-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+0"> STATO NON
        DISPONIBILE</font>

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_cucina_status_ip_interfaccia
        state: ON-Line
    card:
      type: vertical-stack
      cards:
        - type: entities
          entities:
            - entity: sensor.vmc_cucina_nome_status
              secondary_info: last-updated
            - entity: >-
                sensor.vmc_cucina_status_ventola_lettura_codice_interpretato_interfaccia
              secondary_info: last-updated
            - entity: sensor.vmc_cucina_spia_pannello_alert_monitoraggio_totale
              secondary_info: last-updated
          state_color: true
          show_header_toggle: true
          title: Ventilazione Meccanica Controllata
          footer:
            type: buttons
            entities:
              - entity: input_boolean.vmc_cucina_opzioni_vmc
              - entity: input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
              - entity: input_boolean.vmc_cucina_opzioni_interruttore_calendario
              - entity: input_boolean.vmc_cucina_opzioni_offset_sensori
              - entity: input_boolean.vmc_cucina_opzioni_lettura_sensori
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_cucina_opzioni_vmc
              state: 'on'
          card:
            square: false
            type: grid
            cards:
              - square: false
                type: grid
                cards:
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_sensori_off
                      target: {}
                    name: Sensori Off
                    show_state: true
                    icon: mdi:chip
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_sensori_on
                      target: {}
                    name: Sensori On
                    show_state: true
                    icon: mdi:chip
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_pannello_led_off
                      target: {}
                    name: Led Pannello Off
                    show_state: true
                    icon: mdi:led-off
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_pannello_led_on
                      target: {}
                    name: Led Pannello On
                    show_state: true
                    icon: mdi:led-on
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_velocita_0
                      target: {}
                    show_state: true
                    name: Velocità 0
                    icon: mdi:numeric-0-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_velocita_1
                      target: {}
                    name: Velocità 1
                    show_state: true
                    icon: mdi:numeric-1-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_velocita_2
                      target: {}
                    name: Velocità 2
                    show_state: true
                    icon: mdi:numeric-2-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_velocita_3
                      target: {}
                    name: Velocità 3
                    show_state: true
                    icon: mdi:numeric-3-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_velocita_4
                      target: {}
                    name: Velocità 4
                    show_state: true
                    icon: mdi:numeric-4-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_notturna
                      target: {}
                    name: Notturna
                    show_state: true
                    icon: mdi:weather-night
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_iperventilazione
                      target: {}
                    name: Iperventilazione
                    show_state: true
                    icon: mdi:wind-power
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_cucina_freecooling
                      target: {}
                    name: Free Cool./Heat.
                    show_state: true
                    icon: mdi:sun-snowflake-variant
                    hold_action:
                      action: none
                columns: 4
              - type: horizontal-stack
                cards:
                  - type: entities
                    entities:
                      - entity: >-
                          sensor.vmc_cucina_status_sensori_lettura_codice_interpretato
                        secondary_info: last-updated
                      - entity: >-
                          sensor.vmc_cucina_status_led_pannello_lettura_codice_interpretato
                        secondary_info: last-updated
                      - entity: sensor.vmc_cucina_status_calcolo_portata_ventola
                        secondary_info: last-updated
                      - entity: >-
                          sensor.vmc_cucina_status_portata_ventola_lettura_codice_interpretato
                        secondary_info: last-updated
            columns: 1
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: sensor.vmc_cucina_temp_esterna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_cucina_temp_interna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_cucina_umidita_esterna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_cucina_umidita_interna_status
                    secondary_info: last-updated
                  - entity: script.vmc_cucina_upgrade_sensors
                title: Sensori
                footer:
                  type: buttons
                  entities:
                    - entity: >-
                        input_boolean.vmc_cucina_opzioni_interruttore_offset_sensori
                    - entity: >-
                        input_boolean.vmc_cucina_opzioni_interruttore_monitoraggio_sensori_extra
                state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_cucina_opzioni_interruttore_offset_sensori
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_number.vmc_cucina_offset_temp_esterna
                          secondary_info: last-updated
                        - entity: input_number.vmc_cucina_offset_temp_interna
                          secondary_info: last-updated
                        - entity: input_number.vmc_cucina_offset_umidita_esterna
                          secondary_info: last-updated
                        - entity: input_number.vmc_cucina_offset_umidita_interna
                          secondary_info: last-updated
                        - entity: script.vmc_cucina_azzera_offset_sensors
                          secondary_info: last-triggered
                      title: Sensori - Offset
                      state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_cucina_opzioni_interruttore_monitoraggio_sensori_extra
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: sensor.vmc_cucina_punto_di_rugiada_esterno
                          secondary_info: last-updated
                        - entity: sensor.vmc_cucina_punto_di_rugiada_interno
                          secondary_info: last-updated
                        - entity: sensor.vmc_cucina_umidita_assoluta_esterna
                          secondary_info: last-updated
                        - entity: sensor.vmc_cucina_umidita_assoluta_interna
                          secondary_info: last-updated
                      title: Sensori - Extra
                      state_color: true
                    - type: vertical-stack
                      cards:
                        - type: entities
                          entities:
                            - entity: >-
                                sensor.vmc_cucina_temp_esterna_status_senza_offset
                              secondary_info: last-updated
                            - entity: >-
                                sensor.vmc_cucina_temp_interna_status_senza_offset
                              secondary_info: last-updated
                            - entity: >-
                                sensor.vmc_cucina_umidita_esterna_status_senza_offset
                              secondary_info: last-updated
                            - entity: >-
                                sensor.vmc_cucina_umidita_interna_status_senza_offset
                              secondary_info: last-updated
                          title: Sensori - Offset Disabilitato
                          state_color: true
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_cucina_opzioni_interruttore_calendario
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: >-
                      sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2_interfaccia
                    secondary_info: last-updated
                title: Programmazione Giornaliera
                state_color: true
              - type: entities
                entities:
                  - entity: >-
                      sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling
                    secondary_info: last-updated
                state_color: true
                title: Programmazione Mensile
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_cucina_opzioni_offset_sensori
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: input_number.vmc_cucina_volume_da_inserire
                    secondary_info: last-updated
                  - entity: automation.automazione_vmc_cucina
                    secondary_info: last-triggered
                  - entity: input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi
                    secondary_info: last-updated
                  - entity: script.vmc_cucina_profilo_inizializzazione
                    secondary_info: last-updated
                state_color: true
                title: Opzioni
                footer:
                  type: buttons
                  entities:
                    - entity: input_boolean.vmc_cucina_opzioni_punto_di_rugiada
                    - entity: input_boolean.vmc_cucina_opzioni_calendario_main
                    - entity: >-
                        input_boolean.vmc_cucina_opzioni_free_heating_o_free_cooling
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_cucina_opzioni_punto_di_rugiada
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_number.vmc_cucina_offset_verifica_impiego_vmc
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr
                          secondary_info: last-updated
                        - entity: script.vmc_cucina_profilo_pdr
                          secondary_info: last-updated
                      state_color: true
                      title: Opzioni - Punto di Rugiada
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_cucina_opzioni_calendario_main
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_select.vmc_cucina_speed_1_fascia_calendario
                        - entity: input_select.vmc_cucina_speed_2_fascia_calendario
                        - entity: >-
                            input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario
                          secondary_info: last-updated
                        - entity: script.vmc_cucina_profilo_calendario
                          secondary_info: last-updated
                      footer:
                        type: buttons
                        entities:
                          - entity: input_boolean.vmc_cucina_opzioni_calendario
                      title: Opzioni - Calendario
                      state_color: true
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_cucina_opzioni_calendario
                    state: 'on'
                card:
                  square: true
                  columns: 2
                  type: grid
                  cards:
                    - type: entities
                      entities:
                        - entity: input_datetime.vmc_cucina_accensione_lunedi
                        - entity: input_datetime.vmc_cucina_accensione_lunedi_2
                        - entity: input_datetime.vmc_cucina_accensione_martedi
                        - entity: input_datetime.vmc_cucina_accensione_martedi_2
                        - entity: input_datetime.vmc_cucina_accensione_mercoledi
                        - entity: input_datetime.vmc_cucina_accensione_mercoledi_2
                        - entity: input_datetime.vmc_cucina_accensione_giovedi
                        - entity: input_datetime.vmc_cucina_accensione_giovedi_2
                        - entity: input_datetime.vmc_cucina_accensione_venerdi
                        - entity: input_datetime.vmc_cucina_accensione_venerdi_2
                        - entity: input_datetime.vmc_cucina_accensione_sabato
                        - entity: input_datetime.vmc_cucina_accensione_sabato_2
                        - entity: input_datetime.vmc_cucina_accensione_domenica
                        - entity: input_datetime.vmc_cucina_accensione_domenica_2
                      title: Accensione
                      state_color: true
                    - type: entities
                      entities:
                        - entity: input_datetime.vmc_cucina_spegnimento_lunedi
                        - entity: input_datetime.vmc_cucina_spegnimento_lunedi_2
                        - entity: input_datetime.vmc_cucina_spegnimento_martedi
                        - entity: input_datetime.vmc_cucina_spegnimento_martedi_2
                        - entity: input_datetime.vmc_cucina_spegnimento_mercoledi
                        - entity: input_datetime.vmc_cucina_spegnimento_mercoledi_2
                        - entity: input_datetime.vmc_cucina_spegnimento_giovedi
                        - entity: input_datetime.vmc_cucina_spegnimento_giovedi_2
                        - entity: input_datetime.vmc_cucina_spegnimento_venerdi
                        - entity: input_datetime.vmc_cucina_spegnimento_venerdi_2
                        - entity: input_datetime.vmc_cucina_spegnimento_sabato
                        - entity: input_datetime.vmc_cucina_spegnimento_sabato_2
                        - entity: input_datetime.vmc_cucina_spegnimento_domenica
                        - entity: input_datetime.vmc_cucina_spegnimento_domenica_2
                      title: Spegnimento
                      state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_cucina_opzioni_free_heating_o_free_cooling
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_select.vmc_cucina_mese_1_fascia_freeheating
                        - entity: input_select.vmc_cucina_mese_2_fascia_freeheating
                        - entity: input_select.vmc_cucina_mese_1_fascia_freecooling
                        - entity: input_select.vmc_cucina_mese_2_fascia_freecooling
                        - entity: >-
                            input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_freeheating
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_freecooling
                          secondary_info: last-updated
                        - entity: script.vmc_cucina_profilo_free_heating_cooling
                          secondary_info: last-updated
                      title: Opzioni - Free Heating / Free Cooling
                      state_color: true
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_cucina_opzioni_lettura_sensori
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: markdown
                content: >-
                  <pre style="font-size:6px; background-color: #d9ffcc;">

                  <ha-icon icon="mdi:hvac"></ha-icon><strong> VMC HELTY FLOW
                  PLUS</strong> by Ing. Danilo Robotti    
                      - Codice YAML Release 30-06-2023 
                      - Scheda Interfaccia Release 30-06-2023
                      - Automazione Release 30-06-2023

                  <ha-icon icon="mdi:email-fast"></ha-icon> <a
                  href="mailto:danilo.robotti@gmail.com">Mail</a> <ha-icon
                  icon="mdi:human-handsup"></ha-icon><a
                  href="https://github.com/DanRobo76/VMC-HELTY-FLOW">Aggiornamenti</a><br>

                  <ha-icon icon="mdi:file-sign"></ha-icon> <strong>Esonero di
                  Responsabilità:</strong> 

                  In nessun caso lo sviluppatore sarà responsabile 

                  di danneggiamenti diretti, indiretti o conseguenti

                  , correlati a difetti del presente SoftWare. 

                  Il Cliente ha l’onere e la responsabilità della 

                  scelta, dell’installazione,  dell’uso e della 

                  gestione del SoftWare al fine del raggiungimento 

                  del  risultato prefissatosi.


                  <ha-icon icon="mdi:human-greeting-variant"></ha-icon>
                  <strong>Ringraziamenti</strong> <a
                  href="https://www.paypal.com/donate/?business=YU9379GL8VDW4&amount=1.2&no_recurring=1&item_name=Se+il+progetto+ti+%C3%A8+piaciuto%2C++offrimi+un+GinSeng%21+%0A%3B%29&currency_code=EUR">Ginseng</a>
                  <ha-icon icon="mdi:tag-faces"></ha-icon> 

                  Grazie di cuore per ogni singolo Ginseng gustato! 

                  Apprezzo immensamente il vostro sostegno e la 

                  vostra generosità.

                  </pre>

                  <br>


                  ### **Info Lettura Dati nella VMC**


                  <strong>- Sensori Ventilazione</strong> 

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_cucina_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{
                  states('sensor.vmc_cucina_status_ventola') }} {% endif
                  %}</pre>

                  <strong>- Sensori Ambientali</strong>

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_cucina_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_cucina_sensori') }}
                  {% endif %}</pre> 

                  <strong>- Lan</strong>

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_cucina_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_cucina_lan') }} {%
                  endif %}</pre>

                  <strong>- Nome</strong>

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_cucina_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_cucina_nome') }} {%
                  endif %}</pre>


                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Status Routine Sensori</strong><br>

                  Se la funzione è disabilitata il sistema

                  VMC mantiene lo stato di funzionamento impostato

                  dall’utente. I valori rilevati dai sensori (Igrometrico) nella
                  schermata INFO dell'App Mobile non saranno più

                  disponibili e i relativi allarmi non segnalati. 

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Status Pannello Led</strong><br>

                  Per attivare o disattivare i LED

                  del pannello comandi della VMC. 

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Congelamento [°C]</strong><br>

                  Blocca l’unità se la temperatura esterna rilevata è inferiore
                  di -18 °C,

                  indipendentemente dall'Offset settato.

                  <br>

                  Impostazione di default nel firmware della VMC.

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Differenziale tra temperatura interna ed esterna
                  [°C]</strong><br>

                  Se il differenziale è maggiore di 23°C Porta l’unità a
                  Velocità 1

                  indipendentemente dagli Offset settati.

                  <br>

                  Impostazione di default nel firmware della VMC.

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Punto di Rugiada [°C]</strong><br>

                  Quando la temperatura di un oggetto è inferiore al punto di
                  rugiada, il vapore acqueo presente nell'aria si condenserà
                  sulla superficie dell'oggetto. 

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Verifica Impiego della VMC per il superamento del
                  [Lim. Δ P. di Rugiada]</strong><br>

                  Assicurarsi che il punto di rugiada dell'aria esterna meno il
                  punto di rugiada dell'aria interna, sia minore di qualche
                  grado  °C (impostare il [Set Lim. Δ P. di Rugiada]) prima di
                  iniziare la ventilazione.

                  In questo modo si ha la garanzia di trasportare l'umidità
                  dall'interno verso l'esterno.

                  <br>

                  <br>

                  Valutare pertanto se Attivare l'Opzione:

                  <br>

                  [VMC ON/OFF, per Superamento Lim. Δ P. di Rugiada]

                  <br>

                  <br>

                  Le soglie di differenza di rugiada da considerare per la
                  ventilazione possono variare in funzione delle condizioni
                  ambientali. Ecco alcune soglie di differenza di rugiada da
                  considerare in base alle diverse condizioni:


                  In condizioni normali di temperatura e umidità, una differenza
                  di rugiada di almeno 3-4°C è sufficiente per garantire un
                  adeguato trasporto dell'umidità dall'interno all'esterno
                  dell'edificio.


                  In presenza di temperature esterne particolarmente elevate e
                  di un elevato tasso di umidità, potrebbe essere necessario
                  aumentare la differenza di rugiada a 5-6°C o anche di più per
                  evitare la formazione di condensa.


                  In presenza di temperature esterne particolarmente basse e di
                  un basso tasso di umidità, la differenza di rugiada necessaria
                  potrebbe essere inferiore, anche solo di 1-2°C.


                  In ambienti particolarmente umidi, come ad esempio nei bagni o
                  nelle cucine, potrebbe essere necessario adottare una soglia
                  di differenza di rugiada più elevata per evitare la formazione
                  di condensa sulle superfici.


                  In ambienti in cui è presente un elevato tasso di inquinamento
                  dell'aria, come ad esempio in prossimità di strade trafficate
                  o di impianti industriali, potrebbe essere necessario adottare
                  una soglia di differenza di rugiada più elevata per evitare
                  l'ingresso di agenti inquinanti nell'edificio.


                  Tuttavia, è importante considerare che queste soglie sono
                  indicative e che la scelta della soglia più appropriata
                  dipende da una serie di fattori, come ad esempio il tipo di
                  edificio, le attività svolte al suo interno, il numero di
                  persone presenti e le condizioni climatiche locali. In ogni
                  caso, è consigliabile consultare un esperto del settore per
                  determinare la soglia di differenza di rugiada più appropriata
                  per le specifiche condizioni dell'edificio.


                  <pre style="font-size: smaller;">

                  P.di Rugiada Esterna - P. di Rugiada Interno < Set Lim. Δ P.
                  di Rugiada -> <font color="rgb(128, 0, 128)">Si può impiegare
                  [Nessuna Allerta]</font>

                  P.di Rugiada Esterna - P. di Rugiada Interno ≥ Set Lim. Δ P.
                  di Rugiada ->  <font color="rgb(100, 100, 100)">Se ne
                  sconsiglia l'impiego [Allerta]</font>

                  <font color='green'><br>Se l'Opzione [VMC ON/OFF, per
                  Superamento Lim. Δ P. di Rugiada] è Attiva ed è stato superato
                  il valore 

                  del [Set Lim. Δ P. di Rugiada], allora la VMC si
                  Arresterà.</font>

                  </pre>


                  Suggerimenti di impostazione del [Set Lim. Δ P. di Rugiada]:
                    - Locale Bagno, Cucina: 7°C
                    - Locale Camera: 5°C
                  </div>


                  <h4 style="font-size: smaller;">Range Sensore Umidità U [%],
                  se:</h4>

                  <pre style="font-size: smaller;">
                           U ≤ 0     <font color="rgb(128, 0, 128)">Non Calcolabile [Nessuna Allerta]</font>
                       0 < U ≤ 35    <font color="rgb(100, 100, 100)">Possibile Secchezza, Disidratazione [Allerta]</font>
                      35 < U ≤ 65    <font color="rgb(128, 0, 128)">Normale [Nessuna Allerta]</font>
                      66 < U ≤ 100   <font color="rgb(100, 100, 100)">Possibile Muffe, Batteri [Allerta]</font>
                  </pre>

                  <h4 style="font-size: smaller;">Umidità Assoluta U [g/m³],
                  se:</h4>

                  <pre style="font-size: smaller;">
                              U ≤ 0  Non Calcolabile
                  Temp. Interna ≤ 0  Non Calcolabile

                  </pre>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Calendario</strong><br>

                  Permette di organizzare per ogni giorno della settimana
                  l'orario di Accensione e l'orario di Spegnimento su due fasce
                  di orario; le stesse possono essere contigue.<br> Selezionare
                  la velocità dal menù "Settaggi" per ogni fascia di orario.<br>
                  <strong>Riavviare Home Assistant per memorizzare i valori
                  inseriti nel calendario</strong>

                  </div>

                  <pre style="font-size: smaller;">

                  <strong>Regole:</strong>

                  - l'opzione Calendario deve essere impostato su "ON"

                  - l'oradio di Accensione  della 1° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere MINORE  
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Accensiore  della 2° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Accensiore  della 2° Fascia deve essere MAGGIORE
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere DIVERSO 
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 2° Fascia

                  <br>

                  - E' consigliato aver attivato l'opzione "VMC ON/OFF, per
                  Superamento Lim. Δ P. di Rugiada", diversamente non verranno
                  presi in considerazione i parametri ambientali [Punto di
                  Rugiada Esterno (Temperatura Esterna, Umidità Esterna) e Punto
                  di Rugiada Interno (Temperatura Interna, Umidità Interna)].

                  </pre>

                  <br>

                  <strong>Es. Programmazione 1° e 2° Fascia contigue, dalle
                  10:00 alle 10:30</strong><br>

                  Dom. 1° Accensione: 10:00<br>

                  Dom. 1° Spegnimento: 10:28<br>

                  Dom. 2° Accensione: 10:29<br>

                  Dom. 2° Spegnimento: 10:30<br>

                  N.b. dalle 10:28 alle 10:29, la VMC si spegnerà per
                  riattivarsi alle 10:29

                  <br>

                  <br>

                  <strong>Es. Programmazione 1° e 2° Fascia non contigue, dalle
                  00:00 alle 06:00 e dalle 20:00 alle 23:59</strong><br>

                  Dom. 1° Accensione: 00:00<br>

                  Dom. 1° Spegnimento: 06:00<br>

                  Dom. 2° Accensione: 20:00<br>

                  Dom. 2° Spegnimento: 23:59<br>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Free Heating / Free Cooling</strong><br>

                  Permette di settare per la 1° e 2° Fascia (Set Inizio Mese -
                  Set Fine Mese) i mesi soggetti a Riscaldamento (impiegando la
                  velocità Free Heating) o a Raffreddamento (impiegando la
                  velocità Free Cooling) se le condizioni ambientali sono
                  favorevoli.<br> Selezionare i mesi dal menù "Opzioni - Free
                  Heating / Free Cooling" per ogni fascia (Set Inizio Mese - Set
                  Fine Mese).<br> 

                  </div>

                  <pre style="font-size: smaller;">

                  <strong>Regole:</strong>

                  - l'opzione VMC ON/OFF, in Funzione della Vel. Free Heating,
                  deve essere impostato su "ON"

                  - l'opzione VMC ON/OFF, in Funzione della Vel. Free Cooling,
                  deve essere impostato su "ON"

                  - i mesi di ogni fascia (Set Inizio Mese - Set Fine Mese)
                  devono essere contigui

                  - i mesi di ogni fascia (Set Inizio Mese - Set Fine Mese) non
                  devono essere ripetuti

                  </pre>

                  <h4 style="font-size: smaller;">Riscaldamento /
                  Raffrescamento, se:</h4>

                  <pre style="font-size: smaller;">

                  -<strong>Velocità Free Heating</strong>: Temperatura Esterna >
                  Temperatura Interna <font color="rgb(128, 0,
                  128)">Riscaldamento</font>

                  -<strong>Velocità Free Heating</strong>: Temperatura Esterna <
                  Temperatura Interna <font color="rgb(100, 100, 100)">[Allerta]
                  Raffrescamento</font>

                  -<strong>Velocità Free Cooling</strong>: Temperatura Esterna <
                  Temperatura Interna <font color="rgb(128, 0,
                  128)">Raffrescamento</font>

                  -<strong>Velocità Free Cooling</strong>: Temperatura Esterna >
                  Temperatura Interna <font color="rgb(100, 100, 100)">[Allerta]
                  Riscaldamento</font>


                  Se le condizioni ambientali non saranno ideali, mancato
                  Riscaldamento o Raffrescamento, la VMC si arresterà, mostrando
                  un avviso; la ripresa avviene non appena le condizioni
                  risultano idonee per il Riscaldamento o Raffrescamento.

                  E' consigliato aver attivato l'opzione "VMC ON/OFF, per
                  Superamento Lim. Δ P. di Rugiada".

                  </pre>

                  <h4 style="font-size: smaller;">Es. Programmazione 1° e 2°
                  Fascia (Set Inizio Mese - Set Fine Mese) contigue:</h4>

                  <pre style="font-size: smaller;">

                  Set Inizio Mese Free Heating - Set Fine Mese Free Heating:
                  Novembre

                  Set Inizio Mese Free Heating - Set Fine Mese Free Heating:
                  Maggio

                  Set Inizio Mese Free Cooling - Set Fine Mese Free Cooling:
                  Luglio

                  Set Inizio Mese Free Cooling - Set Fine Mese Free Cooling:
                  Ottobre

                  N.b. i Mesi Giugno e Settembre sono mesi non programmati,
                  pertanto in caso di impiego della Velocità Free Heating o Free
                  Cooling nelle condizioni non ideali, la VMC non si arresterà
                  ma mostrerà un avviso di Raffrescamento o di Riscaldamento.

                  </pre>

                  <h4 style="font-size: smaller;">Profili:</h4>

                  <pre style="font-size: smaller;">

                  <strong>VMC Cucina - Imposta Profilo Lim. Δ P. di
                  Rugiada</strong>

                  Attiva [VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada] e
                  imposta il [Set Lim. Δ Punto di Rugiada] a 5 °C

                  <strong>VMC Cucina - VMC Cucina - Imposta Profilo
                  Calendario</strong>

                  Attiva [VMC ON/OFF, in Funzione del Calendario], imposta la
                  velocità della VMC su [Velocità 1] per entrambe le Fascie, e
                  Programma la 1° e 2° Fascia dalle 00:00 alle 06:00 e dalle
                  20:00 alle 23:59

                  <strong>VMC Cucina - Imposta Profilo Free
                  Heating/Cooling</strong>

                  Attiva [VMC ON/OFF, in Funzione della Vel. Free Heating] e
                  [VMC ON/OFF, in Funzione della Vel. Free Cooling], Programma
                  il Free Heating da Ottobre a Giugno e Programma il Free
                  Cooling da Luglio a Settembre


                  <strong>VMC Cucina - Profilo Inizializzazione </strong>

                  Setta tutti i Profili sopra Esposti, Arresta la VMC,
                  Inizializza tutte le Varibili Booleane su [False] e Riavvia
                  Home Assistant.

                  </pre>
