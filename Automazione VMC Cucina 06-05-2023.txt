alias: Automazione VMC Cucina Release del 06-05-2023
description: >-
  - Invia Comandi alla VMC leggendone i valori Contenuti;

  - Permette l'accensione e lo spegnimento in funzione delle 2 fasce orarie
  programmabili per ogni giorno della settimana;

  - Spegne la VMC in funzione dei Parametri Ambientali

  - Ripristina la Velocità precedente in caso di Black-Out
trigger:
  - platform: time_pattern
    id: Verifica ogni N° Secondi
    enabled: true
    seconds: /1
    hours: "*"
    minutes: "*"
    alias: Verifica ogni N° Secondi [Bassi Valori Alta Precisione]]
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_vmc
    from: "off"
    to: "on"
    id: Opzioni VMC On
    alias: Trigger Attivazione Finestra Opzioni
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_vmc
    id: Opzioni VMC Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Opzioni
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_offset_sensori
    from: "off"
    to: "on"
    id: Opzioni Offset Sensori On
    alias: Trigger Attivazione Finestra Sensori
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_offset_sensori
    id: Opzioni Offset Sensori Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Sensori
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
    to: "on"
    id: Opzioni Monitoraggio On
    alias: Trigger Attivazione Finestra Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
    id: Opzioni Monitoraggio Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_calendario
    alias: Trigger Attivazione Finestra Calendario
    id: Opzioni Celendario On
    from: "off"
    to: "on"
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_calendario
    alias: Trigger Disattivazione Finestra Calendario
    from: "on"
    to: "off"
    id: Opzioni Celendario Off
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_lettura_sensori
    from: "off"
    to: "on"
    id: Opzioni Lettura Sensori On
    alias: Trigger Attivazione Finestra Informazioni
  - platform: state
    entity_id:
      - input_boolean.vmc_cucina_opzioni_lettura_sensori
    id: Opzioni Lettura Sensori Off
    from: "on"
    to: "off"
    for:
      hours: 0
      minutes: 0
      seconds: 0
    alias: Trigger Disattivazione Finestra Informazioni
condition: []
action:
  - choose:
      - conditions:
          - condition: trigger
            id: Verifica ogni N° Secondi
            alias: >-
              Verifica Allerta Monitoraggio (PopUp), Verifica Spegnimento
              Automatico per Condizioni Sfavorevoli, Verifica uso Calendario,
              Riposizionamento Variabili in caso di Off-Line
        sequence:
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on') and
                      (((states('sensor.vmc_cucina_status_ventola_lettura_codice_interpretato')
                      != "Velocità 0") )) }}
                alias: >-
                  Se l'Opzione Spegnimento è Attiva, la Velocità della VMC è
                  diversa da Velocità 0 e le Condizioni sono Sfavorevoli
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
            alias: >-
              Spegnimento VMC Automatico, per Verifica Condizioni Sfavorevoli
              per Differenza Punto di Rugiada Ext-Int >= Sel Limite P. di
              Rugiada
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_sabato'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_sabato'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                    alias: >-
                      Verifica Sabato 1° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                alias: >-
                  Se ci si trova in Sabato 1° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_sabato
            else: []
            alias: >-
              Se ci si trova in Sabato 1° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Sabato 1° Fascia
              ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_sabato
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Sabato 1°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio
                    state: "off"
                    alias: Fuori dall'Intervallo 1° Sabato
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: >-
                  Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la
                  Verifica dei i Parametri Booleani correlati alla Velocità
                  Attuale sono vmc_cucina_spia_velocita_x ON e
                  vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
                  dall'Intervallo Sabato 1° Fascia
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_sabato
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Sabato 1° Fascia  -> Velocità 0 e Spia Superamento
              Lim. Δ P. di R. Sabato 1° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    alias: >-
                      Verifica Sabato 2° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_sabato_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_sabato_2'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                alias: >-
                  Se ci si trova in Sabato 2° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_sabato_2
            else: []
            alias: >-
              Se ci si trova in Sabato 2° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Sabato 2° Fascia
              ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_sabato_2
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Sabato 2°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2
                    state: "off"
                    alias: Fuori dall'Intervallo 2° Sabato
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: " Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica dei i Parametri Booleani correlati alla Velocità Attuale sono vmc_cucina_spia_velocita_x ON e vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori dall'Intervallo Sabato 2° Fascia"
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_vmc_vs_pdr_sabato_2
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Sabato 2° Fascia -> Velocità 0 e Spia Superamento
              Lim. Δ P. di R. Sabato 2° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_domenica'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_domenica'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                    alias: >-
                      Verifica Domenica 1° Intervallo Abilitato con Verifica
                      Sup. Lim. Punto di Rugiada 
                alias: >-
                  Se ci si trova in Domenica 1° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_domenica
            else: []
            alias: >-
              Se ci si trova in Domenica 1° Fascia Attivo e si è Superato il
              Lim. P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Domenica 1°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_domenica
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Domenica 1°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio
                    state: "off"
                    alias: Fuori dall'Intervallo 1° Domenica
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: >-
                  Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la
                  Verifica dei i Parametri Booleani correlati alla Velocità
                  Attuale sono vmc_cucina_spia_velocita_x ON e
                  vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
                  dall'Intervallo Domenica 1° Fascia
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_domenica
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Domenica 1° Fascia  -> Velocità 0 e Spia
              Superamento Lim. Δ P. di R. Domenica 1° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    alias: >-
                      Verifica Domenica 2° Intervallo Abilitato con Verifica
                      Sup. Lim. Punto di Rugiada 
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_domenica_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_domenica_2'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                alias: >-
                  Se ci si trova in Domenica 2° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_domenica_2
            else: []
            alias: >-
              Se ci si trova in Domenica 2° Fascia Attivo e si è Superato il
              Lim. P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Domenica 2°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_domenica_2
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Domenica 2°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2
                    state: "off"
                    alias: Fuori dall'Intervallo 2° Domenica
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: " Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica dei i Parametri Booleani correlati alla Velocità Attuale sono vmc_cucina_spia_velocita_x ON e vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori dall'Intervallo Domenica 2° Fascia"
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_vmc_vs_pdr_domenica_2
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Domenica 2° Fascia -> Velocità 0 e Spia
              Superamento Lim. Δ P. di R. Domenica 2° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_lunedi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_lunedi'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                    alias: >-
                      Verifica Lunedi 1° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                alias: >-
                  Se ci si trova in Lunedi 1° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_lunedi
            else: []
            alias: >-
              Se ci si trova in Lunedi 1° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Lunedi 1° Fascia
              ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_lunedi
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Lunedi 1°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio
                    state: "off"
                    alias: Fuori dall'Intervallo 1° Lunedi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: >-
                  Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la
                  Verifica dei i Parametri Booleani correlati alla Velocità
                  Attuale sono vmc_cucina_spia_velocita_x ON e
                  vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
                  dall'Intervallo Lunedi 1° Fascia
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_lunedi
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Lunedi 1° Fascia  -> Velocità 0 e Spia Superamento
              Lim. Δ P. di R. Lunedi 1° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    alias: >-
                      Verifica Lunedi 2° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_lunedi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_lunedi_2'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                alias: >-
                  Se ci si trova in Lunedi 2° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_lunedi_2
            else: []
            alias: >-
              Se ci si trova in Lunedi 2° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Lunedi 2° Fascia
              ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_lunedi_2
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Lunedi 2°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2
                    state: "off"
                    alias: Fuori dall'Intervallo 2° Lunedi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: " Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica dei i Parametri Booleani correlati alla Velocità Attuale sono vmc_cucina_spia_velocita_x ON e vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori dall'Intervallo Lunedi 2° Fascia"
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_vmc_vs_pdr_lunedi_2
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Lunedi 2° Fascia -> Velocità 0 e Spia Superamento
              Lim. Δ P. di R. Lunedi 2° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_martedi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_martedi'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                    alias: >-
                      Verifica Martedi 1° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                alias: >-
                  Se ci si trova in Martedi 1° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_martedi
            else: []
            alias: >-
              Se ci si trova in Martedi 1° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Martedi 1°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_martedi
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Martedi 1°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio
                    state: "off"
                    alias: Fuori dall'Intervallo 1° Martedi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: >-
                  Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la
                  Verifica dei i Parametri Booleani correlati alla Velocità
                  Attuale sono vmc_cucina_spia_velocita_x ON e
                  vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
                  dall'Intervallo Martedi 1° Fascia
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_martedi
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Martedi 1° Fascia  -> Velocità 0 e Spia
              Superamento Lim. Δ P. di R. Martedi 1° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    alias: >-
                      Verifica Martedi 2° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_martedi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_martedi_2'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                alias: >-
                  Se ci si trova in Martedi 2° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_martedi_2
            else: []
            alias: >-
              Se ci si trova in Martedi 2° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Martedi 2°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_martedi_2
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Martedi 2°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2
                    state: "off"
                    alias: Fuori dall'Intervallo 2° Martedi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: " Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica dei i Parametri Booleani correlati alla Velocità Attuale sono vmc_cucina_spia_velocita_x ON e vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori dall'Intervallo Martedi 2° Fascia"
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_vmc_vs_pdr_martedi_2
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Martedi 2° Fascia -> Velocità 0 e Spia Superamento
              Lim. Δ P. di R. Martedi 2° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_mercoledi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_mercoledi'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                    alias: >-
                      Verifica Mercoledi 1° Intervallo Abilitato con Verifica
                      Sup. Lim. Punto di Rugiada 
                alias: >-
                  Se ci si trova in Mercoledi 1° Fascia Attivo e si è Superato
                  il Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_mercoledi
            else: []
            alias: >-
              Se ci si trova in Mercoledi 1° Fascia Attivo e si è Superato il
              Lim. P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Mercoledi
              1° Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_mercoledi
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Mercoledi 1°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio
                    state: "off"
                    alias: Fuori dall'Intervallo 1° Mercoledi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: >-
                  Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la
                  Verifica dei i Parametri Booleani correlati alla Velocità
                  Attuale sono vmc_cucina_spia_velocita_x ON e
                  vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
                  dall'Intervallo Mercoledi 1° Fascia
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_mercoledi
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Mercoledi 1° Fascia  -> Velocità 0 e Spia
              Superamento Lim. Δ P. di R. Mercoledi 1° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    alias: >-
                      Verifica Mercoledi 2° Intervallo Abilitato con Verifica
                      Sup. Lim. Punto di Rugiada 
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_mercoledi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_mercoledi_2'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                alias: >-
                  Se ci si trova in Mercoledi 2° Fascia Attivo e si è Superato
                  il Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_mercoledi_2
            else: []
            alias: >-
              Se ci si trova in Mercoledi 2° Fascia Attivo e si è Superato il
              Lim. P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Mercoledi
              2° Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_mercoledi_2
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Mercoledi 2°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2
                    state: "off"
                    alias: Fuori dall'Intervallo 2° Mercoledi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: " Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica dei i Parametri Booleani correlati alla Velocità Attuale sono vmc_cucina_spia_velocita_x ON e vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori dall'Intervallo Mercoledi 2° Fascia"
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_vmc_vs_pdr_mercoledi_2
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Mercoledi 2° Fascia -> Velocità 0 e Spia
              Superamento Lim. Δ P. di R. Mercoledi 2° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_giovedi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_giovedi'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                    alias: >-
                      Verifica Giovedi 1° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                alias: >-
                  Se ci si trova in Giovedi 1° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_giovedi
            else: []
            alias: >-
              Se ci si trova in Giovedi 1° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Giovedi 1°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_giovedi
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Giovedi 1°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio
                    state: "off"
                    alias: Fuori dall'Intervallo 1° Giovedi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: >-
                  Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la
                  Verifica dei i Parametri Booleani correlati alla Velocità
                  Attuale sono vmc_cucina_spia_velocita_x ON e
                  vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
                  dall'Intervallo Giovedi 1° Fascia
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_giovedi
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Giovedi 1° Fascia  -> Velocità 0 e Spia
              Superamento Lim. Δ P. di R. Giovedi 1° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    alias: >-
                      Verifica Giovedi 2° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_giovedi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_giovedi_2'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                alias: >-
                  Se ci si trova in Giovedi 2° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_giovedi_2
            else: []
            alias: >-
              Se ci si trova in Giovedi 2° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Giovedi 2°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_giovedi_2
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Giovedi 2°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2
                    state: "off"
                    alias: Fuori dall'Intervallo 2° Giovedi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: " Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica dei i Parametri Booleani correlati alla Velocità Attuale sono vmc_cucina_spia_velocita_x ON e vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori dall'Intervallo Giovedi 2° Fascia"
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_vmc_vs_pdr_giovedi_2
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Giovedi 2° Fascia -> Velocità 0 e Spia Superamento
              Lim. Δ P. di R. Giovedi 2° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_venerdi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_venerdi'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                    alias: >-
                      Verifica Venerdi 1° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                alias: >-
                  Se ci si trova in Venerdi 1° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_venerdi
            else: []
            alias: >-
              Se ci si trova in Venerdi 1° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Venerdi 1°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_venerdi
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Venerdi 1°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio
                    state: "off"
                    alias: Fuori dall'Intervallo 1° Venerdi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: >-
                  Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la
                  Verifica dei i Parametri Booleani correlati alla Velocità
                  Attuale sono vmc_cucina_spia_velocita_x ON e
                  vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
                  dall'Intervallo Venerdi 1° Fascia
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_venerdi
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Venerdi 1° Fascia  -> Velocità 0 e Spia
              Superamento Lim. Δ P. di R. Venerdi 1° Fascia OFF
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: template
                    alias: >-
                      Verifica Venerdi 2° Intervallo Abilitato con Verifica Sup.
                      Lim. Punto di Rugiada 
                    value_template: >-
                      {{
                      (states('sensor.vmc_cucina_status_accensione_vmc_tramite_calendario_2')
                      != "Disabilitata") and
                      (states('sensor.vmc_cucina_status_spegnimento_vmc_tramite_calendario_2')!=
                      "Disabilitata") and (now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_venerdi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_venerdi_2'),
                      '%H:%M:%S').strftime('%H:%M')) and
                      (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                      ne sconsiglia l\'impiego") and
                      (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                      == 'on')}}
                alias: >-
                  Se ci si trova in Venerdi 2° Fascia Attivo e si è Superato il
                  Lim. P. di Rugiada 
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_venerdi_2
            else: []
            alias: >-
              Se ci si trova in Venerdi 2° Fascia Attivo e si è Superato il Lim.
              P. di Rugiada -> Spia Superamento Lim. Δ P. di R. Venerdi 2°
              Fascia ON
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_vmc_vs_pdr_venerdi_2
                    state: "on"
                    alias: >-
                      Verifica Spia Superamento se Lim. Δ P. di R. Venerdi 2°
                      Fascia è ON
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2
                    state: "off"
                    alias: Fuori dall'Intervallo 2° Venerdi
                  - condition: or
                    conditions:
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_0
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                            state: "off"
                        alias: Velocità 0
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_1
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                            state: "off"
                        alias: Velocità 1
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_2
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                            state: "off"
                        alias: Velocità 2
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_3
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                            state: "off"
                        alias: Velocità 3
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_4
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                            state: "off"
                        alias: Velocità 4
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                            state: "off"
                        alias: Velocità Notturna
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                            state: "off"
                        alias: Velocità Iperventilazione
                      - condition: and
                        conditions:
                          - condition: state
                            entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                            state: "on"
                          - condition: state
                            entity_id: >-
                              input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                            state: "off"
                        alias: Velocità Free-Cooling
                    alias: >-
                      Verifica Velocità Attuale nelle Normali Condizioni di
                      Impiego
                alias: " Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica dei i Parametri Booleani correlati alla Velocità Attuale sono vmc_cucina_spia_velocita_x ON e vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori dall'Intervallo Venerdi 2° Fascia"
            then:
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                enabled: true
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_vmc_vs_pdr_venerdi_2
            alias: >-
              Verifica se la Spia Superamento Lim. Δ P. di R. è ON, la Verifica
              dei i Parametri Booleani correlati alla Velocità Attuale sono
              vmc_cucina_spia_velocita_x ON e
              vmc_cucina_spia_velocita_x_primo_avvio OFF e se Fuori
              dall'Intervallo Venerdi 2° Fascia -> Velocità 0 e Spia Superamento
              Lim. Δ P. di R. Venerdi 2° Fascia OFF
            enabled: true
          - if:
              - condition: state
                state: Allerta
                entity_id: sensor.vmc_cucina_alert_monitoraggio_umidita
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_umidita
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_umidita
            alias: POP-UP Allerta Monitoraggio - Umidità
          - if:
              - condition: state
                state: Allerta
                entity_id: sensor.vmc_cucina_alert_monitoraggio_pdr
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_pdr
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_pdr
            alias: >-
              POP-UP Allerta Monitoraggio - Verifica uso VMC? OVVERO SUPERAMENTO
              DEL Set Lim. Δ Punto di Rugiada
          - if:
              - condition: state
                state: Allerta
                entity_id: sensor.vmc_cucina_alert_monitoraggio_congelamento
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_congelamento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_congelamento
            alias: >-
              POP-UP Allerta Monitoraggio - VMC Congelamento ≤ -18 [°C] Temp.
              Esterna ?
          - if:
              - condition: state
                state: Allerta
                entity_id: sensor.vmc_cucina_alert_monitoraggio_delta
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_delta
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_delta
            alias: POP-UP Allerta Monitoraggio - VMC Diff. Temp. Int-Est > 23 [°C] ?
          - if:
              - condition: state
                state: Allerta
                entity_id: sensor.vmc_cucina_alert_monitoraggio_co2
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_co2
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_co2
            alias: >-
              POP-UP Allerta Monitoraggio - SUPERAMENTO DEL Livello di
              Concentrazione CO₂ [ppm]
          - if:
              - condition: state
                state: Allerta
                entity_id: sensor.vmc_cucina_alert_monitoraggio_voc
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_voc
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_verifica_monitoraggio_voc
            alias: >-
              POP-UP Allerta Monitoraggio - SUPERAMENTO DEL Livello di
              Concentrazione VOC [ppb]
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Velocità 0
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è 0
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_0
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_1
                    - input_boolean.vmc_cucina_spia_velocita_2
                    - input_boolean.vmc_cucina_spia_velocita_3
                    - input_boolean.vmc_cucina_spia_velocita_4
                    - input_boolean.vmc_cucina_spia_velocita_freecooling
                    - input_boolean.vmc_cucina_spia_velocita_notturna
                    - input_boolean.vmc_cucina_spia_velocita_iperventilazione
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è 0 -> Spia ON
              Velocità 0
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_0
                    state: "on"
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        alias: Condizioni Sfavorevoli
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è OFF-Line e la Spia Velocità 0 è ON
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
            alias: >-
              2° Se la VMC è ( OFF-Line o Condizioni Sfavorevoli ) e la Velocità
              precedente era Velocità 0 -> Spia ON Velocità 0 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_0_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era Velocità
              0 -> Spia OFF Velocità 0 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Velocità 1
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è 1
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_1
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_0
                    - input_boolean.vmc_cucina_spia_velocita_2
                    - input_boolean.vmc_cucina_spia_velocita_3
                    - input_boolean.vmc_cucina_spia_velocita_4
                    - input_boolean.vmc_cucina_spia_velocita_freecooling
                    - input_boolean.vmc_cucina_spia_velocita_notturna
                    - input_boolean.vmc_cucina_spia_velocita_iperventilazione
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è 1 -> Spia ON
              Velocità 1
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_1
                    state: "on"
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è OFF-Line e la Spia Velocità 1 è ON
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
            alias: >-
              2° Se la VMC è ( OFF-Line o Condizioni Sfavorevoli ) e la Velocità
              precedente era Velocità 1 -> Spia ON Velocità 1 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_1_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_1
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era Velocità
              1 -> Spia OFF Velocità 1 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Velocità 2
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è 2
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_2
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_0
                    - input_boolean.vmc_cucina_spia_velocita_1
                    - input_boolean.vmc_cucina_spia_velocita_3
                    - input_boolean.vmc_cucina_spia_velocita_4
                    - input_boolean.vmc_cucina_spia_velocita_freecooling
                    - input_boolean.vmc_cucina_spia_velocita_notturna
                    - input_boolean.vmc_cucina_spia_velocita_iperventilazione
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è 2 -> Spia ON
              Velocità 2
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_2
                    state: "on"
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è OFF-Line e la Spia Velocità 2 è ON
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
            alias: >-
              2° Se la VMC è OFF-Line e la Velocità precedente era Velocità 2 ->
              Spia ON Velocità 2 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_2_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_2
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era Velocità
              2 -> Spia OFF Velocità 2 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Velocità 3
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è 3
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_3
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_0
                    - input_boolean.vmc_cucina_spia_velocita_1
                    - input_boolean.vmc_cucina_spia_velocita_2
                    - input_boolean.vmc_cucina_spia_velocita_4
                    - input_boolean.vmc_cucina_spia_velocita_freecooling
                    - input_boolean.vmc_cucina_spia_velocita_notturna
                    - input_boolean.vmc_cucina_spia_velocita_iperventilazione
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è 3 -> Spia ON
              Velocità 3
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_3
                    state: "on"
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è OFF-Line e la Spia Velocità 3 è ON
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
            alias: >-
              2° Se la VMC è OFF-Line e la Velocità precedente era Velocità 3 ->
              Spia ON Velocità 3 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_3_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_3
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era Velocità
              3 -> Spia OFF Velocità 3 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Velocità 4
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è 4
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_4
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_0
                    - input_boolean.vmc_cucina_spia_velocita_1
                    - input_boolean.vmc_cucina_spia_velocita_2
                    - input_boolean.vmc_cucina_spia_velocita_3
                    - input_boolean.vmc_cucina_spia_velocita_freecooling
                    - input_boolean.vmc_cucina_spia_velocita_notturna
                    - input_boolean.vmc_cucina_spia_velocita_iperventilazione
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è 4 -> Spia ON
              Velocità 4
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_4
                    state: "on"
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è OFF-Line e la Spia Velocità 4 è ON
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
            alias: >-
              2° Se la VMC è OFF-Line e la Velocità precedente era Velocità 4 ->
              Spia ON Velocità 4 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_4_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_4
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era Velocità
              4 -> Spia OFF Velocità 4 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Notturna
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è Notturna
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_0
                    - input_boolean.vmc_cucina_spia_velocita_1
                    - input_boolean.vmc_cucina_spia_velocita_2
                    - input_boolean.vmc_cucina_spia_velocita_3
                    - input_boolean.vmc_cucina_spia_velocita_4
                    - input_boolean.vmc_cucina_spia_velocita_freecooling
                    - input_boolean.vmc_cucina_spia_velocita_iperventilazione
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è Notturna -> Spia ON
              Velocità Notturna
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_notturna
                    state: "on"
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è OFF-Line e la Spia Velocità Notturna è ON
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
            alias: >-
              2° Se la VMC è OFF-Line e la Velocità precedente era Velocità
              Notturna -> Spia ON Velocità Notturna 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_spia_velocita_notturna_un_solo_avvio
              - service: shell_command.vmc_cucina_notturna
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era Velocità
              Notturna -> Spia OFF Velocità Notturna 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Free Cooling
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è Free-Cooling
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_0
                    - input_boolean.vmc_cucina_spia_velocita_1
                    - input_boolean.vmc_cucina_spia_velocita_2
                    - input_boolean.vmc_cucina_spia_velocita_3
                    - input_boolean.vmc_cucina_spia_velocita_4
                    - input_boolean.vmc_cucina_spia_velocita_notturna
                    - input_boolean.vmc_cucina_spia_velocita_iperventilazione
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è Free-Cooling ->
              Spia ON Velocità Free-Cooling
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_freecooling
                    state: "on"
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: >-
                  Se la VMC è OFF-Line e la Spia Velocità Notturna è
                  Free-Cooling
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
            alias: >-
              2° Se la VMC è OFF-Line e la Velocità precedente era Velocità
              Free-Cooling -> Spia ON Velocità Free-Cooling 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_spia_velocita_freecooling_un_solo_avvio
              - service: shell_command.vmc_cucina_freecooling
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era Velocità
              Free-Cooling -> Spia OFF Velocità Free-Cooling 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                    enabled: true
                  - condition: state
                    entity_id: >-
                      sensor.vmc_cucina_status_ventola_lettura_codice_interpretato
                    state: Iperventilazione
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                    state: "off"
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è ON-Line e la Velocità è Iperventilazione
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: input_boolean.vmc_cucina_spia_velocita_iperventilazione
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_cucina_spia_velocita_0
                    - input_boolean.vmc_cucina_spia_velocita_1
                    - input_boolean.vmc_cucina_spia_velocita_2
                    - input_boolean.vmc_cucina_spia_velocita_3
                    - input_boolean.vmc_cucina_spia_velocita_4
                    - input_boolean.vmc_cucina_spia_velocita_freecooling
                    - input_boolean.vmc_cucina_spia_velocita_notturna
            alias: >-
              1° Se la VMC è ON-Line e la Velocità attuale è Iperventilazione ->
              Spia ON Iperventilazione
            enabled: true
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: input_boolean.vmc_cucina_spia_velocita_iperventilazione
                    state: "on"
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                    state: "off"
                  - condition: or
                    conditions:
                      - condition: state
                        entity_id: sensor.vmc_cucina_status_ip_interfaccia
                        state: OFF-Line
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                alias: Se la VMC è OFF-Line e la Spia Iperventilazione è ON
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
            alias: >-
              2° Se la VMC è OFF-Line e la Velocità precedente era
              Iperventilazione -> Spia ON Iperventilazione 1° Avvio
          - if:
              - condition: and
                conditions:
                  - condition: state
                    entity_id: >-
                      input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
                    state: "on"
                  - condition: state
                    entity_id: sensor.vmc_cucina_status_ip_interfaccia
                    state: ON-Line
                  - condition: not
                    conditions:
                      - condition: template
                        value_template: >-
                          {{
                          (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')=="Se
                          ne sconsiglia l\'impiego") and
                          (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on') }}
                    alias: Diverso dal SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio
              - service: shell_command.vmc_cucina_iperventilazione
                data: {}
            alias: >-
              3° Se la VMC ritorna ON-Line e la Velocità precedente era
              Iperventilazione -> Spia OFF Iperventilazione 1° avvio
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_lunedi
                    before: input_datetime.vmc_cucina_spegnimento_lunedi
                    alias: Verifica Range Attivazione del Lunedì
                    weekday:
                      - mon
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Lunedì,  Verifica  se gli orari
                  sono minori e diversi,  se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id:
                    - >-
                      input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio=On
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Lunedì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_lunedi
                    before: input_datetime.vmc_cucina_accensione_lunedi
                    weekday:
                      - mon
                    alias: Verifica Range Disattivazione del Lunedì
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_lunedi') <
                      states('input_datetime.vmc_cucina_spegnimento_lunedi') and
                      states('input_datetime.vmc_cucina_accensione_lunedi') !=
                      states('input_datetime.vmc_cucina_spegnimento_lunedi') and
                      states('input_datetime.vmc_cucina_accensione_lunedi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_lunedi_2') !=
                      states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and states('input_datetime.vmc_cucina_accensione_lunedi')
                      < states('input_datetime.vmc_cucina_accensione_lunedi_2')
                      and states('input_datetime.vmc_cucina_spegnimento_lunedi')
                      < states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and states('input_datetime.vmc_cucina_accensione_lunedi')
                      != states('input_datetime.vmc_cucina_accensione_lunedi_2')
                      and states('input_datetime.vmc_cucina_spegnimento_lunedi')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and states('input_datetime.vmc_cucina_spegnimento_lunedi')
                      != states('input_datetime.vmc_cucina_accensione_lunedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_lunedi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_lunedi') and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Lunedì, se gli orari sono
                  minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - >-
                      input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio=Off
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Lunedì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_martedi
                    before: input_datetime.vmc_cucina_spegnimento_martedi
                    alias: Verifica Range Attivazione del Martedì
                    weekday:
                      - tue
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_martedi_un_solo_avvio=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Martedì  Verifica  se gli orari
                  sono minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_martedi_un_solo_avvio=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_martedi_un_solo_avvio=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Martedì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_martedi
                    before: input_datetime.vmc_cucina_accensione_martedi
                    alias: Verifica Range Disattivazione del Martedì
                    weekday:
                      - tue
                  - condition: template
                    alias: >-
                      Verifica se la VMC ha una velocità diversa da 0, se gli
                      orari sono minori e diversi, se l'opzione calendario è ON 
                      e se
                      vmc_cucina_opzioni_calendario_martedi_un_solo_avvio=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_martedi')
                      < states('input_datetime.vmc_cucina_spegnimento_martedi')
                      and states('input_datetime.vmc_cucina_accensione_martedi')
                      != states('input_datetime.vmc_cucina_spegnimento_martedi')
                      and
                      states('input_datetime.vmc_cucina_accensione_martedi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_martedi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and states('input_datetime.vmc_cucina_accensione_martedi')
                      < states('input_datetime.vmc_cucina_accensione_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_martedi') <
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and states('input_datetime.vmc_cucina_accensione_martedi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_martedi') !=
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_martedi') !=
                      states('input_datetime.vmc_cucina_accensione_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_martedi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_martedi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Martedi se gli orari sono
                  minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_martedi_un_solo_avvio=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - >-
                      input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_martedi_un_solo_avvio=Off
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Martedì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_mercoledi
                    before: input_datetime.vmc_cucina_spegnimento_mercoledi
                    alias: Verifica Range Attivazione del Mercoledì
                    weekday:
                      - wed
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi,  se
                      l'opzione calendario è ON  e se
                      vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Mercoledì,  Verifica  se gli
                  orari sono minori e diversi,  se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Mercoledì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_mercoledi
                    before: input_datetime.vmc_cucina_accensione_mercoledi
                    alias: Verifica Range Disattivazione del Mercoledì
                    weekday:
                      - wed
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio=On
                    value_template: >-
                      {{
                      states('input_datetime.vmc_cucina_accensione_mercoledi') <
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      <
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi') <
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      <
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      >
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Mercoledì se gli orari sono
                  minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Mercoledì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_giovedi
                    before: input_datetime.vmc_cucina_spegnimento_giovedi
                    weekday:
                      - thu
                    alias: Verifica Range Attivazione del Giovedì
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi,  se
                      l'opzione calendario è ON  e se
                      vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Giovedì,  Verifica  se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio=On
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Giovedì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_giovedi
                    before: input_datetime.vmc_cucina_accensione_giovedi
                    alias: Verifica Range Disattivazione del Giovedì
                    weekday:
                      - thu
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_giovedi')
                      < states('input_datetime.vmc_cucina_spegnimento_giovedi')
                      and states('input_datetime.vmc_cucina_accensione_giovedi')
                      != states('input_datetime.vmc_cucina_spegnimento_giovedi')
                      and
                      states('input_datetime.vmc_cucina_accensione_giovedi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and states('input_datetime.vmc_cucina_accensione_giovedi')
                      < states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_giovedi') <
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and states('input_datetime.vmc_cucina_accensione_giovedi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_giovedi') !=
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_giovedi') !=
                      states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_giovedi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_giovedi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Giovedì Verifica, se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Giovedì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_venerdi
                    before: input_datetime.vmc_cucina_spegnimento_venerdi
                    alias: Verifica Range Attivazione del Venerdì
                    weekday:
                      - fri
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_venerdì_un_solo_avvio=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Venerdì,  Verifica  se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Venerdì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_venerdi
                    before: input_datetime.vmc_cucina_accensione_venerdi
                    alias: Verifica Range Disattivazione del Venerdì
                    weekday:
                      - fri
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_venerdi')
                      < states('input_datetime.vmc_cucina_spegnimento_venerdi')
                      and states('input_datetime.vmc_cucina_accensione_venerdi')
                      != states('input_datetime.vmc_cucina_spegnimento_venerdi')
                      and
                      states('input_datetime.vmc_cucina_accensione_venerdi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and states('input_datetime.vmc_cucina_accensione_venerdi')
                      < states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_venerdi') <
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and states('input_datetime.vmc_cucina_accensione_venerdi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_venerdi') !=
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_venerdi') !=
                      states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_venerdi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_venerdi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Venerdì, se gli orari sono
                  minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Venerdì
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_sabato
                    before: input_datetime.vmc_cucina_spegnimento_sabato
                    alias: Verifica Range Attivazione del Sabato
                    weekday:
                      - sat
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_sabato_un_solo_avvio=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Sabato,  Verifica  se gli orari
                  sono minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_sabato_un_solo_avvio=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_sabato_un_solo_avvio=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Sabato
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_sabato
                    before: input_datetime.vmc_cucina_accensione_sabato
                    alias: Verifica Range Disattivazione del Sabato
                    weekday:
                      - sat
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_sabato_un_solo_avvio=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_sabato') <
                      states('input_datetime.vmc_cucina_spegnimento_sabato') and
                      states('input_datetime.vmc_cucina_accensione_sabato') !=
                      states('input_datetime.vmc_cucina_spegnimento_sabato') and
                      states('input_datetime.vmc_cucina_accensione_sabato_2') <
                      states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_sabato_2') !=
                      states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and states('input_datetime.vmc_cucina_accensione_sabato')
                      < states('input_datetime.vmc_cucina_accensione_sabato_2')
                      and states('input_datetime.vmc_cucina_spegnimento_sabato')
                      < states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and states('input_datetime.vmc_cucina_accensione_sabato')
                      != states('input_datetime.vmc_cucina_accensione_sabato_2')
                      and states('input_datetime.vmc_cucina_spegnimento_sabato')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and states('input_datetime.vmc_cucina_spegnimento_sabato')
                      != states('input_datetime.vmc_cucina_accensione_sabato_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_sabato_2') >
                      states('input_datetime.vmc_cucina_spegnimento_sabato') and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Sabato Verifica, se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_sabato_un_solo_avvio=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_sabato_un_solo_avvio=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Sabato
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_domenica
                    before: input_datetime.vmc_cucina_spegnimento_domenica
                    alias: Verifica Range Attivazione della Domenica
                    weekday:
                      - sun
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_domenica_un_solo_avvio=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio')=='off' }}"
                alias: >-
                  Verifica Range Attivazione della Domenica,  Verifica  se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_domenica_un_solo_avvio=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_domenica_un_solo_avvio=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_1_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Domenica
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_domenica
                    before: input_datetime.vmc_cucina_accensione_domenica
                    alias: Verifica Range Disattivazione della Domenica
                    weekday:
                      - sun
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_domenica_un_solo_avvio=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_domenica')
                      < states('input_datetime.vmc_cucina_spegnimento_domenica')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica') !=
                      states('input_datetime.vmc_cucina_spegnimento_domenica')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      <
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica') <
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_domenica') <
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica') !=
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_domenica')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_domenica')
                      !=
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      > states('input_datetime.vmc_cucina_spegnimento_domenica')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione della Domenica Verifica, se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_domenica_un_solo_avvio=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_domenica_un_solo_avvio=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Domenica
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_lunedi_2
                    before: input_datetime.vmc_cucina_spegnimento_lunedi_2
                    alias: Verifica Range Attivazione del Lunedì 2°
                    weekday:
                      - mon
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Lunedì 2°,  Verifica  se gli
                  orari sono minori e diversi,  se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id:
                    - >-
                      input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2=On
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Lunedì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_lunedi_2
                    before: input_datetime.vmc_cucina_accensione_lunedi_2
                    weekday:
                      - mon
                    alias: Verifica Range Disattivazione del Lunedì 2°
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_lunedi') <
                      states('input_datetime.vmc_cucina_spegnimento_lunedi') and
                      states('input_datetime.vmc_cucina_accensione_lunedi') !=
                      states('input_datetime.vmc_cucina_spegnimento_lunedi') and
                      states('input_datetime.vmc_cucina_accensione_lunedi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_lunedi_2') !=
                      states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and states('input_datetime.vmc_cucina_accensione_lunedi')
                      < states('input_datetime.vmc_cucina_accensione_lunedi_2')
                      and states('input_datetime.vmc_cucina_spegnimento_lunedi')
                      < states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and states('input_datetime.vmc_cucina_accensione_lunedi')
                      != states('input_datetime.vmc_cucina_accensione_lunedi_2')
                      and states('input_datetime.vmc_cucina_spegnimento_lunedi')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_lunedi_2')
                      and states('input_datetime.vmc_cucina_spegnimento_lunedi')
                      != states('input_datetime.vmc_cucina_accensione_lunedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_lunedi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_lunedi') and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Lunedì 2°, se gli orari sono
                  minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - >-
                      input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2=Off
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Lunedì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_martedi_2
                    before: input_datetime.vmc_cucina_spegnimento_martedi_2
                    alias: Verifica Range Attivazione del Martedì 2°
                    weekday:
                      - tue
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Martedì 2° Verifica  se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Martedì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_martedi_2
                    before: input_datetime.vmc_cucina_accensione_martedi_2
                    alias: Verifica Range Disattivazione del Martedì 2°
                    weekday:
                      - tue
                  - condition: template
                    alias: >-
                      Verifica se la VMC ha una velocità diversa da 0, se gli
                      orari sono minori e diversi, se l'opzione calendario è ON 
                      e se
                      vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_martedi')
                      < states('input_datetime.vmc_cucina_spegnimento_martedi')
                      and states('input_datetime.vmc_cucina_accensione_martedi')
                      != states('input_datetime.vmc_cucina_spegnimento_martedi')
                      and
                      states('input_datetime.vmc_cucina_accensione_martedi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_martedi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and states('input_datetime.vmc_cucina_accensione_martedi')
                      < states('input_datetime.vmc_cucina_accensione_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_martedi') <
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and states('input_datetime.vmc_cucina_accensione_martedi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_martedi') !=
                      states('input_datetime.vmc_cucina_spegnimento_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_martedi') !=
                      states('input_datetime.vmc_cucina_accensione_martedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_martedi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_martedi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Martedi 2° se gli orari sono
                  minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id:
                    - >-
                      input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2=Off
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Martedì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_mercoledi_2
                    before: input_datetime.vmc_cucina_spegnimento_mercoledi_2
                    alias: Verifica Range Attivazione del Mercoledì 2°
                    weekday:
                      - wed
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi,  se
                      l'opzione calendario è ON  e se
                      vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Mercoledì 2°,  Verifica  se gli
                  orari sono minori e diversi,  se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Mercoledì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_mercoledi_2
                    before: input_datetime.vmc_cucina_accensione_mercoledi_2
                    alias: Verifica Range Disattivazione del Mercoledì 2°
                    weekday:
                      - wed
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2=On
                    value_template: >-
                      {{
                      states('input_datetime.vmc_cucina_accensione_mercoledi') <
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      <
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi') <
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      <
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_mercoledi_2')
                      >
                      states('input_datetime.vmc_cucina_spegnimento_mercoledi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Mercoledì 2° se gli orari
                  sono minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Mercoledì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_giovedi_2
                    before: input_datetime.vmc_cucina_spegnimento_giovedi_2
                    weekday:
                      - thu
                    alias: Verifica Range Attivazione del Giovedì 2°
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi,  se
                      l'opzione calendario è ON  e se
                      vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Giovedì 2°,  Verifica  se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2=On
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Giovedì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_giovedi_2
                    before: input_datetime.vmc_cucina_accensione_giovedi_2
                    alias: Verifica Range Disattivazione del Giovedì 2°
                    weekday:
                      - thu
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_giovedi')
                      < states('input_datetime.vmc_cucina_spegnimento_giovedi')
                      and states('input_datetime.vmc_cucina_accensione_giovedi')
                      != states('input_datetime.vmc_cucina_spegnimento_giovedi')
                      and
                      states('input_datetime.vmc_cucina_accensione_giovedi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and states('input_datetime.vmc_cucina_accensione_giovedi')
                      < states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_giovedi') <
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and states('input_datetime.vmc_cucina_accensione_giovedi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_giovedi') !=
                      states('input_datetime.vmc_cucina_spegnimento_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_giovedi') !=
                      states('input_datetime.vmc_cucina_accensione_giovedi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_giovedi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_giovedi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Giovedì 2° Verifica, se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Giovedì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_venerdi_2
                    before: input_datetime.vmc_cucina_spegnimento_venerdi_2
                    alias: Verifica Range Attivazione del Venerdì 2°
                    weekday:
                      - fri
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_venerdì_un_solo_avvio_2=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Venerdì 2°,  Verifica  se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Venerdì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_venerdi_2
                    before: input_datetime.vmc_cucina_accensione_venerdi_2
                    alias: Verifica Range Disattivazione del Venerdì 2°
                    weekday:
                      - fri
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_venerdi')
                      < states('input_datetime.vmc_cucina_spegnimento_venerdi')
                      and states('input_datetime.vmc_cucina_accensione_venerdi')
                      != states('input_datetime.vmc_cucina_spegnimento_venerdi')
                      and
                      states('input_datetime.vmc_cucina_accensione_venerdi_2') <
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and states('input_datetime.vmc_cucina_accensione_venerdi')
                      < states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_venerdi') <
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and states('input_datetime.vmc_cucina_accensione_venerdi')
                      !=
                      states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_venerdi') !=
                      states('input_datetime.vmc_cucina_spegnimento_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_venerdi') !=
                      states('input_datetime.vmc_cucina_accensione_venerdi_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_venerdi_2') >
                      states('input_datetime.vmc_cucina_spegnimento_venerdi')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Venerdì 2°, se gli orari
                  sono minori e diversi, se l'opzione calendario è ON  e se
                  vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Venerdì 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_sabato_2
                    before: input_datetime.vmc_cucina_spegnimento_sabato_2
                    alias: Verifica Range Attivazione del Sabato 2°
                    weekday:
                      - sat
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2')=='off' }}"
                alias: >-
                  Verifica Range Attivazione del Sabato 2°,  Verifica  se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Sabato 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_sabato_2
                    before: input_datetime.vmc_cucina_accensione_sabato_2
                    alias: Verifica Range Disattivazione del Sabato 2°
                    weekday:
                      - sat
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_sabato') <
                      states('input_datetime.vmc_cucina_spegnimento_sabato') and
                      states('input_datetime.vmc_cucina_accensione_sabato') !=
                      states('input_datetime.vmc_cucina_spegnimento_sabato') and
                      states('input_datetime.vmc_cucina_accensione_sabato_2') <
                      states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_sabato_2') !=
                      states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and states('input_datetime.vmc_cucina_accensione_sabato')
                      < states('input_datetime.vmc_cucina_accensione_sabato_2')
                      and states('input_datetime.vmc_cucina_spegnimento_sabato')
                      < states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and states('input_datetime.vmc_cucina_accensione_sabato')
                      != states('input_datetime.vmc_cucina_accensione_sabato_2')
                      and states('input_datetime.vmc_cucina_spegnimento_sabato')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_sabato_2')
                      and states('input_datetime.vmc_cucina_spegnimento_sabato')
                      != states('input_datetime.vmc_cucina_accensione_sabato_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_sabato_2') >
                      states('input_datetime.vmc_cucina_spegnimento_sabato') and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione del Sabato 2° Verifica, se gli
                  orari sono minori e diversi, se l'opzione calendario è ON  e
                  se vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Sabato 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_accensione_domenica_2
                    before: input_datetime.vmc_cucina_spegnimento_domenica_2
                    alias: Verifica Range Attivazione della Domenica 2°
                    weekday:
                      - sun
                  - condition: template
                    alias: >-
                      Verifica  se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2=Off
                    value_template: " {{ states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' and states('input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2')=='off' }}"
                alias: >-
                  Verifica Range Attivazione della Domenica 2°,  Verifica  se
                  gli orari sono minori e diversi, se l'opzione calendario è ON 
                  e se
                  vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2=Off
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2=On
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2
              - choose:
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 0
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_0
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 1
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_1
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 2
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_2
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 3
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_3
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Velocità 4
                    sequence:
                      - service: shell_command.vmc_cucina_velocita_4
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Notturna
                    sequence:
                      - service: shell_command.vmc_cucina_notturna
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Iperventilazione
                    sequence:
                      - service: shell_command.vmc_cucina_iperventilazione
                        data: {}
                  - conditions:
                      - condition: state
                        entity_id: input_select.vmc_cucina_speed_2_fascia_calendario
                        state: Free Cooling
                    sequence:
                      - service: shell_command.vmc_cucina_freecooling
                        data: {}
            alias: Attivazione Calendario Domenica 2°
          - if:
              - condition: and
                conditions:
                  - condition: time
                    after: input_datetime.vmc_cucina_spegnimento_domenica_2
                    before: input_datetime.vmc_cucina_accensione_domenica_2
                    alias: Verifica Range Disattivazione della Domenica 2°
                    weekday:
                      - sun
                  - condition: template
                    alias: >-
                      Verifica se gli orari sono minori e diversi, se l'opzione
                      calendario è ON  e se
                      vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2=On
                    value_template: >-
                      {{ states('input_datetime.vmc_cucina_accensione_domenica')
                      < states('input_datetime.vmc_cucina_spegnimento_domenica')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica') !=
                      states('input_datetime.vmc_cucina_spegnimento_domenica')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      <
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica') <
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_domenica') <
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica') !=
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_domenica')
                      !=
                      states('input_datetime.vmc_cucina_spegnimento_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_spegnimento_domenica')
                      !=
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      and
                      states('input_datetime.vmc_cucina_accensione_domenica_2')
                      > states('input_datetime.vmc_cucina_spegnimento_domenica')
                      and
                      states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario')
                      == 'on' and
                      states('input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2')=='on'
                      }}
                alias: >-
                  Verifica Range Disattivazione della Domenica 2° Verifica, se
                  gli orari sono minori e diversi, se l'opzione calendario è ON 
                  e se vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2=On
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_off
                data: {}
                alias: >-
                  Impostazione
                  vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2=Off
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2
              - service: shell_command.vmc_cucina_velocita_0
                data: {}
                alias: VMC Velocità 0
            alias: Disattivazione Calendario Domenica 2°
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_lunedi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_lunedi'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Lunedi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Lunedi 
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_martedi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_martedi'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Martedi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Martedi 
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_martedi_un_solo_avvio in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_mercoledi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_mercoledi'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Mercoledi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Mercoledi 
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_giovedi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_giovedi'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Giovedi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Giovedi 
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_venerdi'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_venerdi'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Venerdi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Venerdi 
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_sabato'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_sabato'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Sabato
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Sabato 
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_sabato_un_solo_avvio in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_domenica'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_domenica'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Domenica
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Domenica 
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_domenica_un_solo_avvio in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_lunedi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_lunedi_2'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Lunedi 2°
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Lunedi 2°
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2 in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_lunedi_un_solo_avvio_2
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_martedi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_martedi_2'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Martedi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Martedi 2°
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2 in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_martedi_un_solo_avvio_2
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_mercoledi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_mercoledi_2'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Mercoledi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Mercoledi 2°
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2 in
              Funzione della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_mercoledi_un_solo_avvio_2
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_giovedi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_giovedi_2'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Giovedi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Giovedi 2°
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2 in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_giovedi_un_solo_avvio_2
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_venerdi_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_venerdi_2'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Venerdi
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Venerdi 2°
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2 in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_venerdi_un_solo_avvio_2
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_sabato_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_sabato_2'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Sabato
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Sabato 2°
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2 in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_sabato_un_solo_avvio_2
          - if:
              - condition: and
                conditions:
                  - condition: template
                    value_template: >-
                      {{ now().strftime('%H:%M') >=
                      strptime(states('input_datetime.vmc_cucina_accensione_domenica_2'),
                      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M')
                      <
                      strptime(states('input_datetime.vmc_cucina_spegnimento_domenica_2'),
                      '%H:%M:%S').strftime('%H:%M') }}
                    alias: >-
                      Verifica se l'ora Attuale è nella Fascia Oraria Accensione
                      - Spegnimento di Domenica
                alias: >-
                  Verifica se l'ora Attuale cade nell'intervallo del calendario
                  di Domenica 2°
              - condition: template
                value_template: >-
                  {{
                  (states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto')!="Se
                  ne sconsiglia l\'impiego") and
                  (states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr')
                  == 'on') }}
                alias: Condizioni Favorevoli
            then:
              - service: input_boolean.turn_on
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2
            alias: >-
              Inizializzazione
              vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2 in Funzione
              della Fascia Oraria Accensione - Spegnimento
            else:
              - service: input_boolean.turn_off
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_cucina_opzioni_calendario_domenica_un_solo_avvio_2
      - conditions:
          - condition: trigger
            id: Opzioni Offset Sensori On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_offset_sensori
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_cucina_opzioni_vmc
                - input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
                - input_boolean.vmc_cucina_opzioni_lettura_sensori
                - input_boolean.vmc_cucina_opzioni_calendario
      - conditions:
          - condition: trigger
            id: Opzioni Offset Sensori Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_offset_sensori
      - conditions:
          - condition: trigger
            id: Opzioni VMC On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_vmc
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_cucina_opzioni_offset_sensori
                - input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
                - input_boolean.vmc_cucina_opzioni_lettura_sensori
                - input_boolean.vmc_cucina_opzioni_calendario
      - conditions:
          - condition: trigger
            id: Opzioni VMC Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_vmc
      - conditions:
          - condition: trigger
            id: Opzioni Monitoraggio On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_cucina_opzioni_offset_sensori
                - input_boolean.vmc_cucina_opzioni_vmc
                - input_boolean.vmc_cucina_opzioni_lettura_sensori
                - input_boolean.vmc_cucina_opzioni_calendario
      - conditions:
          - condition: trigger
            id: Opzioni Monitoraggio Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
      - conditions:
          - condition: trigger
            id: Opzioni Lettura Sensori On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_lettura_sensori
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_cucina_opzioni_offset_sensori
                - input_boolean.vmc_cucina_opzioni_vmc
                - input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
                - input_boolean.vmc_cucina_opzioni_calendario
      - conditions:
          - condition: trigger
            id: Opzioni Lettura Sensori Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_lettura_sensori
      - conditions:
          - condition: trigger
            id: Opzioni Celendario On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_calendario
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_cucina_opzioni_offset_sensori
                - input_boolean.vmc_cucina_opzioni_vmc
                - input_boolean.vmc_cucina_opzioni_monitoraggio_sensori
                - input_boolean.vmc_cucina_opzioni_lettura_sensori
      - conditions:
          - condition: trigger
            id: Opzioni Celendario Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_cucina_opzioni_calendario
mode: restart