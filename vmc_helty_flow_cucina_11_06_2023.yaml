###########################################################################################################################################################################################################################
#                                                                                                                                                                                                                         #
#                                                                                VMC HELTY FLOW PLUS RELEASE 11-06-2023                                                                                                   #
# SVILUPPATO DA DANILO ROBOTTI, ALLE PRIME ARMI CON HOME ASSISTANT                                                                                                                                                        #
# SI INVITA A DIVULGARE IL CODICE PER RENDERLO SEMPRE PIU' EFFICACIE ED EFFICIENTE, ANCHE AL SOTTOSCRITTO! :)                                                                                                             #
# EMAIL: danilo.robotti@gmail.com                                                                                                                                                                                         #
#                                                                                                                                                                                                                         #
###########################################################################################################################################################################################################################

################### Sensori della VMC  ####################################################################################################################################################################################
#                                                                                                                                                                                                                         #
# I SENSORI PRINCIPALI UTILIZZATI PER L'ESTRAZIONE DEI DATI CONTENUTI NELLA VMC SONO:                                                                                                                                     #
#                                                                                                                                                                                                                         #
# - VMC_CUCINA_STATUS_IP                                                                                                                                                                                                  #
# - VMC_CUCINA_STATUS_VENTOLA                                                                                                                                                                                             #
# - VMC_CUCINA_SENSORI                                                                                                                                                                                                    #
# - VMC_CUCINA_NOME                                                                                                                                                                                                       #
# - VMC_CUCINA_LAN                                                                                                                                                                                                        #
#                                                                                                                                                                                                                         #
# I SENSORI SECONDARI PRINCIPALI UTILIZZATI PER LA RESTITUZIONE DELLA LETTURA DEI DATI ESTRATTI NELLA VMC:                                                                                                                #
#                                                                                                                                                                                                                         #
# - vmc_cucina_status_ip_interfaccia                                                                                                                                                                                      #
# - vmc_cucina_nome_status                                                                                                                                                                                                #
# - vmc_cucina_status_ventola_lettura_codice_interpretato                                                                                                                                                                 #
# - vmc_cucina_status_sensori_lettura_codice_interpretato                                                                                                                                                                 #
# - vmc_cucina_status_led_pannello_lettura_codice_interpretato                                                                                                                                                            #
#                                                                                                                                                                                                                         #
# - vmc_cucina_temp_interna_positivo_negativo  [FORMULA DA VERIFICARE (INDICE ARRAY) E/O METODO , NON AVENDO MAI VISUALIZZATO UNA TEMPERATURA NEGATIVA]                                                                   #
# - vmc_cucina_temp_esterna_positivo_negativo  [FORMULA DA VERIFICARE (INDICE ARRAY) E/O METODO , NON AVENDO MAI VISUALIZZATO UNA TEMPERATURA NEGATIVA]                                                                   #
# - vmc_cucina_temp_interna_status                                                                                                                                                                                        #
# - vmc_cucina_temp_esterna_status                                                                                                                                                                                        #
# - vmc_cucina_umidita_interna_status                                                                                                                                                                                     #
# - vmc_cucina_umidita_esterna_status          [SENSORE DI LETTURA UMIDITA' ESTERNA  MEMORIZZATA NELL'INTEGRAZIONE OPENWEATHERMAP, LO STESSO DOVRA' ESSERE INSTALLATO IN HOME ASSISTANT                                   #
#                                                                                                                                                                                                                         #
# - vmc_cucina_umidita_interna_status_verifica_soglia                                                                                                                                                                     #
# - vmc_cucina_congelamento_verifica_soglia                                                                                                                                                                               #
# - vmc_cucina_delta_temp_verifica_soglia                                                                                                                                                                                 #
# - vmc_cucina_punto_di_rugiada_interno                                                                                                                                                                                   #
# - vmc_cucina_punto_di_rugiada_esterno                                                                                                                                                                                   #
# - vmc_cucina_punto_di_rugiada_verifica_confronto                                                                                                                                                                        #
# - vmc_cucina_umidita_assoluta_interna                                                                                                                                                                                   #
# - vmc_cucina_umidita_assoluta_esterna                                                                                                                                                                                   #
# - vmc_cucina_alert_monitoraggio                                                                                                                                                                                         #
# - vmc_cucina_status_calcolo_portata_ventola                                                                                                                                                                             #
# - vmc_cucina_status_accensione_vmc_tramite_calendario                                                                                                                                                                   #
# - vmc_cucina_status_spegnimento_vmc_tramite_calendario                                                                                                                                                                  #
#                                                                                                                                                                                                                         #
# I SENSORI SECONDARI PRINCIPALI UTILIZZATI PER RACCOLTA DEI DATI (INPUT ETICHETTE) CORRRELATI AI RISPETTIVI SENSORI IMPIEGATI NELL'INTERFACCIA GRAFICA                                                                   #
#                                                                                                                                                                                                                         #
# - vmc_cucina_volume_da_inserire                                                                                                                                                                                         #
# - vmc_cucina_accensione_[giorno]                                                                                                                                                                                        #
# - vmc_cucina_spegnimento_[giorno]                                                                                                                                                                                       #
#                                                                                                                                                                                                                         #
#                                                                                                                                                                                                                         #
#     LETTURA OGNI n SECONDI SULLO STATUS DELLA VENTOLA ATTRAVERSO IL SENSORE VMC_CUCINA_STATUS_VENTOLA, CHE ASSUME IL VALORE LETTO NELL'INDICE [1] DELL'ARRAY, TRAMITE IL COMANDO PAYLOAD "VMGH?" INVIATO ALLA VMC       #
#                                                                                                                                                                                                                         #
#     ES: DI OUTPUT DI DEFAULT DELLA VMC:  VMGO,00001,00000,00000,00000,00000,00000,00000,00000,00000,00000,00000,00000,00000,00000,00000                                                                                 #
#     POSIZIONE INDICE ARRAY:              [0]  [1]   [2]   [3]   [4]   [5]   [6]   [7]   [8]   [9]   [10]  [11]  [12]  [13]  [14]  [15]                                                                                  #
#                                                                                                                                                                                                                         #
#                                               00000 = VELOCITA' 0     , ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_velocita_0                                                                             #
#                                               00001 = VELOCITA' 1     , ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_velocita_1                                                                             #
#                                               00002 = VELOCITA' 2     , ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_velocita_2                                                                             #
#                                               00003 = VELOCITA' 3     , ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_velocita_3                                                                             #
#                                               00004 = VELOCITA' 4     , ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_velocita_4                                                                             #
#                                               00005 = IPERVENTILAZIONE, ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_iperventilazione                                                                       #
#                                               00006 = NOTTE           , ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_notte                                                                                  #
#                                               00007 = FREECOOLING     , ATTRAVERSO L'AUTOMAZIONE, LANCIA IL SERVIZIO: vmc_cucina_freecooling                                                                            #
#                                                                                                                                                                                                                         #
###########################################################################################################################################################################################################################

################### Inizio Creazione Sensori Principali della VMC  ########################################################################################################################################################
                         
command_line:
  - sensor:
      name: VMC_CUCINA_STATUS_IP               # [CONFIGURAZIONE, PIU’ RICHIAMI] CREAZIONE DEL SENSORE PER VERIFICARE SE LA VMC E' ON LINE O MENO
      command: "ping -c 1 192.168.1.160 >/dev/null && echo 'ON-Line' || echo 'OFF-Line'"
      scan_interval:
        seconds: 60                            # OGNI N° SECONDI RIPETE LA SCANSIONE [IL VALORE IMPATTA SULL'AUTOMAZIONE "ID Verifica ogni N° Secondi", PERTANTO, ASSICURARSI DI IMPOSTARE NELL'AUTOMAZIONE "ID Verifica ogni N° Secondi" UN VALORE MINORE O UGUALE; PIU' IL VALORE E' BASSO PIù IL SISTEMA DIVENTA IN REAL-TIME]

sensor:
  - platform: tcp
    name: VMC_CUCINA_STATUS_VENTOLA            # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] CREAZIONE DEL SENSORE LETTURA STATI DI VENTILAZIONE; N.b non tutti i valori sono identificabili
    host: 192.168.1.160                        # INDIRIZZO IP DELLA VMC CUCINA
    port: 5001                                 # PORTA 5001 DELLA VMC IMPOSTAZIONE DI DEFAULT
    timeout: 15
    payload: "VMGH?"                           # INVIO COMANDO VMGH? ALLA VMC CUCINA, PER OTTENERE INFORMAZIONI SULLO STATO DI VENTILAZIONE DELLA VMC]
    scan_interval:                             # OGNI n SECONDI RIPETE LA SCANSIONE [SE SI COMANDA LA VMC CON IL TELECOMANDO L'AUTOMAZIONE LO RILEVERA' AD OGNI scan_interval -> seconds]
      seconds: 5                               # OGNI N° SECONDI RIPETE LA SCANSIONE

  - platform: tcp
    name: VMC_CUCINA_SENSORI                   # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] CREAZIONE DEL SENSORE LETTURA SENSORI; N.b non tutti i valori sono identificabili
    host: 192.168.1.160                        # INDIRIZZO IP DELLA VMC CUCINA
    port: 5001                                 # PORTA 5001 DELLA VMC IMPOSTAZIONE DI DEFAULT
    timeout: 15
    payload: "VMGI?"                           # INVIO COMANDO VMGI? ALLA VMC CUCINA, PER OTTENERE INFORMAZIONI SUI SENSORI DELLA VMC]
    scan_interval:
      seconds: 1200                            # OGNI N° SECONDI RIPETE LA SCANSIONE

  - platform: tcp
    name: VMC_CUCINA_NOME                      # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] CREAZIONE DEL SENSORE LETTURA NOME DELLA VMC
    host: 192.168.1.160                        # INDIRIZZO IP DELLA VMC CUCINA
    port: 5001                                 # PORTA 5001 DELLA VMC IMPOSTAZIONE DI DEFAULT
    timeout: 15
    payload: "VMNM?"                           # INVIO COMANDO VMNM? ALLA VMC CUCINA, PER OTTENERE INFORMAZIONI SUL NOME DELLA VMC]
    scan_interval:
      seconds: 43200                           # OGNI N° SECONDI RIPETE LA SCANSIONE

  - platform: tcp
    name: VMC_CUCINA_LAN                       # [CONFIGURAZIONE, 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] CREAZIONE DEL SENSORE LETTURA DATI LAN DELLA VMC; N.b non tutti i valori sono identificabili
    host: 192.168.1.160                        # INDIRIZZO IP DELLA VMC CUCINA
    port: 5001                                 # PORTA 5001 DELLA VMC IMPOSTAZIONE DI DEFAULT
    timeout: 15
    payload: "VMSL?"                           # INVIO COMANDO VMSL? ALLA VMC CUCINA, PER OTTENERE INFORMAZIONI SUI DATI LAN DELLA VMC]
    scan_interval:
      seconds: 43200                           # OGNI N° SECONDI RIPETE LA SCANSIONE
################### Fine Creazione Sensori Principali della VMC  ##########################################################################################################################################################

################### Inizio Creazione Sensori di Lettura Collegamento tramite Status IP, Nome, Stato Ventola, Stato Sensoristico, Stato Led Pannello della VMC  ############################################################
  - platform: template
    sensors:
      vmc_cucina_status_ip_interfaccia:                                        # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE IMPIEGATO PER LA VISUALIZZAZIONE NELL'INTERFACCIA SE LA VMC E' IN RETE O MENO
        friendly_name: "Status VMC"
        value_template: >
          {% set stati = ['OFF-Line'] %}
          {{ 'OFF-Line' if states('sensor.vmc_cucina_status_ip') in stati else 'ON-Line' }}
        icon_template: >
          {% if states('sensor.vmc_cucina_status_ip') == 'OFF-Line' %}
            mdi:fan-alert
          {% else %}
            mdi:fan-chevron-down
          {% endif %}

      vmc_cucina_nome_status:                                                  # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE DI VERIFICA DI AVVENUTA LETTURA NOME MEMORIZZATA NELLA VMC
        friendly_name: "Nome"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% set vmc_nome = states('sensor.vmc_cucina_nome') %}
          {% if vmc_nome.split(" ")|length >= 2 %}
            {{ vmc_nome.split(" ")[1] }}
          {% else %}
            Non disponibile
          {% endif %}
        icon_template: mdi:label-variant

      vmc_cucina_ip:                                                           # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE PER VISUALIZZARE L'IP NELL'INTERFACCIA
        friendly_name: "Internet Protocol Address"
        value_template: >
            192.168.1.160 su Porta 5001
        icon_template: mdi:ip

      vmc_cucina_status_ventola_lettura_codice:                                # [CONFIGURAZIONE 0 RICHIAMI] SENSORE DI LETTURA DEI DATI "VELOCITA'" MEMORIZZATI NELLA VMC, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "VELOCITA'" MEMORIZZATI NELLA VMC
        friendly_name: "Codice Status Ventilazione"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% set valid_stati = ['00000', '00001', '00002', '00003', '00004', '00005', '00006', '00007'] %}
          {{ 'Non disponibile' if states('sensor.vmc_cucina_status_ventola') in stati else 
          (states('sensor.vmc_cucina_status_ventola').split(',')[1] if states('sensor.vmc_cucina_status_ventola').split(',')[1] in valid_stati else 'Non disponibile') }}
        icon_template: mdi:code-array       

      vmc_cucina_status_ventola_lettura_codice_interpretato:                   # [CONFIGURAZIONE PIU' RICHIAMI] [INTERFACCIA 0] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE DI INTERPRETAZIONE DELLA LETTURA DEI DATI "VELOCITA'" MEMORIZZATI NELLA VMC CONVERITA IN "STRINGA", PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "VELOCITA'"" MEMORIZZATI NELLA VMC
        friendly_name: "Status Ventilazione"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% set codici = {'00000': 'Velocità 0', '00001': 'Velocità 1', '00002': 'Velocità 2', '00003': 'Velocità 3', 
                           '00004': 'Velocità 4', '00005': 'Iperventilazione', '00006': 'Notturna', '00007': 'Free Cooling'} %}
          {{ 'Non disponibile' if states('sensor.vmc_cucina_status_ventola') in stati else 
          (codici.get(states('sensor.vmc_cucina_status_ventola').split(',')[1], 'Non disponibile')) }}
        icon_template: mdi:fan    

      vmc_cucina_status_ventola_lettura_codice_interpretato_interfaccia:       # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE 0] SENSORE DI INTERPRETAZIONE DELLA LETTURA DEI DATI "VELOCITA'" MEMORIZZATI NELLA VMC CONVERITA IN "STRINGA" CON LA POSSIBILITA' DI VISUALIZZARE FREE COOLING O FREE HEATING O FREE C./H. (IN FUNZIONE DEL VALORE LETTO DEL SENSORE vmc_cucina_status_mese_corrente_freeheating_o_freecooling), PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "VELOCITA'"" MEMORIZZATI NELLA VMC
        friendly_name: "Status Ventilazione"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% set codici = {'00000': 'Velocità 0', '00001': 'Velocità 1', '00002': 'Velocità 2', '00003': 'Velocità 3',
                           '00004': 'Velocità 4', '00005': 'Iperventilazione', '00006': 'Notturna', '00007': 'Free Cooling'} %}
          {% if is_state('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling', 'Free Heating') %}
            {% set codici = {'00000': 'Velocità 0', '00001': 'Velocità 1', '00002': 'Velocità 2', '00003': 'Velocità 3',
                             '00004': 'Velocità 4', '00005': 'Iperventilazione', '00006': 'Notturna', '00007': 'Free Heating'} %}
          {% elif is_state('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling', 'Free Cooling') %}
            {% set codici = {'00000': 'Velocità 0', '00001': 'Velocità 1', '00002': 'Velocità 2', '00003': 'Velocità 3',
                             '00004': 'Velocità 4', '00005': 'Iperventilazione', '00006': 'Notturna', '00007': 'Free Cooling'} %}
          {% elif is_state('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling', 'Disabilitata') %}
            {% set codici = {'00000': 'Velocità 0', '00001': 'Velocità 1', '00002': 'Velocità 2', '00003': 'Velocità 3',
                             '00004': 'Velocità 4', '00005': 'Iperventilazione', '00006': 'Notturna', '00007': 'Free Cool./Heat.'} %}
          {% endif %}
          {{ 'Non disponibile' if states('sensor.vmc_cucina_status_ventola') in stati else 
          (codici.get(states('sensor.vmc_cucina_status_ventola').split(',')[1], 'Non disponibile')) }}
        icon_template: mdi:fan

      vmc_cucina_status_sensori_lettura_codice_interpretato:                   # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE DI INTERPRETAZIONE DELL'ATTIVAZIONE O MENO DELLE ROUTINE MEMORIZZATE NELLA VMC (ES. SE PRESENTE ALLARME UMIDITA' -> MASSIMA VELOCITA'), CORRELATE AI SENSORI DELLA VMC CONVERITA IN "STRINGA", PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "VELOCITA'" MEMORIZZATI NELLA VMC
        friendly_name: "Status Routine Sensori"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% set codici = {'00003': 'Spenti', '00001': 'Accesi', '00002': 'Spenti', '00000': 'Accesi'} %}
          {{ 'Non disponibile' if states('sensor.vmc_cucina_status_ventola') in stati else 
          (codici.get(states('sensor.vmc_cucina_status_ventola').split(',')[4], 'Non disponibile')) }}
        icon_template: mdi:chip     

      vmc_cucina_status_led_pannello_lettura_codice_interpretato:              # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE DI INTERPRETAZIONE DELLA LETTURA DELL'ATTIVAZIONE O MENO DEL PANNELLO LED MEMORIZZATI NELLA VMC, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "VELOCITA'" MEMORIZZATI NELLA VMC
        friendly_name: "Status Led Pannello"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% set codici = {'00000': 'Spento'} %}
          {{ 'Non disponibile' if states('sensor.vmc_cucina_status_ventola') in stati else 
          (codici.get(states('sensor.vmc_cucina_status_ventola').split(',')[14], 'Acceso')) }}
        icon_template: mdi:led-on    
################### Fine Creazione Sensori di Lettura Collegamento tramite Status IP, Nome, Stato Ventola, Stato Sensoristico, Stato Led Pannello della VMC  #################################################################

################### Inizio Creazione Sensori di Lettura Temp. Interna, Esterna, Umidità della VMC  #################################################################################################################
      vmc_cucina_temp_interna_positivo_negativo:                               # [CONFIGURAZIONE, PIU’ RICHIAMI] SENSORE PER DETERMINARE SE IL VALORE DELLA TEMEPARTURA INTERNA SARA' POSITIVA O NEGATIVA; ATTENZIONE E' UNA PRESUNZIONE DELLO SCRIVENTE IN QUANTO NON HO MAI VISUALIZZATO UNA TEMPERATURA NEGATIVA NELLA VMC, VERIFICA CHE NELLA POSIZIONE DELL'ARRAY [1] IL PRIMO NUMERO E' 1 ES. [10200], OVVERO -20,0 °C
        friendly_name: "Segno Temperatura Interna"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %} 
            {% if int(states('sensor.vmc_cucina_sensori').split(',')[1][0]) == 1 %}
             negativo
            {% else %}
              positivo
            {% endif %}
          {% endif %}
        icon_template: mdi:home-thermometer

      vmc_cucina_temp_esterna_positivo_negativo:                               # [CONFIGURAZIONE, PIU’ RICHIAMI] SENSORE PER DETERMINARE SE IL VALORE DELLA TEMEPARTURA ESTERNA SARA' POSITIVA O NEGATIVA; ATTENZIONE E' UNA PRESUNZIONE DELLO SCRIVENTE IN QUANTO NON HO MAI VISUALIZZATO UNA TEMPERATURA NEGATIVA NELLA VMC, VERIFICA CHE NELLA POSIZIONE DELL'ARRAY [2] IL PRIMO NUMERO E' 1 ES. [10300], OVVERO -30,0 °C
        friendly_name: "Segno Temperatura Interna"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %} 
            {% if int(states('sensor.vmc_cucina_sensori').split(',')[2][0]) == 1 %}
             negativo
            {% else %}
              positivo
            {% endif %}
          {% endif %}
        icon_template: mdi:home-thermometer-outline 

      vmc_cucina_temp_interna_status:                                          # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI LETTURA TEMPERATURA INTERNA MEMORIZZATA NELLA VMC + OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC; ATTENZIONE NELLA PRESUNZIONE NEL CALCOLO DI VERIFICA SE LA TEMPERATURA E' POSITIVA O NEGATIVA; SE IL PRIMO VALORE DEL PRIMO CAMPO [1] DELL'ARRAY E' 1 IL CALCOLO VERRA' ESEGUITO ESCLUDENDO IL PRIMO VALORE [1][1:] ES. 10200 -> 0200 -> -20,0 °C
        friendly_name: "Temperatura [°C]" 
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %} 
            {% set raw_temp = states('sensor.vmc_cucina_sensori') %}
            {% set temp_interna_positivo = float(int(raw_temp.split(',')[1]) / 10) + float(states('input_number.vmc_cucina_offset_temp_interna')) %}
            {% set temp_interna_negativo = (- (float(int(raw_temp.split(',')[1][1:]) / 10))) + float(states('input_number.vmc_cucina_offset_temp_interna')) %}
            {% if states('sensor.vmc_cucina_temp_interna_positivo_negativo') == "negativo" %}
              {{ temp_interna_negativo | round(1) }}
            {% else %}
              {{ temp_interna_positivo | round(1) }}
            {% endif %}
          {% endif %}
        icon_template: mdi:home-thermometer

      vmc_cucina_temp_esterna_status:                                          # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI LETTURA TEMPERATURA INTERNA MEMORIZZATA NELLA VMC + OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC; ATTENZIONE NELLA PRESUNZIONE NEL CALCOLO DI VERIFICA SE LA TEMPERATURA E' POSITIVA O NEGATIVA; SE IL PRIMO VALORE DEL SECONDO CAMPO [2] DELL'ARRAY E' 1 IL CALCOLO VERRA' ESEGUITO ESCLUDENDO IL PRIMO VALORE [2][1:] ES. 10200 -> 0200 -> -20,0 °C
        friendly_name: "Temperatura Esterna [°C]" 
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %} 
            {% set raw_temp = states('sensor.vmc_cucina_sensori') %}
            {% set temp_esterna_positivo = float(int(raw_temp.split(',')[2]) / 10) + float(states('input_number.vmc_cucina_offset_temp_esterna')) %}
            {% set temp_esterna_negativo = (- (float(int(raw_temp.split(',')[2][1:]) / 10))) + float(states('input_number.vmc_cucina_offset_temp_esterna')) %}
            {% if states('sensor.vmc_cucina_temp_esterna_positivo_negativo') == "negativo" %}
              {{ temp_esterna_negativo | round(1) }}
            {% else %}
              {{ temp_esterna_positivo | round(1) }}
            {% endif %}
          {% endif %}
        icon_template: mdi:home-thermometer-outline

      vmc_cucina_temp_interna_status_senza_offset:                             # [CONFIGURAZIONE, PIU’ RICHIAMI] SENSORE DI LETTURA TEMPERATURA INTERNA MEMORIZZATA NELLA VMC SENZA OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC; ATTENZIONE NELLA PRESUNZIONE NEL CALCOLO DI VERIFICA SE LA TEMPERATURA E' POSITIVA O NEGATIVA; SE IL PRIMO VALORE DEL PRIMO CAMPO [1] DELL'ARRAY E' 1 IL CALCOLO VERRA' ESEGUITO ESCLUDENDO IL PRIMO VALORE [1][1:] ES. 10200 -> 0200 -> -20,0 °C
        friendly_name: "Temperatura [°C]" 
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %} 
            {% set raw_temp = states('sensor.vmc_cucina_sensori') %}
            {% set temp_interna_positivo = float(int(raw_temp.split(',')[1]) / 10) %}
            {% set temp_interna_negativo = (- (float(int(raw_temp.split(',')[1][1:]) / 10))) %}
            {% if states('sensor.vmc_cucina_temp_interna_positivo_negativo') == "negativo" %}
              {{ temp_interna_negativo | round(1) }}
            {% else %}
              {{ temp_interna_positivo | round(1) }}
            {% endif %}
          {% endif %}
        icon_template: mdi:home-thermometer

      vmc_cucina_temp_esterna_status_senza_offset:                             # [CONFIGURAZIONE, PIU’ RICHIAMI] SENSORE DI LETTURA TEMPERATURA INTERNA MEMORIZZATA NELLA VMC SENZA OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC; ATTENZIONE NELLA PRESUNZIONE NEL CALCOLO DI VERIFICA SE LA TEMPERATURA E' POSITIVA O NEGATIVA; SE IL PRIMO VALORE DEL SECONDO CAMPO [2] DELL'ARRAY E' 1 IL CALCOLO VERRA' ESEGUITO ESCLUDENDO IL PRIMO VALORE [2][1:] ES. 10200 -> 0200 -> -20,0 °C
        friendly_name: "Temperatura Esterna [°C]" 
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %} 
            {% set raw_temp = states('sensor.vmc_cucina_sensori') %}
            {% set temp_esterna_positivo = float(int(raw_temp.split(',')[2]) / 10) %}
            {% set temp_esterna_negativo = (- (float(int(raw_temp.split(',')[2][1:]) / 10))) %}
            {% if states('sensor.vmc_cucina_temp_esterna_positivo_negativo') == "negativo" %}
              {{ temp_esterna_negativo | round(1) }}
            {% else %}
              {{ temp_esterna_positivo | round(1) }}
            {% endif %}
          {% endif %}
        icon_template: mdi:home-thermometer-outline

      vmc_cucina_umidita_interna_status:                                       # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI LETTURA UMIDITA' INTERNA  MEMORIZZATA NELLA VMC + OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC
        friendly_name: "Umidità [%]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}         
            {% set umidita_relativa = float(int(states('sensor.vmc_cucina_sensori').split(',')[3]) / 10) + float(states('input_number.vmc_cucina_offset_umidita_interna')) %}
            {% if umidita_relativa > 0 and umidita_relativa <= 100 %}
              {{ umidita_relativa }}
            {% elif umidita_relativa <= 0 %}
              [Non Calcolabile]
            {% elif umidita_relativa > 100 %}
              100
            {% endif %}
          {% endif %}   
        icon_template: mdi:water-percent

      vmc_cucina_umidita_interna_status_senza_offset:                                       # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI LETTURA UMIDITA' INTERNA  MEMORIZZATA NELLA VMC SENZA OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC
        friendly_name: "Umidità [%]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}         
            {% set umidita_relativa = float(int(states('sensor.vmc_cucina_sensori').split(',')[3]) / 10) %}
            {% if umidita_relativa > 0 and umidita_relativa <= 100 %}
              {{ umidita_relativa }}
            {% elif umidita_relativa <= 0 %}
              [Non Calcolabile]
            {% elif umidita_relativa > 100 %}
              100
            {% endif %}
          {% endif %}   
        icon_template: mdi:water-percent

      vmc_cucina_umidita_esterna_status:                                       # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI LETTURA UMIDITA' ESTERNA  MEMORIZZATA NELL'INTEGRAZIONE OPENWEATHERMAP, LO STESSO DEVE ESSERE INSTALLATO IN HOME ASSISTANT + OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC
        friendly_name: "Umidità Esterna by OpenWeatherMap [%]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set umidita_relativa_esterna = states('sensor.openweathermap_humidity') | float + float(states('input_number.vmc_cucina_offset_umidita_esterna')) %}
            {% if umidita_relativa_esterna > 0 and umidita_relativa_esterna <= 100 %}
              {{ umidita_relativa_esterna }}
            {% elif umidita_relativa_esterna <= 0 %}
              [Non Calcolabile]
            {% elif umidita_relativa_esterna > 100 %}
              100
            {% endif %}
          {% endif %}             
        icon_template: mdi:water-percent

      vmc_cucina_umidita_esterna_status_senza_offset:                                       # [CONFIGURAZIONE, 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI LETTURA UMIDITA' ESTERNA  MEMORIZZATA NELL'INTEGRAZIONE OPENWEATHERMAP, LO STESSO DEVE ESSERE INSTALLATO IN HOME ASSISTANT SENZA OFFSET MANUALE, PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "SENSORI" MEMORIZZATI NELLA VMC
        friendly_name: "Umidità Esterna by OpenWeatherMap [%]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set umidita_relativa_esterna = states('sensor.openweathermap_humidity') | float %}
            {% if umidita_relativa_esterna > 0 and umidita_relativa_esterna <= 100 %}
              {{ umidita_relativa_esterna }}
            {% elif umidita_relativa_esterna <= 0 %}
              [Non Calcolabile]
            {% elif umidita_relativa_esterna > 100 %}
              100
            {% endif %}
          {% endif %}             
        icon_template: mdi:water-percent
################### Fine Creazione Sensori di Lettura Temp. Interna, Esterna, Umidità della VMC  ################################################################################################################################################

################### Inizio Creazione Sensori per l'INTERFACCIA per la Lettura Umidità Verifica Superamento Lim. Δ P. di Rugiada, VMC Congelamento ≤ -18 [°C] Temp. Esterna ?, VMC Diff. Temp. Int-Est > 23 [°C] ? della VMC  ###################
      vmc_cucina_umidita_interna_status_verifica_soglia_valore:                # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE MONITORAGGIO UMIDITA' INTERNA LETTA DALLA VMC
        friendly_name: "Livello di Umidità"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}                 
            {% set umidita_soglia = states('sensor.vmc_cucina_umidita_interna_status') %}
            {% if umidita_soglia != '[Non Calcolabile]' %}
              {% set umidita_soglia = float(umidita_soglia) %}
              {% if umidita_soglia > 0 and umidita_soglia <= 35 %}
                UMIDITÀ AL {{ umidita_soglia }}%. POSSIBILE SECCHEZZA, DISIDRATAZIONE. SI CONSIGLIA DI UMIDIFICARE LA STANZA.
              {% elif umidita_soglia > 35 and umidita_soglia <= 65 %}
                UMIDITA' AL {{ umidita_soglia }}%. SITUAZIONE NORMALE.
              {% elif umidita_soglia > 65 and umidita_soglia <= 100 %}
                UMIDITA' AL {{ umidita_soglia }}%. POTREBBE VERIFICARSI UNA PROLIFERAZIONE DI MUFFE E BATTERI. SI CONSIGLIA DI DEUMIDIFICARE LA STANZA.
              {% else %}
                [Non Calcolabile]
              {% endif %}
            {% else %}
              [Non Calcolabile]
            {% endif %}
          {% endif %}   
        icon_template: mdi:water-percent

      vmc_cucina_punto_di_rugiada_verifica_confronto_valore:                   # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI MONITORAGGIO DEL PUNTO DI RUGIADA ESTERNO - PUNTO DI RUGIADA INTERNO < DELTA (OVVERO IL VALORE DEL SENSORE vmc_cucina_offset_verifica_impiego_vmc [°C]); DIVERSAMENTE NON DEVE ESSERE IMPIEGATA LA VMC
        friendly_name: "Verifica Superamento Lim. Δ P. di Rugiada"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set PdRi = states('sensor.vmc_cucina_punto_di_rugiada_interno') | float(0) %}
            {% set PdRe = states('sensor.vmc_cucina_punto_di_rugiada_esterno') | float(0) %}
            {% set Delta = states('input_number.vmc_cucina_offset_verifica_impiego_vmc') | float(0) %}
            {% if (states('sensor.vmc_cucina_punto_di_rugiada_interno') != '[Non Calcolabile]') and (states('sensor.vmc_cucina_punto_di_rugiada_esterno') != '[Non Calcolabile]') %}
              {% if (PdRe - PdRi) < Delta %}
                Δ PUNTO DI RUGIADA RILEVATO {{ (PdRe - PdRi)|round(2) }} °C MINORE DI {{states('input_number.vmc_cucina_offset_verifica_impiego_vmc')}} °C DEL VALORE SETTATO.
              {% elif (PdRe - PdRi) == Delta %}
                Δ PUNTO DI RUGIADA RILEVATO {{ (PdRe - PdRi)|round(2) }} °C UGUALE A {{states('input_number.vmc_cucina_offset_verifica_impiego_vmc')}} °C DEL VALORE SETTATO.              
              {% else %}
                Δ PUNTO DI RUGIADA RILEVATO {{ (PdRe - PdRi)|round(2) }} °C MAGGIORE DI {{states('input_number.vmc_cucina_offset_verifica_impiego_vmc')}} °C DEL VALORE SETTATO.
              {% endif %}
            {% else %}
              [Non Calcolabile]
            {% endif %}
          {% endif %}
        icon_template: mdi:hvac

      vmc_cucina_congelamento_verifica_soglia_valore:                          # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE MONITORAGGIO CONGELAMENTO INTERNO NELLA VMC SENZA OFFSET -> BLOCCO DELL'UNITA' PER DEFAULT, IMPARTITO DAL COSTRUTTORE
        friendly_name: "VMC Congelamento ≤ -18 [°C] Temp. Esterna ?"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}   
            {% set congelamento = states('sensor.vmc_cucina_temp_esterna_status_senza_offset') | float(0) %}
            {% if congelamento <= -18 %}
              ARRESTO DELLA VMC PER CONGELAMENTO IMPOSTO DAL COSTRUTTORE. TEMPERATURA RILEVATA {{congelamento}} °C, INDIPENDENTEMENTE DAGLI OFFSET SETTATI.
            {% elif congelamento > -18 and congelamento <= -15 %}
              VMC IN PROSSIMITÀ DI ARRESTO PER CONGELAMENTO. TEMPERATURA RILEVATA {{congelamento}} °C, INDIPENDENTEMENTE DAGLI OFFSET SETTATI.
            {% else %}
              LA TEMPERATURA ESTERNA RILEVATA È DI {{states('sensor.vmc_cucina_temp_esterna_status')}} °C, NON C'È PERICOLO DI CONGELAMENTO DELLA VMC, INDIPENDENTEMENTE DAGLI OFFSET SETTATI.
            {% endif %}
          {% endif %}   
        icon_template: mdi:hvac

      vmc_cucina_delta_temp_verifica_soglia_valore:                            # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE MONITORAGGIO DIFFERENZA DI TEMPERATURA (> 23 GRADI [°C]) NELLA VMC SENZA OFFSET -> VELOCITA' 1 DELL'UNITA' PER DEFAULT, IMPARTITO DAL COSTRUTTORE
        friendly_name: "VMC Diff. Temp. Int-Est > 23 [°C] ?"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set temperatura_esterna = states('sensor.vmc_cucina_temp_esterna_status_senza_offset') | float(0) %}
            {% set temperatura_interna = states('sensor.vmc_cucina_temp_interna_status_senza_offset') | float(0) %}
            {% if temperatura_esterna == 'Non disponibile' or temperatura_interna == 'Non disponibile' %}
              [Non Disponibile]
            {% else %}
              {% set delta = (temperatura_interna - temperatura_esterna) | round(1) %}
              {% if delta > 23 %}
                RILEVATA UNA DIFFERENZA TRA LA TEMP. INTERNA E TEMP. ESTERNA DI {{delta}} °C. LA VELOCITÀ VERRÀ IMPOSTATA SU 1 DAL COSTRUTTORE DELLA VMC INDIPENDENTEMENTE DAGLI OFFSET SETTATI.
              {% elif delta >= 20 and delta <= 23 %}
                RILEVATA UNA DIFFERENZA TRA LA TEMP. INTERNA E TEMP. ESTERNA DI {{delta}} °C. POSSIBILE PROSSIMO CAMBIO DI VELOCITÀ A 1, IMPOSTO DAL COSTRUTTORE DELLA VMC INDIPENDENTEMENTE DAGLI OFFSET SETTATI.
              {% else %}
                RILEVATA UNA DIFFERENZA TRA LA TEMP. INTERNA E TEMP. ESTERNA DI {{delta}} °C. NON È PREVISTO NESSUN CAMBIO DI VELOCITÀ INDIPENDENTEMENTE DAGLI OFFSET SETTATI.
              {% endif %}
            {% endif %}
          {% endif %}
        icon_template: mdi:hvac
################### Fine Creazione Sensori per l'INTERFACCIA per la Lettura Umidità, Verifica Superamento Lim. Δ P. di Rugiada, VMC Congelamento ≤ -18 [°C] Temp. Esterna ?, VMC Diff. Temp. Int-Est > 23 [°C] ? della VMC  ###################

################### Inizio Creazione Sensori di Monitoraggio per fare scattare i PopUp ove richiesto #############################################################################################################################
      vmc_cucina_umidita_interna_status_verifica_soglia:                       # [CONFIGURAZIONE POP-UP, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE MONITORAGGIO UMIDITA' INTERNA LETTA DALLA VMC
        friendly_name: "Livello di Umidità"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}                 
            {% set umidita_soglia = states('sensor.vmc_cucina_umidita_interna_status') %}
            {% if umidita_soglia != '[Non Calcolabile]' %}
              {% set umidita_soglia = float(umidita_soglia) %}
              {% if umidita_soglia >= 1 and umidita_soglia <= 35 %}
                Possibile Secchezza, Disidratazione
              {% elif umidita_soglia > 35 and umidita_soglia <= 65 %}
                Normale
              {% elif umidita_soglia > 65 and umidita_soglia <= 100 %}
                Possibile Muffe, Batteri
              {% else %}
                [Non Calcolabile]
              {% endif %}
            {% else %}
              [Non Calcolabile]
            {% endif %}
          {% endif %}   
        icon_template: mdi:water-percent

      vmc_cucina_congelamento_verifica_soglia:                                 # [CONFIGURAZIONE POP-UP, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE MONITORAGGIO CONGELAMENTO INTERNO NELLA VMC SENZA OFFSET -> BLOCCO DELL'UNITA' PER DEFAULT, IMPARTITO DAL COSTRUTTORE
        friendly_name: "VMC Congelamento ≤ -18 [°C] Temp. Esterna ?"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set congelamento = states('sensor.vmc_cucina_temp_esterna_status_senza_offset') | float(0) %}
            {% if congelamento == 'Non disponibile' %}
              [Non Disponibile]
            {% elif congelamento <= -18 %}
              Si
            {% elif congelamento > -18 and congelamento <= -15 %}
              [No ma Prossimo]
            {% else %}
              No
            {% endif %}
          {% endif %}
        icon_template: mdi:snowflake-thermometer

      vmc_cucina_delta_temp_verifica_soglia:                                   # [CONFIGURAZIONE POP-UP, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE MONITORAGGIO DIFFERENZA DI TEMPERATURA (> 23 GRADI [°C]) NELLA VMC SENZA OFFSET -> VELOCITA' 1 DELL'UNITA' PER DEFAULT, IMPARTITO DAL COSTRUTTORE
        friendly_name: "VMC Diff. Temp. Int-Est > 23 [°C] ?"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set temperatura_esterna = states('sensor.vmc_cucina_temp_esterna_status_senza_offset') | float(0) %}
            {% set temperatura_interna = states('sensor.vmc_cucina_temp_interna_status_senza_offset') | float(0) %}
            {% if temperatura_esterna == 'Non disponibile' or temperatura_interna == 'Non disponibile' %}
              [Non Disponibile]
            {% else %}
              {% set delta = (temperatura_interna - temperatura_esterna) | round(1) %}
              {% if delta > 23 %}
                Si
              {% elif delta >= 20 and delta <= 23 %}
                [No ma Prossimo]
              {% else %}
                No
              {% endif %}
            {% endif %}
          {% endif %}
        icon_template: mdi:hvac

      vmc_cucina_punto_di_rugiada_interno:                                     # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI MONITORAGIO DEL PUNTO DI RUGIADA INTERNO, IN FUNZIONE DELLA TEMEPRATURA INTERNA ED UMIDITA' INTERNA LETTA DALLA VMC
        friendly_name: "Punto di Rugiada [°C]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}  
            {% set Rh = states('sensor.vmc_cucina_umidita_interna_status') | float(0) %}
            {% set Tc = states('sensor.vmc_cucina_temp_interna_status') | float(0) %}
            {% set Es = 6.11 * 10**((7.5*Tc)/(237.7+Tc)) %}
            {% set E = Es * Rh / 100 %}
            {% if ( ( Rh > 0 ) and ( Rh <= 100 ) and ( E > 0 ) ) %}
              {% set Dp = (-430.22 + 237.7 * log(E)) / (-log(E) + 19.08) %}
                {{ Dp|round(2) }}
            {% else %}
                [Non Calcolabile]
            {% endif %}
          {% endif %}
        icon_template: mdi:thermometer-water
        
      vmc_cucina_punto_di_rugiada_esterno:                                     # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI MONITORAGIO DEL PUNTO DI RUGIADA ESTERNO, IN FUNZIONE DELLA TEMEPRATURA ESTERNA LETTA DALLA VMC E DALL'UMNIDITA' ESTERNA LETTA DALL'INTEGRAZIONE DI OPENWEATHERMAP
        friendly_name: "Punto di Rugiada Esterno [°C]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}  
            {% set Rh = states('sensor.vmc_cucina_umidita_esterna_status') | float(0) %}
            {% set Tc = states('sensor.vmc_cucina_temp_esterna_status') | float(0) %}
            {% set Es = 6.11 * 10**((7.5*Tc)/(237.7+Tc)) %}
            {% set E = Es * Rh / 100 %}
            {% if ( ( Rh > 0 ) and ( Rh <= 100 ) and ( E > 0 ) ) %}
              {% set Dp = (-430.22 + 237.7 * log(E)) / (-log(E) + 19.08) %}
                {{ Dp|round(2) }}
            {% else %}
                [Non Calcolabile]
            {% endif %}
          {% endif %}
        icon_template: mdi:water-thermometer-outline

      vmc_cucina_punto_di_rugiada_verifica_confronto:                          # [CONFIGURAZIONE POP-UP, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI MONITORAGGIO DEL PUNTO DI RUGIADA ESTERNO - PUNTO DI RUGIADA INTERNO < DELTA (OVVERO IL VALORE DEL SENSORE vmc_cucina_offset_verifica_impiego_vmc [°C]); DIVERSAMENTE NON DEVE ESSERE IMPIEGATA LA VMC
        friendly_name: "Verifica Superamento Lim. Δ P. di Rugiada"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
           Non disponibile
          {% else %}
            {% set PdRi = states('sensor.vmc_cucina_punto_di_rugiada_interno') | float(0) %}
            {% set PdRe = states('sensor.vmc_cucina_punto_di_rugiada_esterno') | float(0) %}
            {% set Delta = states('input_number.vmc_cucina_offset_verifica_impiego_vmc') | float(0) %}
            {% if (states('sensor.vmc_cucina_punto_di_rugiada_interno') != '[Non Calcolabile]') and (states('sensor.vmc_cucina_punto_di_rugiada_esterno') != '[Non Calcolabile]') %}
              {% if (PdRe - PdRi) < Delta %}
                Si può impiegare
              {% else %}
                Se ne sconsiglia l'impiego
              {% endif %}
            {% else %}
              [Non Calcolabile]
            {% endif %}
          {% endif %}
        icon_template: mdi:hvac

      vmc_cucina_umidita_assoluta_interna:                                     # [CONFIGURAZIONE O RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI MONITORAGGIO DELL' UMIDITA' ASSOLUTA INTERNA
        friendly_name: "Umidità Assoluta [g/m³]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set h = states('sensor.vmc_cucina_umidita_interna_status') | float(0) %}
            {% set t = states('sensor.vmc_cucina_temp_interna_status') | float(0) %}
            {% if h <= 0 or h == "Non Calcolabile" or t <= 0 %}
              [Non Calcolabile] 
            {% else %}
              {{ (h*6.112*2.1674*e**((t*17.67)/(t+243.5))/(t+273.15))|round(2) }}
            {% endif %}
          {% endif %}
        icon_template: mdi:cloud-percent-outline

      vmc_cucina_umidita_assoluta_esterna:                                     # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI MONITORAGGIO DELL' UMIDITA' ASSOLUTA INTERNA
        friendly_name: "Umidità Assoluta Esterna [g/m³]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set h = states('sensor.vmc_cucina_umidita_esterna_status') | float(0) %}
            {% set t = states('sensor.vmc_cucina_temp_esterna_status') | float(0) %}
            {% if h <= 0 or h == "Non Calcolabile" or t <= 0 %}
              [Non Calcolabile] 
            {% else %}
              {{ (h*6.112*2.1674*e**((t*17.67)/(t+243.5))/(t+273.15))|round(2) }}
            {% endif %}
          {% endif %}
        icon_template: mdi:cloud-percent-outline

      vmc_cucina_status_portata_ventola_lettura_codice_interpretato:           # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI LETTURA DEI DATI "VELOCITA'" MEMORIZZATI NELLA VMC CONVERITA IN PORTATA D'ARIA m3/h [AD ESCLUSIONE DELLA VELOCITA' NOTTURNA E Free Cool./Heat.], PREVIA VERIFICA DI AVVENUTA LETTURA DEI DATI "VELOCITA'"" MEMORIZZATI NELLA VMC
        friendly_name: "Portata d'Aria [M³/h]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% set codici = {'00000': '-', '00001': '10', '00002': '17', '00003': '26', 
                           '00004': '37', '00005': '42', '00006': '10', '00007': '-'} %}
          {{ 'Non disponibile' if states('sensor.vmc_cucina_status_ventola') in stati 
            else (codici.get(states('sensor.vmc_cucina_status_ventola').split(',')[1], 'Non disponibile')) }}
        icon_template: mdi:window-open-variant  

      vmc_cucina_status_calcolo_portata_ventola:                               # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE PER IL CALCOLO IN MINUTI NECESSARI PER UN CAMBIO TOTALE DELL'AMBIENTE
        friendly_name: "Tempo ricambio aria"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% if states('sensor.vmc_cucina_status_portata_ventola_lettura_codice_interpretato') not in ['-', '0'] %}
              {% set volume = states('input_number.vmc_cucina_volume_da_inserire') | float(0) %}
              {% set portata = states('sensor.vmc_cucina_status_portata_ventola_lettura_codice_interpretato') | float(0) %}
              {% if portata != 0 %}
              {% set tempo_minuti = ((volume/portata)*60)|round(0) %}
              {% set ore = tempo_minuti // 60 %}
              {% set minuti = tempo_minuti % 60 %}
                {% if ore == 0 %}
                  {{ minuti }} minuti
                {% elif minuti == 0 %}
                  {{ ore }} ore
                {% else %}
                  {{ ore }} ore e {{ minuti }} minuti
                {% endif %}
              {% else %}
                -
              {% endif %}
            {% else %}
              -
            {% endif %}
          {% endif %}
        icon_template: mdi:home-clock-outline
################### Fine Creazione Sensori di Monitoraggio per fare scattare i PopUp ove richiesto ###########################################################################################################################

########################################################################################### INIZIO SENSORI PER POP-UP MONITORAGGIO ###########################################################################################
      vmc_cucina_alert_monitoraggio_umidita:                                    # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE POP-UP MONITORAGGIO UMIDITA'
        friendly_name: "Verifica Monitoraggio Umidità"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set umidità = states('sensor.vmc_cucina_umidita_interna_status_verifica_soglia') %}
            {% if (umidità == 'Possibile Secchezza, Disidratazione') or (umidità == 'Possibile Muffe, Batteri') %}
              Allerta
            {% else %}
              Nessuna Allerta
            {% endif %}
          {% endif %}
        icon_template: mdi:alarm-light-outline

      vmc_cucina_alert_monitoraggio_pdr:                                        # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE POP-UP MONITORAGGIO Verifica uso VMC? OVVERO SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada
        friendly_name: "Verifica Monitoraggio Superamento Lim. Punto di Rugiada"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set PdRvc = states('sensor.vmc_cucina_punto_di_rugiada_verifica_confronto') %}            
            {% if ( PdRvc == 'Se ne sconsiglia l\'impiego' ) %}
              Allerta
            {% else %}
              Nessuna Allerta
            {% endif %}
          {% endif %}
        icon_template: mdi:alarm-light-outline

      vmc_cucina_alert_monitoraggio_congelamento:                               # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE POP-UP MONITORAGGIO VMC Congelamento ≤ -18 [°C] Temp. Esterna ?
        friendly_name: "Verifica Monitoraggio Congelamento"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set congelamento = states('sensor.vmc_cucina_congelamento_verifica_soglia') %}            
            {% if ( (congelamento == 'Si') or (congelamento == '[No ma Prossimo]') ) %}
              Allerta
            {% else %}
              Nessuna Allerta
            {% endif %}
          {% endif %}
        icon_template: mdi:alarm-light-outline

      vmc_cucina_alert_monitoraggio_delta:                                      # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE POP-UP MONITORAGGIO VMC Diff. Temp. Int-Est > 23 [°C] ?
        friendly_name: "Verifica Monitoraggio Diff. Temp. Int-Est > 23 [°C]"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set delta = states('sensor.vmc_cucina_delta_temp_verifica_soglia') %}
            {% if ( (delta == 'Si') or(delta == '[No ma Prossimo]') ) %}
              Allerta
            {% else %}
              Nessuna Allerta
            {% endif %}
          {% endif %}
        icon_template: mdi:alarm-light-outline

      vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling:                                      # [CONFIGURAZIONE, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE POP-UP MONITORAGGIO IMPIEGO DELLA VELOCITA' FREE HEATING/ FREE COOLING
        friendly_name: "Verifica Monitoraggio Free H./C."
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set automazione_free_cooling = states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_freecooling') %}
            {% set automazione_free_heating = states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_freeheating') %} 
            {% set tipologia = states('sensor.vmc_cucina_status_mese_corrente_freeheating_o_freecooling') %}
            {% set velocita = states('sensor.vmc_cucina_status_ventola_lettura_codice_interpretato') %}
            {% set temp_interna = states('sensor.vmc_cucina_temp_interna_status') | float(0) %}
            {% set temp_esterna = states('sensor.vmc_cucina_temp_esterna_status') | float(0) %}
            {% if   ( (tipologia == "Free Heating") and (velocita == "Free Cooling") and (automazione_free_heating == "on") and ((temp_interna > temp_esterna) | float(0)) )%}
              Allerta Free Heating Programmato (Raffrescamento in atto)
            {% elif ( (tipologia == "Free Heating") and (velocita == "Free Cooling") and ((temp_interna > temp_esterna) | float(0)) )%}
              Allerta Raffrescamento in atto
            {% elif ( (tipologia == "Free Cooling") and (velocita == "Free Cooling") and (automazione_free_cooling == "on") and ((temp_esterna > temp_interna) | float(0)) ) %}
              Allerta Free Cooling Programmato (Riscaldamento in atto)
            {% elif ( (tipologia == "Free Cooling") and (velocita == "Free Cooling") and ((temp_esterna > temp_interna) | float(0)) ) %}
              Allerta Riscaldamento in atto
            {% elif ( (tipologia == "Disabilitata") and (velocita == "Free Cooling") and ((temp_interna > temp_esterna) | float(0)) ) %}
              Raffrescamento in atto
            {% elif ( (tipologia == "Disabilitata") and (velocita == "Free Cooling") and ((temp_esterna > temp_interna) | float(0)) ) %}
              Riscaldamento in atto
            {% else %}
              Nessuna Allerta
            {% endif %}   
          {% endif %}
        icon_template: mdi:alarm-light-outline

      vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling_smart_allert:        # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE POP-UP CHE RACCHIUDE TUTTE LE ALLERTE DOVUTE ALL' IMPIEGO DELLA VELOCITA' FREE HEATING/ FREE COOLING
        friendly_name: "Verifica Allerte Free H./C."
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set freeheating_freecooling = states('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling') %}
            {% if ( (freeheating_freecooling == 'Allerta Free Heating Programmato (Raffrescamento in atto)') or (freeheating_freecooling == 'Allerta Free Cooling Programmato (Riscaldamento in atto)') or (freeheating_freecooling == 'Allerta Raffrescamento in atto') or (freeheating_freecooling == 'Allerta Riscaldamento in atto') or (freeheating_freecooling == 'Raffrescamento in atto') or (freeheating_freecooling == 'Riscaldamento in atto')) %}
              NOT OK
            {% else %}
              OK
            {% endif %}   
          {% endif %}
        icon_template: mdi:alarm-light-outline

      vmc_cucina_alert_monitoraggio_totale:                                    # [CONFIGURAZIONE] SENSORE ALLERTA MONITORAGGIO TOTALE: Umidità, PdR, Congelamento, Delta, Free Heating Programmato e Free Cooling Programmato
        friendly_name: "Status Monitoraggio"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set umidità = states('sensor.vmc_cucina_alert_monitoraggio_umidita') %}
            {% set PdRvc = states('sensor.vmc_cucina_alert_monitoraggio_pdr') %}            
            {% set congelamento = states('sensor. vmc_cucina_alert_monitoraggio_congelamento') %}            
            {% set delta = states('sensor.vmc_cucina_alert_monitoraggio_delta') %}
            {% set freeheating_freecooling = states('sensor.vmc_cucina_alert_monitoraggio_free_heating_o_free_cooling_smart_allert') %}
            {% if ( (umidità == 'Allerta' ) or (PdRvc =='Allerta') or (congelamento == 'Allerta') or (delta == 'Allerta')  or (freeheating_freecooling == 'NOT OK')) %}
              Allerta
            {% else %}
              Nessuna Allerta
            {% endif %}
          {% endif %}
        icon_template: mdi:incognito-circle

      vmc_cucina_spia_pannello_alert_monitoraggio_totale:                      # [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE PER MOSTRARE ALLERTA MONITORAGGIO TOTALE: Umidità, PdR, Congelamento, Delta, Free Heating Programmato e Free Cooling Programmato
        friendly_name: "Avvisi"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}
            {% set monitoraggio = states('sensor.vmc_cucina_alert_monitoraggio_totale') %}
            {% set spia_avvisi = states('input_boolean.vmc_cucina_opzioni_accendi_spegni_avvisi') %}
            {% if monitoraggio == 'Nessuna Allerta' %}
              Non Presenti
            {% elif monitoraggio == 'Allerta' and spia_avvisi == "on" %}
              Presenti
            {% elif monitoraggio == 'Allerta' and spia_avvisi == "off" %}
              Presenti ma Disabilitati
            {% endif %}
          {% endif %}
        icon_template: mdi:alert-rhombus-outline
########################################################################################### FINE SENSORI PER POP-UP MONITORAGGIO #####################################################################################################

################### Inizio Creazione Sensori Interfaccia Calendario  #################################################################################################################################################################
########################################################################################################################
# LOGICA DI FUNZIONAMENTO DEGLI ORARI NELLE FASCE DI INSERIMENTO NEL CALENDARIO, LE VERIFICHE DEVONO ESSERE TUTTE TRUE #
# Accensione  1° <  Spegnimento 1° True                                                                                #
# Accensione  1° <  Accensione  2° True                                                                                #
# Spegnimento 1° <  Spegnimento 2° True                                                                                #
# Accensiore  2° <  Spegnimento 2° True                                                                                #
# Accensiore  2° >  Spegnimento 1° True                                                                                #
# Accensione  1° <> Spegnimento 1° True                                                                                #
# Accensione  1° <> Accensione  2° True                                                                                #
# Spegnimento 1° <> Spegnimento 2° True                                                                                #
# Spegnimento 1° <> Accensione  2° True                                                                                #
# Accensione  2° <> Spegnimento 2° True                                                                                #
# Verifica Calendario Acceso:      True                                                                                #
########################################################################################################################

      vmc_cucina_status_accensione_vmc_tramite_calendario_interfaccia:                     # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE 0] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI VERIFICA 1° FASCIA ACCENSIONE SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATA"
        friendly_name: "1° Accensione programmata"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi, {{ states('input_datetime.vmc_cucina_accensione_lunedi')[0:5] }}
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi, {{ states('input_datetime.vmc_cucina_accensione_martedi')[0:5] }}
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi, {{ states('input_datetime.vmc_cucina_accensione_mercoledi')[0:5] }}
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi, {{ states('input_datetime.vmc_cucina_accensione_giovedi')[0:5] }}
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi, {{ states('input_datetime.vmc_cucina_accensione_venerdi')[0:5] }}
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato, {{ states('input_datetime.vmc_cucina_accensione_sabato')[0:5] }}
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica, {{ states('input_datetime.vmc_cucina_accensione_domenica')[0:5] }}
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}            
        icon_template: mdi:timer-play-outline

      vmc_cucina_status_accensione_vmc_tramite_calendario_2_interfaccia:                   #  [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE 0] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI VERIFICA 2° FASCIA ACCENSIONE SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATA"
        friendly_name: "2° Accensione programmata"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi, {{ states('input_datetime.vmc_cucina_accensione_lunedi_2')[0:5] }}
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi, {{ states('input_datetime.vmc_cucina_accensione_martedi_2')[0:5] }}
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi, {{ states('input_datetime.vmc_cucina_accensione_mercoledi_2')[0:5] }}
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi, {{ states('input_datetime.vmc_cucina_accensione_giovedi_2')[0:5] }}
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi, {{ states('input_datetime.vmc_cucina_accensione_venerdi_2')[0:5] }}
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato, {{ states('input_datetime.vmc_cucina_accensione_sabato_2')[0:5] }}
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica, {{ states('input_datetime.vmc_cucina_accensione_domenica_2')[0:5] }}
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}            
        icon_template: mdi:timer-play-outline

      vmc_cucina_status_spegnimento_vmc_tramite_calendario_interfaccia:                    # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE 0] [INTERFACCIA, PIU’ RICHIAMI]  SENSORE DI VERIFICA 1° FASCIA SPEGNIMENTO SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATO"
        friendly_name: "1° Spegnimento programmato"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi, {{ states('input_datetime.vmc_cucina_spegnimento_lunedi')[0:5] }}
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi, {{ states('input_datetime.vmc_cucina_spegnimento_martedi')[0:5] }}
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi, {{ states('input_datetime.vmc_cucina_spegnimento_mercoledi')[0:5] }}
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi, {{ states('input_datetime.vmc_cucina_spegnimento_giovedi')[0:5] }}
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi, {{ states('input_datetime.vmc_cucina_spegnimento_venerdi')[0:5] }}
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato, {{ states('input_datetime.vmc_cucina_spegnimento_sabato')[0:5] }}
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica, {{ states('input_datetime.vmc_cucina_spegnimento_domenica')[0:5] }}
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}         
        icon_template: mdi:timer-stop-outline

      vmc_cucina_status_spegnimento_vmc_tramite_calendario_2_interfaccia:                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE 0] [INTERFACCIA, PIU’ RICHIAMI]  SENSORE DI VERIFICA 2° FASCIA SPEGNIMENTO SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATO"
        friendly_name: "2° Spegnimento programmato"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi, {{ states('input_datetime.vmc_cucina_spegnimento_lunedi_2')[0:5] }}
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi, {{ states('input_datetime.vmc_cucina_spegnimento_martedi_2')[0:5] }}
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi, {{ states('input_datetime.vmc_cucina_spegnimento_mercoledi_2')[0:5] }}
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi, {{ states('input_datetime.vmc_cucina_spegnimento_giovedi_2')[0:5] }}
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi, {{ states('input_datetime.vmc_cucina_spegnimento_venerdi_2')[0:5] }}
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato, {{ states('input_datetime.vmc_cucina_spegnimento_sabato_2')[0:5] }}
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica, {{ states('input_datetime.vmc_cucina_spegnimento_domenica_2')[0:5] }}
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}         
        icon_template: mdi:timer-stop-outline
        
      vmc_cucina_status_accensione_vmc_tramite_calendario:                     # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI VERIFICA 1° FASCIA ACCENSIONE SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATA"
        friendly_name: "1° Accensione programmata"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}            
        icon_template: mdi:timer-play-outline

      vmc_cucina_status_accensione_vmc_tramite_calendario_2:                   #  [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] SENSORE DI VERIFICA 2° FASCIA ACCENSIONE SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATA"
        friendly_name: "2° Accensione programmata"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}            
        icon_template: mdi:timer-play-outline

      vmc_cucina_status_spegnimento_vmc_tramite_calendario:                    # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI]  SENSORE DI VERIFICA 1° FASCIA SPEGNIMENTO SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATO"
        friendly_name: "1° Spegnimento programmato"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}         
        icon_template: mdi:timer-stop-outline

      vmc_cucina_status_spegnimento_vmc_tramite_calendario_2:                  # vmc_cucina_status_spegnimento_vmc_tramite_calendario SENSORE DI VERIFICA 2° FASCIA SPEGNIMENTO SE GLI ORARI SONO STATI INSERITI CORRETTAMENTE, DIVERSAMENTE MOSTRERA' "DISABILITATO"
        friendly_name: "2° Spegnimento programmato"
        value_template: >-
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set weekday = now().weekday() %}
            {% if weekday == 0 and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_datetime.vmc_cucina_accensione_lunedi_2') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') < states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') < states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_spegnimento_lunedi_2') and states('input_datetime.vmc_cucina_spegnimento_lunedi') != states('input_datetime.vmc_cucina_accensione_lunedi_2') and states('input_datetime.vmc_cucina_accensione_lunedi_2') > states('input_datetime.vmc_cucina_spegnimento_lunedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Lunedi
            {% elif weekday == 1 and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_datetime.vmc_cucina_accensione_martedi_2') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') < states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') < states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_spegnimento_martedi_2') and states('input_datetime.vmc_cucina_spegnimento_martedi') != states('input_datetime.vmc_cucina_accensione_martedi_2') and states('input_datetime.vmc_cucina_accensione_martedi_2') > states('input_datetime.vmc_cucina_spegnimento_martedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Martedi
            {% elif weekday == 2 and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') < states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') < states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_spegnimento_mercoledi_2') and states('input_datetime.vmc_cucina_spegnimento_mercoledi') != states('input_datetime.vmc_cucina_accensione_mercoledi_2') and states('input_datetime.vmc_cucina_accensione_mercoledi_2') > states('input_datetime.vmc_cucina_spegnimento_mercoledi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Mercoledi
            {% elif weekday == 3 and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_datetime.vmc_cucina_accensione_giovedi_2') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') < states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') < states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_spegnimento_giovedi_2') and states('input_datetime.vmc_cucina_spegnimento_giovedi') != states('input_datetime.vmc_cucina_accensione_giovedi_2') and states('input_datetime.vmc_cucina_accensione_giovedi_2') > states('input_datetime.vmc_cucina_spegnimento_giovedi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Giovedi
            {% elif weekday == 4 and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_datetime.vmc_cucina_accensione_venerdi_2') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') < states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') < states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_spegnimento_venerdi_2') and states('input_datetime.vmc_cucina_spegnimento_venerdi') != states('input_datetime.vmc_cucina_accensione_venerdi_2') and states('input_datetime.vmc_cucina_accensione_venerdi_2') > states('input_datetime.vmc_cucina_spegnimento_venerdi') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Venerdi
            {% elif weekday == 5 and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_datetime.vmc_cucina_accensione_sabato_2') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') < states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') < states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_spegnimento_sabato_2') and states('input_datetime.vmc_cucina_spegnimento_sabato') != states('input_datetime.vmc_cucina_accensione_sabato_2') and states('input_datetime.vmc_cucina_accensione_sabato_2') > states('input_datetime.vmc_cucina_spegnimento_sabato') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Sabato
            {% elif weekday == 6 and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_datetime.vmc_cucina_accensione_domenica_2') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') < states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') < states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_spegnimento_domenica_2') and states('input_datetime.vmc_cucina_spegnimento_domenica') != states('input_datetime.vmc_cucina_accensione_domenica_2') and states('input_datetime.vmc_cucina_accensione_domenica_2') > states('input_datetime.vmc_cucina_spegnimento_domenica') and states('input_boolean.vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario') == 'on' %}
              Domenica
              {% else %}
                Disabilitata
              {% endif %}
          {% endif %}         
        icon_template: mdi:timer-stop-outline

################### Fine Creazione Sensori Interfaccia Calendario  #################################################################################################################################################################

################### Inizio Creazione Sensori Interfaccia Free Heating - Free Cooling ###############################################################################################################################################

      vmc_cucina_status_check_freeheating_freecooling:
        friendly_name: "Check Range Free Heating e Free Cooling"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set input1 = states('sensor.vmc_cucina_mese_1_fascia_freeheating') %}
            {% set input2 = states('sensor.vmc_cucina_mese_2_fascia_freeheating') %}
            {% set input3 = states('sensor.vmc_cucina_mese_1_fascia_freecooling') %}
            {% set input4 = states('sensor.vmc_cucina_mese_2_fascia_freecooling') %}
            {% if input1=='Gennaio'%}
              {% set month_numbers = {'Gennaio': 1, 'Febbraio': 2, 'Marzo': 3, 'Aprile': 4, 'Maggio': 5, 'Giugno': 6, 'Luglio': 7, 'Agosto': 8, 'Settembre': 9, 'Ottobre': 10, 'Novembre': 11, 'Dicembre': 12} %}
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Febbraio'%}   
              {% set month_numbers = {'Gennaio': 12, 'Febbraio': 1, 'Marzo': 2, 'Aprile': 3, 'Maggio': 4, 'Giugno': 5, 'Luglio': 6, 'Agosto': 7, 'Settembre': 8, 'Ottobre': 9, 'Novembre': 10, 'Dicembre': 11} %} 
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Marzo'%}   
              {% set month_numbers = {'Gennaio': 11, 'Febbraio': 12, 'Marzo': 1, 'Aprile': 2, 'Maggio': 3, 'Giugno': 4, 'Luglio': 5, 'Agosto': 6, 'Settembre': 7, 'Ottobre': 8, 'Novembre': 9, 'Dicembre': 10} %}   
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Aprile'%}   
              {% set month_numbers = {'Gennaio': 10, 'Febbraio': 11, 'Marzo': 12, 'Aprile': 1, 'Maggio': 2, 'Giugno': 3, 'Luglio': 4, 'Agosto': 5, 'Settembre': 6, 'Ottobre': 7, 'Novembre': 8, 'Dicembre': 9} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Maggio'%}   
              {% set month_numbers = {'Gennaio': 9, 'Febbraio': 10, 'Marzo': 11, 'Aprile': 12, 'Maggio': 1, 'Giugno': 2, 'Luglio': 3, 'Agosto': 4, 'Settembre': 5, 'Ottobre': 6, 'Novembre': 7, 'Dicembre': 8} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Giugno'%}   
              {% set month_numbers = {'Gennaio': 8, 'Febbraio': 9, 'Marzo': 10, 'Aprile': 11, 'Maggio': 12, 'Giugno': 1, 'Luglio': 2, 'Agosto': 3, 'Settembre': 4, 'Ottobre': 5, 'Novembre': 6, 'Dicembre': 7} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Luglio'%}   
              {% set month_numbers = {'Gennaio': 7, 'Febbraio': 8, 'Marzo': 9, 'Aprile': 10, 'Maggio': 11, 'Giugno': 12, 'Luglio': 1, 'Agosto': 2, 'Settembre': 3, 'Ottobre': 4, 'Novembre': 5, 'Dicembre': 6} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Agosto'%}   
              {% set month_numbers = {'Gennaio': 6, 'Febbraio': 7, 'Marzo': 8, 'Aprile': 9, 'Maggio': 10, 'Giugno': 11, 'Luglio': 12, 'Agosto': 1, 'Settembre': 2, 'Ottobre': 3, 'Novembre': 4, 'Dicembre': 5} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Settembre'%}   
              {% set month_numbers = {'Gennaio': 5, 'Febbraio': 6, 'Marzo': 7, 'Aprile': 8, 'Maggio': 9, 'Giugno': 10, 'Luglio': 11, 'Agosto': 12, 'Settembre': 1, 'Ottobre': 2, 'Novembre': 3, 'Dicembre': 4} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Ottobre'%}   
              {% set month_numbers = {'Gennaio': 4, 'Febbraio': 5, 'Marzo': 6, 'Aprile': 7, 'Maggio': 8, 'Giugno': 9, 'Luglio': 10, 'Agosto': 11, 'Settembre': 12, 'Ottobre': 1, 'Novembre': 2, 'Dicembre': 3} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Novembre'%}   
              {% set month_numbers = {'Gennaio': 3, 'Febbraio': 4, 'Marzo': 5, 'Aprile': 6, 'Maggio': 7, 'Giugno': 8, 'Luglio': 9, 'Agosto': 10, 'Settembre': 11, 'Ottobre': 12, 'Novembre': 1, 'Dicembre': 2} %}  
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% elif input1=='Dicembre'%}   
              {% set month_numbers = {'Gennaio': 2, 'Febbraio': 3, 'Marzo': 4, 'Aprile': 5, 'Maggio': 6, 'Giugno': 7, 'Luglio': 8, 'Agosto': 9, 'Settembre': 10, 'Ottobre': 11, 'Novembre': 12, 'Dicembre': 1} %} 
              {% set month_number1 = month_numbers.get(input1) | int%}
              {% set month_number2 = month_numbers.get(input2) | int%}
              {% set month_number3 = month_numbers.get(input3) | int%}
              {% set month_number4 = month_numbers.get(input4) | int%}
            {% endif %}
              {% if month_number1 != month_number2 and month_number2 != month_number3 and month_number3 != month_number4 and month_number1 < month_number2 and month_number2 < month_number3 and month_number3 < month_number4 %}
                OK
              {% else %}
                NOT OK
              {% endif %}
          {% endif %}
        icon_template: mdi:checkbox-marked

      vmc_cucina_status_freeheating:
        friendly_name: "Check Free Heating"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set input1_freeheating = states('sensor.vmc_cucina_mese_1_fascia_freeheating') %}
            {% set input2_freeheating = states('sensor.vmc_cucina_mese_2_fascia_freeheating') %}
            {% set check = states('sensor.vmc_cucina_status_check_freeheating_freecooling') %}
            {% set mese_corrente = now().strftime('%B') %}
            {% if mese_corrente == 'January' %}
              {% set mese_corrente = 'Gennaio' %}
            {% elif mese_corrente == 'February' %}
              {% set mese_corrente = 'Febbraio' %}
            {% elif mese_corrente == 'March' %}
              {% set mese_corrente = 'Marzo' %}
            {% elif mese_corrente == 'April' %}
              {% set mese_corrente = 'Aprile' %}
            {% elif mese_corrente == 'May' %}
              {% set mese_corrente = 'Maggio' %}
            {% elif mese_corrente == 'June' %}
              {% set mese_corrente = 'Giugno' %}
            {% elif mese_corrente == 'July' %}
              {% set mese_corrente = 'Luglio' %}
            {% elif mese_corrente == 'August' %}
              {% set mese_corrente = 'Agosto' %}
            {% elif mese_corrente == 'September' %}
              {% set mese_corrente = 'Settembre' %}
            {% elif mese_corrente == 'October' %}
              {% set mese_corrente = 'Ottobre' %}
            {% elif mese_corrente == 'November' %}
              {% set mese_corrente = 'Novembre' %}
            {% elif mese_corrente == 'December' %}
              {% set mese_corrente = 'Dicembre' %}
            {% endif %}
            {% if input1_freeheating=='Gennaio'%}
              {% set months_freeheating = ['Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Febbraio'%}
              {% set months_freeheating = ['Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Marzo'%}
              {% set months_freeheating = ['Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Aprile'%}
              {% set months_freeheating = ['Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Maggio'%}
              {% set months_freeheating = ['Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Giugno'%}
              {% set months_freeheating = ['Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Luglio'%}
              {% set months_freeheating = ['Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Agosto'%}
              {% set months_freeheating = ['Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Settembre'%}
              {% set months_freeheating = ['Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Ottobre'%}
              {% set months_freeheating = ['Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Novembre'%}
              {% set months_freeheating = ['Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto','Settembre', 'Ottobre'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% elif input1_freeheating=='Dicembre'%}
              {% set months_freeheating = ['Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto','Settembre','Ottobre', 'Novembre'] %}
              {% set interval_1_freeheating = months_freeheating[months_freeheating.index(input1_freeheating):months_freeheating.index(input2_freeheating)+1] %}
            {% endif %}
            {% if check == "OK" %}
              {% if mese_corrente in interval_1_freeheating %}
                OK
              {% else %}
                -
              {% endif %}
            {% else %}
              NOT OK
            {% endif %}
          {% endif %}
        icon_template: mdi:checkbox-marked

      vmc_cucina_status_freecooling:
        friendly_name: "Check Free Cooling"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set input1_freecooling = states('sensor.vmc_cucina_mese_1_fascia_freecooling') %}
            {% set input2_freecooling = states('sensor.vmc_cucina_mese_2_fascia_freecooling') %}
            {% set check = states('sensor.vmc_cucina_status_check_freeheating_freecooling') %}
            {% set mese_corrente = now().strftime('%B') %}
            {% if mese_corrente == 'January' %}
              {% set mese_corrente = 'Gennaio' %}
            {% elif mese_corrente == 'February' %}
              {% set mese_corrente = 'Febbraio' %}
            {% elif mese_corrente == 'March' %}
              {% set mese_corrente = 'Marzo' %}
            {% elif mese_corrente == 'April' %}
              {% set mese_corrente = 'Aprile' %}
            {% elif mese_corrente == 'May' %}
              {% set mese_corrente = 'Maggio' %}
            {% elif mese_corrente == 'June' %}
              {% set mese_corrente = 'Giugno' %}
            {% elif mese_corrente == 'July' %}
              {% set mese_corrente = 'Luglio' %}
            {% elif mese_corrente == 'August' %}
              {% set mese_corrente = 'Agosto' %}
            {% elif mese_corrente == 'September' %}
              {% set mese_corrente = 'Settembre' %}
            {% elif mese_corrente == 'October' %}
              {% set mese_corrente = 'Ottobre' %}
            {% elif mese_corrente == 'November' %}
              {% set mese_corrente = 'Novembre' %}
            {% elif mese_corrente == 'December' %}
              {% set mese_corrente = 'Dicembre' %}
            {% endif %}
            {% if input1_freecooling=='Gennaio'%}
              {% set months_freecooling = ['Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Febbraio'%}
              {% set months_freecooling = ['Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Marzo'%}
              {% set months_freecooling = ['Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Aprile'%}
              {% set months_freecooling = ['Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Maggio'%}
              {% set months_freecooling = ['Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Giugno'%}
              {% set months_freecooling = ['Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Luglio'%}
              {% set months_freecooling = ['Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Agosto'%}
              {% set months_freecooling = ['Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Settembre'%}
              {% set months_freecooling = ['Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Ottobre'%}
              {% set months_freecooling = ['Ottobre', 'Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Novembre'%}
              {% set months_freecooling = ['Novembre', 'Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto','Settembre', 'Ottobre'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% elif input1_freecooling=='Dicembre'%}
              {% set months_freecooling = ['Dicembre', 'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto','Settembre','Ottobre', 'Novembre'] %}
              {% set interval_1_freecooling = months_freecooling[months_freecooling.index(input1_freecooling):months_freecooling.index(input2_freecooling)+1] %}
            {% endif %}
            {% if check == "OK" %}
              {% if mese_corrente in interval_1_freecooling %}
                OK
              {% else %}
                -
              {% endif %}
            {% else %}
              NOT OK
            {% endif %}
          {% endif %}
        icon_template: mdi:checkbox-marked

      vmc_cucina_status_mese_corrente_freeheating_o_freecooling:
        friendly_name: "Mese Corrente Programmato:"
        value_template: >
          {% set stati = ['unknown', 'unavailable'] %}
          {% if states('sensor.vmc_cucina_sensori') in stati %}
            Non disponibile
          {% else %}        
            {% set input1 = states('sensor.vmc_cucina_status_freeheating') %}
            {% set input2 = states('sensor.vmc_cucina_status_freecooling') %}
            {% if input1 == "OK" %}
              Free Heating
            {% elif input2 == "OK" %}
              Free Cooling
            {% else %}
              Disabilitata
            {% endif %}
          {% endif %}
        icon_template: mdi:calendar-month-outline

################### Fine Creazione Sensori Interfaccia Free Heating - Free Cooling ##########################################################################################################################################

################### Inizio Creazione Lettura Valore Etichette ###############################################################################################################################################################
      vmc_cucina_speed_1_fascia_calendario:                                    # [CONFIGURAZIONE 0 RICHIAMI] SENSORE DI LETTURA DEL VALORE INSERITO TRAMITE INTERFACCIA, NEL SENSORE input_select vmc_cucina_speed
        friendly_name: "Set Velocità 1° Fascia Calendario"
        value_template: "{{ states('input_select.vmc_cucina_speed_1_fascia_calendario') | default('') }}"

      vmc_cucina_speed_2_fascia_calendario:                                    # [CONFIGURAZIONE 0 RICHIAMI] SENSORE DI LETTURA DEL VALORE INSERITO TRAMITE INTERFACCIA, NEL SENSORE input_select vmc_cucina_speed
        friendly_name: "Set Velocità 2° Fascia Calendario"
        value_template: "{{ states('input_select.vmc_cucina_speed_2_fascia_calendario') | default('') }}"

      vmc_cucina_mese_1_fascia_freeheating:                                    # [CONFIGURAZIONE 0 RICHIAMI] SENSORE DI LETTURA DEL VALORE INSERITO TRAMITE INTERFACCIA, NEL SENSORE input_select.vmc_cucina_mese_1_fascia_freeheating
        friendly_name: "Set Mese 1° Fascia Free Heating"
        value_template: "{{ states('input_select.vmc_cucina_mese_1_fascia_freeheating') | default('') }}"

      vmc_cucina_mese_2_fascia_freeheating:                                    # [CONFIGURAZIONE 0 RICHIAMI] SENSORE DI LETTURA DEL VALORE INSERITO TRAMITE INTERFACCIA, NEL SENSORE input_select.vmc_cucina_mese_2_fascia_freeheating
        friendly_name: "Set Mese 2° Fascia Free Heating"
        value_template: "{{ states('input_select.vmc_cucina_mese_2_fascia_freeheating') | default('') }}"

      vmc_cucina_mese_1_fascia_freecooling:                                    # [CONFIGURAZIONE 0 RICHIAMI] SENSORE DI LETTURA DEL VALORE INSERITO TRAMITE INTERFACCIA, NEL SENSORE input_select.vmc_cucina_mese_1_fascia_freeheating
        friendly_name: "Set Mese 1° Fascia Free Cooling"
        value_template: "{{ states('input_select.vmc_cucina_mese_1_fascia_freecooling') | default('') }}"

      vmc_cucina_mese_2_fascia_freecooling:                                    # [CONFIGURAZIONE 0 RICHIAMI] SENSORE DI LETTURA DEL VALORE INSERITO TRAMITE INTERFACCIA, NEL SENSORE input_select.vmc_cucina_mese_2_fascia_freeheating
        friendly_name: "Set Mese 2° Fascia Free Cooling"
        value_template: "{{ states('input_select.vmc_cucina_mese_2_fascia_freecooling') | default('') }}"

################### Fine Creazione Lettura Valore Etichette ###############################################################################################################################################################

################### Inizio Creazione Etichette Interfaccia Lovelace ################################################################################################################################################################
input_select:
  vmc_cucina_speed_1_fascia_calendario:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI] SENSORE DI MEMORIZZAZIONE DELLA VELOCITA' CHE SI DESIDERA IMPOSTARE NELLA VMC
    name: "Set Velocità 1° Fascia Calendario"
    options:
      - Velocità 0
      - Velocità 1
      - Velocità 2
      - Velocità 3
      - Velocità 4
      - Notturna
      - Iperventilazione
      - Free Cool./Heat.
    icon: mdi:fan    

  vmc_cucina_speed_2_fascia_calendario:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI] SENSORE DI MEMORIZZAZIONE DELLA VELOCITA' CHE SI DESIDERA IMPOSTARE NELLA VMC
    name: "Set Velocità 2° Fascia Calendario"
    options:
      - Velocità 0
      - Velocità 1
      - Velocità 2
      - Velocità 3
      - Velocità 4
      - Notturna
      - Iperventilazione
      - Free Cool./Heat.
    icon: mdi:fan    

  vmc_cucina_mese_1_fascia_freeheating:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI] SENSORE DI MEMORIZZAZIONE INIZIO 1°RANGE, PER AVVIO VELOCITà FREECOOLING
    name: "Set Inizio Mese Free Heating"
    options:
      - Gennaio
      - Febbraio
      - Marzo
      - Aprile
      - Maggio
      - Giugno
      - Luglio
      - Agosto
      - Settembre
      - Ottobre
      - Novembre
      - Dicembre
    icon: mdi:calendar-month-outline    

  vmc_cucina_mese_2_fascia_freeheating:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI] SENSORE DI MEMORIZZAZIONE FINE 1°RANGE, PER AVVIO VELOCITà FREECOOLING (FREEHEATING)
    name: "Set Fine Mese Free Heating"
    options:
      - Gennaio
      - Febbraio
      - Marzo
      - Aprile
      - Maggio
      - Giugno
      - Luglio
      - Agosto
      - Settembre
      - Ottobre
      - Novembre
      - Dicembre
    icon: mdi:calendar-month-outline    

  vmc_cucina_mese_1_fascia_freecooling:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI] SENSORE DI MEMORIZZAZIONE INIZIO 1°RANGE, PER AVVIO VELOCITà FREECOOLING
    name: "Set Inizio Mese Free Cooling"
    options:
      - Gennaio
      - Febbraio
      - Marzo
      - Aprile
      - Maggio
      - Giugno
      - Luglio
      - Agosto
      - Settembre
      - Ottobre
      - Novembre
      - Dicembre
    icon: mdi:calendar-month-outline    

  vmc_cucina_mese_2_fascia_freecooling:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI] SENSORE DI MEMORIZZAZIONE FINE 1°RANGE, PER AVVIO VELOCITà FREECOOLING (FREEHEATING)
    name: "Set Fine Mese Free Cooling"
    options:
      - Gennaio
      - Febbraio
      - Marzo
      - Aprile
      - Maggio
      - Giugno
      - Luglio
      - Agosto
      - Settembre
      - Ottobre
      - Novembre
      - Dicembre
    icon: mdi:calendar-month-outline  

input_number:
  vmc_cucina_offset_temp_interna:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE DI MEMORIZZAZIONE DELL'OFFSET PER LA TEMPERATURA INTERNA CHE VERRA' SOMMATA NEL SENSORE vmc_cucina_temp_interna_status
    name: "Offset Temperatura"
    min: -50
    max: 50
    step: 0.1
    unit_of_measurement: "°C"
    icon: mdi:counter

  vmc_cucina_offset_temp_esterna:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE DI MEMORIZZAZIONE DELL'OFFSET PER LA TEMPERATURA ESTERNA CHE VERRA' SOMMATA NEL SENSORE vmc_cucina_temp_esterna_status
    name: "Offset Temperatura Esterna"
    min: -50
    max: 50
    step: 0.1
    unit_of_measurement: "°C"
    icon: mdi:counter

  vmc_cucina_offset_umidita_interna:                                           # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE DI MEMORIZZAZIONE DELL'OFFSET PER L'UMIDITA' INTERNA CHE VERRA' SOMMATA NEL SENSORE vmc_cucina_umidita_interna_status
    name: "Offset Umidità"
    min: -100
    max: 100
    step: 0.1
    unit_of_measurement: "%"
    icon: mdi:counter
    
  vmc_cucina_offset_umidita_esterna:                                           # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA PIU’ RICHIAMI] SENSORE DI MEMORIZZAZIONE DELL'OFFSET PER L'UMIDITA' ESTERNA CHE VERRA' SOMMATA NEL SENSORE vmc_cucina_umidita_esterna_status
    name: "Offset Umidità Esterna"
    min: -100
    max: 100
    step: 0.1
    unit_of_measurement: "%"
    icon: mdi:counter

  vmc_cucina_offset_verifica_impiego_vmc:                                      # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA PIU’ RICHIAMI]  SENSORE DI CONFRONTO CON LA DIFFERENZA TRA IL PUNTO DI RUGIADA ESTERNO - IL PUNTO DI RUGIADA INTERNO, SE MINORE SI PUO' IMPIEGARE LA VMC, DIVERSAMENTE NON SI PUO' IMPIEGARE LA VMC
    name: "Set Lim. Δ Punto di Rugiada"
    min: 0
    max: 10
    step: 1
    unit_of_measurement: "°C"
    icon: mdi:counter

  vmc_cucina_volume_da_inserire:                                               # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA PIU’ RICHIAMI]  SENSORE PER L'ACQUISIZIONE DEL VOLUME IMPIEGATO PER IL CALCOLO DEL TEMPO NECESSARIO PER RINNOVARE TUTTA L'ARIA, TRAMITE IL SENSORE vmc_cucina_status_calcolo_portata_ventola
    name: "Volume ambiente"
    min: 0
    max: 1000
    step: 0.5
    mode: box
    unit_of_measurement: "[M³]"
    icon: mdi:cube-scan
################### Fine Creazione Etichette Interfaccia Lovelace  ############################################################################################################################################################################

################### Inizio Creazione Switch Booleani impiegati nell'Interfaccia Lovelace per mostrare o meno le Opzioni ####################################################################################
input_boolean: 
  vmc_cucina_opzioni_vmc:                                                      # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]    name: "Telecomando"
    name: "Telecomando"
    initial: false
    icon: mdi:remote-tv

  vmc_cucina_opzioni_offset_sensori:                                           # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Opzioni"
    initial: false
    icon: mdi:format-list-checkbox

  vmc_cucina_opzioni_interruttore_offset_sensori:                              # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Sensori - Offset"
    initial: false
    icon: mdi:format-list-checkbox

  vmc_cucina_opzioni_monitoraggio_sensori:                                     # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Sensori"
    initial: false
    icon: mdi:memory

  vmc_cucina_opzioni_interruttore_monitoraggio_sensori_extra:                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Sensori - Extra"
    initial: false
    icon: mdi:memory

  vmc_cucina_opzioni_calendario_main:                                          # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Calendario"
    initial: false
    icon: mdi:calendar-multiselect

  vmc_cucina_opzioni_calendario:                                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Programmazione Calendario"
    initial: false
    icon: mdi:calendar-clock-outline

  vmc_cucina_opzioni_punto_di_rugiada:                                         # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Lim. Δ P. di Rugiada"
    initial: false
    icon: mdi:thermometer-water

  vmc_cucina_opzioni_free_heating_o_free_cooling:                              # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Calendario Free Heating / Free Cooling"
    initial: false
    icon: mdi:sun-snowflake-variant

  vmc_cucina_opzioni_interruttore_calendario:                                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Status Programmazione Giornaliera"
    initial: false
    icon: mdi:calendar-today

  vmc_cucina_opzioni_lettura_sensori:                                          # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]
    name: "Informazioni"
    initial: false
    icon: mdi:information-slab-box-outline

  vmc_cucina_opzioni_accendi_spegni_vmc_vs_pdr:                                # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  VERIFICA IL VALORE DEL SENZORE vmc_cucina_punto_di_rugiada_verifica_confronto OVVERO SE IL VALORE DIVENTE "SE NE SCONSIGLIA L'IMPIEGO"; SOLAMENTE SE VIENE ACCESO (ON), LA VMC VERRA' SPENTA IN AUTOMATICO SE IL VALORE DIVENTA "SE NE SCONSIGLIA L'IMPIEGO" 
    name: "VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada"
    icon: mdi:light-switch-off

  vmc_cucina_opzioni_accendi_spegni_vmc_vs_calendario:                         # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  VERIFICA SE RENDERE AUTONOMA LA VMC, SE "ON" VERRA' IMPIEGATO IL CALENDARIO AVVIANDO IN AUTONOMIA L'ACCENSIONE E LO SPEGNIMENTO; SE "OFF" NON VERRA' IMPIEGATO IL CALENDARIO PERTENDO L'AUTONOMIA DI ACCENSIONE E SPEGNIMENTO AUTOMATICO
    name: "VMC ON/OFF, in Funzione del Calendario"
    icon: mdi:light-switch-off

  vmc_cucina_opzioni_accendi_spegni_vmc_vs_freeheating:                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "VMC ON/OFF, in Funzione della Vel. Free Heating"
    icon: mdi:light-switch-off

  vmc_cucina_opzioni_accendi_spegni_vmc_vs_freecooling:                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "VMC ON/OFF, in Funzione della Vel. Free Cooling"
    icon: mdi:light-switch-off

  vmc_cucina_opzioni_accendi_spegni_avvisi:                                    # [CONFIGURAZIONE PIU' RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Mostra o Nascondi gli Avvisi"
    icon: mdi:light-switch-off

  vmc_cucina_opzioni_accendi_spegni_avvisi_spia:                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Spia Avvisi"
    icon: mdi:alert-rhombus-outline

  vmc_cucina_grafica_sensori_on:                                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Sensori On"
    icon: mdi:led-on

  vmc_cucina_grafica_sensori_off:                                              # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Sensori Off"
    icon: mdi:led-on

  vmc_cucina_grafica_led_pannello_on:                                          # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Pannello On"
    icon: mdi:led-on

  vmc_cucina_grafica_led_pannello_off:                                         # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Pannello Off"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_0:                                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità 0"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_1:                                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità 1"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_2:                                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità 2"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_3:                                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità 3"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_4:                                               # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità 4"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_notturna:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità Notturna"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_iperventilazione:                                # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità Iperventilazione"
    icon: mdi:led-on

  vmc_cucina_grafica_velocita_freecooling:                                     # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] [INTERFACCIA, PIU' RICHIAMI]  
    name: "Led Velocità Free Heating/Cooling"
    icon: mdi:led-on
################### Fine Creazione Switch Booleani impiegati nell'Interfaccia Lovelace per mostrare o meno le Opzioni ####################################################################################

################### Inizio Creazione Switch Booleani impiegati nell'Automazione, per valutare la Velocità in caso di Black-Out e/o SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada ##############################################################

  vmc_cucina_spia_velocita_0:                                                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' 0, IN CASO DI BLACK-OUT
    name: "Spia Velocità 0"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_1:                                                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' 1, IN CASO DI BLACK-OUT
    name: "Spia Velocità 1"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_2:                                                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' 2, IN CASO DI BLACK-OUT
    name: "Spia Velocità 2"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_3:                                                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' 3, IN CASO DI BLACK-OUT
    name: "Spia Velocità 3"
    initial: false
    icon: mdi:memory
    
  vmc_cucina_spia_velocita_4:                                                  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' 4, IN CASO DI BLACK-OUT
    name: "Spia Velocità 4"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_iperventilazione:                       # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' IPERVENTILAZIONE, IN CASO DI BLACK-OUT
    name: "Spia Velocità Iperventilazione"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_notturna:                                           # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' NOTTURNA, IN CASO DI BLACK-OUT
    name: "Spia Velocità Notturna"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_freecooling:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] SENSORE TRACCIAMENTO VELOCITA' FREE-COOLING, IN CASO DI BLACK-OUT
    name: "Spia Velocità Free Cool./Heat."
    initial: false
    icon: mdi:memory    

  vmc_cucina_spia_calendario_lunedi_1:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL LUNEDì 1° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Lunedì 1°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_lunedi_2:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL LUNEDì 2° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Lunedì 2°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_martedi_1:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL MARTEDì 1° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Martedì 1°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_martedi_2:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL MARTEDì 2° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Martedì 2°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_mercoledi_1:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL MERCOLEDì 1° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Mercoledì 1°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_mercoledi_2:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL MERCOLEDì 2° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Mercoledì 2°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_giovedi_1:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL GIOVEDì 1° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Giovedì 1°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_giovedi_2:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL GIOVEDì 2° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Giovedì 2°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_venerdi_1:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL VENERDì 1° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Venerdì 1°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_venerdi_2:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL VENERDì 2° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Venerdì 2°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_sabato_1:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL SABATO 1° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Sabato 1°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_sabato_2:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL SABATO 2° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Sabato 2°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_domenica_1:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL DOMENICA 1° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Domenica 1°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_calendario_domenica_2:                                        # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE TRACCIAMENTO, QUANDO SI E' ALL'INTERNO DEL DOMENICA 2° FASCIA DEL CALENDARIO
    name: "Spia all'interno del Calendario Domenica 2°"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_0_un_solo_avvio:                                    # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' 0, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità 0 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_1_un_solo_avvio:                                    # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' 1, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità 1 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_2_un_solo_avvio:                                    # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' 2, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità 2 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_3_un_solo_avvio:                                    # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' 3, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità 3 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_4_un_solo_avvio:                                    # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' 4, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità 4 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_iperventilazione_un_solo_avvio:                     # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' IPERVENTILAZIONE, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità Iperventilazione 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_notturna_un_solo_avvio:                             # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' NOTTURNA, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità notturna 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_freecooling_un_solo_avvio:                          # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' FREE-COOLING, IN CASO SUPERAMENTO del Lim. Δ P. di Rugiada
    name: "Spia Velocità freecooling 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling:  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' FREE-COOLING, IN CASO DI ALLERTA PROGRAMMATA DEL FREE COOLING
    name: "Spia su Programmazione Velocità Free Cooling 1° Avvio"
    initial: false
    icon: mdi:memory

  vmc_cucina_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating:  # [CONFIGURAZIONE 0 RICHIAMI] [AUTOMAZIONE, PIU' RICHIAMI] SENSORE DI SUPPORTO NELL'AUTOMAZIONE PER IL RIPRISTINO DELLA VELOCITA' FREE-COOLING, IN CASO DI ALLERTA PROGRAMMATA DEL FREE HEATING
    name: "Spia su Programmazione Velocità Free Heating 1° Avvio"
    initial: false
    icon: mdi:memory
################### Fine Creazione Switch Booleani impiegati nell'Automazione, per valutare la Velocità in caso di Black-Out e/o SUPERAMENTO DEL Set Lim. Δ Punto di Rugiada ##############################################

################### Inizio Creazione input datetime per l'accensione e lo spegnimento della VMC per ogni giorno della settimana ###########################################################################################
input_datetime:
  vmc_cucina_accensione_lunedi:                                                # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI] 
    name: "Lun. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_lunedi:                                               # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Lun. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_lunedi_2:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Lun. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline
    
  vmc_cucina_spegnimento_lunedi_2:                                             # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Lun. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_martedi:                                               # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mar. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_martedi:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mar. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline
    
  vmc_cucina_accensione_martedi_2:                                             # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mar. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline
    
  vmc_cucina_spegnimento_martedi_2:                                            # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mar. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline
    
  vmc_cucina_accensione_mercoledi:                                             # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mer. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_mercoledi:                                            # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mer. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_mercoledi_2:                                           # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mer. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline
    
  vmc_cucina_spegnimento_mercoledi_2:                                          # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Mer. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_giovedi:                                               # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Gio. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_giovedi:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Gio. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_giovedi_2:                                             # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Gio. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_giovedi_2:                                            # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Gio. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline
    
  vmc_cucina_accensione_venerdi:                                               # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Ven. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_venerdi:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Ven. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_venerdi_2:                                             # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Ven. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_venerdi_2:                                            # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Ven. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline
    
  vmc_cucina_accensione_sabato:                                                # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Sab. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_sabato:                                               # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Sab. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_sabato_2:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Sab. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline
    
  vmc_cucina_spegnimento_sabato_2:                                             # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Sab. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline
    
  vmc_cucina_accensione_domenica:                                              # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Dom. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline

  vmc_cucina_spegnimento_domenica:                                             # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Dom. 1°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline

  vmc_cucina_accensione_domenica_2:                                            # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Dom. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-play-outline
    
  vmc_cucina_spegnimento_domenica_2:                                           # [CONFIGURAZIONE, PIU’ RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
    name: "Dom. 2°"
    has_date: false
    has_time: true
    icon: mdi:timer-stop-outline
################### Fine Creazione input datetime per l'accensione e lo spegnimento della VMC per ogni giorno della settimana ###########################################################################################

################### Inizio Creazione Scripts ############################################################################################################################################################################
script:
  vmc_cucina_upgrade_sensors:
    alias: Aggiorna i Sensori Manualmente
    sequence:
      - service: homeassistant.update_entity
        target:
          entity_id:
            - sensor.vmc_cucina_status_ip
            - sensor.vmc_cucina_status_ventola
            - sensor.vmc_cucina_sensori
            - sensor.vmc_cucina_nome
            - sensor.vmc_cucina_lan
    mode: restart
    icon: mdi:cursor-pointer   

  vmc_cucina_azzera_offset_sensors:
    alias: Azzeramento Offset dei Sensori
    sequence:
      - service: input_number.set_value
        data:
          entity_id:
            - input_number.vmc_cucina_offset_temp_esterna
            - input_number.vmc_cucina_offset_temp_interna
            - input_number.vmc_cucina_offset_umidita_esterna
            - input_number.vmc_cucina_offset_umidita_interna
          value: 0
    mode: restart
    icon: mdi:trash-can-outline
################### Fine Creazione Scripts ##############################################################################################################################################################################

################### Inizio Creazione dei Servizi ovvero i Comandi da impartire alla VMC ################################################################################################################################# [CONFIGURAZIONE 0 RICHIAMI] [INTERFACCIA, PIU’ RICHIAMI] [AUTOMAZIONE, PIU’ RICHIAMI]
shell_command: 
  vmc_cucina_freecooling: timeout 15s echo -e "VMWH0000007" | nc 192.168.1.160 5001                                   # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO Free Cool./Heat. ALLA VMC
  vmc_cucina_notturna: timeout 15s echo -e "VMWH0000006" | nc 192.168.1.160 5001                                      # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO NOTTURNA         ALLA VMC
  vmc_cucina_iperventilazione: timeout 15s echo -e "VMWH0000005" | nc 192.168.1.160 5001                              # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO IPERVENTILAZIONE ALLA VMC
  vmc_cucina_velocita_4: timeout 15s echo -e "VMWH0000004" | nc 192.168.1.160 5001                                    # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO VELOCITA' 4      ALLA VMC
  vmc_cucina_velocita_3: timeout 15s echo -e "VMWH0000003" | nc 192.168.1.160 5001                                    # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO VELOCITA' 3      ALLA VMC
  vmc_cucina_velocita_2: timeout 15s echo -e "VMWH0000002" | nc 192.168.1.160 5001                                    # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO VELOCITA' 2      ALLA VMC
  vmc_cucina_velocita_1: timeout 15s echo -e "VMWH0000001" | nc 192.168.1.160 5001                                    # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO VELOCITA' 1      ALLA VMC
  vmc_cucina_velocita_0: timeout 15s echo -e "VMWH0000000" | nc 192.168.1.160 5001                                    # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO VELOCITA' 0      ALLA VMC
  vmc_cucina_sensori_on: timeout 15s echo -e "VMWH0300000" | nc 192.168.1.160 5001                                    # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE]  INVIO COMANDO SENSORI  ON     ALLA VMC PER ACCENDERE   I SENSORI, DISATTIVANDO IN MANIERA AUTOMATICA LO STATO DI FUNZIONAMENTO IMPOSTATO DALL'UTENTE
  vmc_cucina_sensori_off: timeout 15s echo -e "VMWH0300002" | nc 192.168.1.160 5001                                   # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO SENSORI  OFF     ALLA VMC PER DISATTIVARE I SENSORI, MANTENENDO LO STATO DI FUNZIONAMENTO IMPOSTATO DALL'UTENTE
  vmc_cucina_pannello_led_on: timeout 15s echo -e "VMWH0100010" | nc 192.168.1.160 5001                               # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO PANNELLO LED ON  ALLA VMC PER ATTIVARE    IL LED PANNELLO DEI COMANDI 
  vmc_cucina_pannello_led_off: timeout 15s echo -e "VMWH0100000" | nc 192.168.1.160 5001                              # [CONFIGURAZIONE] [INTERFACCIA] [AUTOMAZIONE] INVIO COMANDO PANNELLO LED OFF ALLA VMC PER DISATTIVARE IL LED PANNELLO DEI COMANDI
 ################### Fine Creazione dei Servizi ovvero i Comandi da impartire alla VMC   ###################################################################################################################################