type: vertical-stack
cards:
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state_not: ON-Line
    card:
      type: entities
      entities:
        - entity: input_text.vmc_master_ip_insert
          secondary_info: last-changed
        - entity: sensor.vmc_master_nome_status
          secondary_info: last-changed
        - entity: sensor.vmc_master_status_ip_interfaccia
          secondary_info: last-changed
        - entity: sensor.vmc_master_ip
          secondary_info: last-changed
        - entity: script.vmc_master_upgrade_sensors
          secondary_info: last-updated
      state_color: true
      show_header_toggle: false
      title: Ventilazione Meccanica Controllata
      header:
        type: picture
        image: >-
          https://user-images.githubusercontent.com/102819027/253794765-72d95647-d900-4fbc-acfa-6864b7f76321.png
        tap_action:
          action: none
        hold_action:
          action: none
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
      - entity: sensor.vmc_master_alert_monitoraggio_offset_tutti_min
        state: NOT OK
    card:
      type: markdown
      content: >-
        {% if
        is_state('sensor.vmc_master_alert_monitoraggio_offset_tutti_min','NOT
        OK') and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA OFFSET MINIMI</strong></font>

        Valore Offset Min settato per la Temeratura Esterna: {{
        state_attr('input_number.vmc_master_offset_temp_esterna', 'min') |
        float  }}

        Valore Offset Min settato per la Temperatura Interna: {{
        state_attr('input_number.vmc_master_offset_temp_interna', 'min') |
        float  }}

        Valore Offset Min settato per l'Umidità Esterna: {{
        state_attr('input_number.vmc_master_offset_umidita_esterna', 'min') |
        float  }}

        Valore Offset Min settato per l'Umidità Interna: {{
        state_attr('input_number.vmc_master_offset_umidita_interna', 'min') |
        float  }}

        Valore Offset Min settato per l'Anidride Carbonica, CO₂: {{
        state_attr('input_number.vmc_master_offset_co2', 'min') | float  }}

        Valore Offset Min settato per i Composti Organici Volatici, VOC: {{
        state_attr('input_number.vmc_master_offset_voc', 'min') | float  }}


        {% elif
        is_state('sensor.vmc_master_alert_monitoraggio_offset_tutti_min','OK')
        and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')%}
         <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA OFFSET</strong></font>
                 
        Valore Offset settato per la Temeratura Esterna: {{
        states('input_number.vmc_master_offset_temp_esterna') | float  }}

        Valore Offset settato per la Temperatura Interna: {{
        states('input_number.vmc_master_offset_temp_interna') | float  }}

        Valore Offset settato per l'Umidità Esterna: {{
        states('input_number.vmc_master_offset_umidita_esterna') | float  }}

        Valore Offset settato per l'Umidità Interna: {{
        states('input_number.vmc_master_offset_umidita_interna') | float  }}

        Valore Offset Minimo settato per l'Anidride Carbonica, CO₂: {{
        states('input_number.vmc_master_offset_co2') | float  }}

        Valore Offset Minimo settato per i Composti Organici Volatici, VOC: {{
        states('input_number.vmc_master_offset_voc') | float  }}


        Msg. 1


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_umidita_interna_status
        state: '[Non Calcolabile]'
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_master_umidita_interna_status','[Non
        Calcolabile]') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' NON CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] NON CALCOLABILE
         - Umidità Assoluta [g/m³] NON CALCOLABILE       

        Msg. 1


        {% elif states('sensor.vmc_master_umidita_interna_status')!='[Non
        Calcolabile]' and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] CALCOLABILE
         - Umidità Assoluta [g/m³] CALCOLABILE  

        Msg. 2


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_umidita_esterna_status
        state: '[Non Calcolabile]'
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_master_umidita_esterna_status','[Non
        Calcolabile]') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' ESTERNA NON CALCOLABILE</strong></font>
         - Punto di Rugiada Esterno [°C] NON CALCOLABILE
         - Umidità Assoluta Esterna [g/m³] NON CALCOLABILE      

        Msg. 1


        {% elif states('sensor.vmc_master_umidita_esterna_status')!='[Non
        Calcolabile]' and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' ESTERNA CALCOLABILE</strong></font>
         - Punto di Rugiada Esterno [°C] CALCOLABILE
         - Umidità Assoluta Esterna [g/m³] CALCOLABILE

        Msg. 2


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_alert_monitoraggio_umidita
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_master_alert_monitoraggio_umidita','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non
        Calcolabile]' %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>
                    
        {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}


        Msg. 1

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_umidita','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and
        states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non
        Calcolabile]'%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA UMIDITA'</strong></font>
                  
        {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}


        Msg. 2


        {% elif is_state('sensor.vmc_master_alert_monitoraggio_umidita','Nessuna
        Allerta') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')=='[Non
        Calcolabile]' %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' NON CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] NON CALCOLABILE
         - Umidità Assoluta [g/m³] NON CALCOLABILE

        Msg. 3


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - condition: state
        entity: sensor.vmc_master_alert_monitoraggio_co2
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >
        {% set spia_co2_o_voc_partenza_ritorno_velocita_0 =
        states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')
        %}

        {% set spia_co2_o_voc_velocita_0  = 
        states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_1 = 
        states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_2 =
        states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_3   =
        states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_4 =
        states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_notturna =
        states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_freecooling = 
        states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        %}

        {% set spia_co2_o_voc_velocita_iperventilazione =
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')
        %}


        {% set freeheating_cooling =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}



        <!-------1-----[CO2 ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% if is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>ASPIRAZIONE DI INQUINANTI INTERNI</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        Msg. 1


        <!-------2-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
        ne sconsiglia l'impiego"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 2


        <!-------3-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        OFF]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 3


        <!-------4-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 4


        <!-------5-----[CO2 ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppm


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" or
        spia_co2_o_voc_velocita_0=="on" or spia_co2_o_voc_velocita_1=="on"or
        spia_co2_o_voc_velocita_2=="on" or spia_co2_o_voc_velocita_3=="on" or
        spia_co2_o_voc_velocita_4=="on" or
        spia_co2_o_voc_velocita_notturna=="on"or
        spia_co2_o_voc_velocita_freecooling=="on" or
        spia_co2_o_voc_velocita_iperventilazione=="on"%}


        <strong>PRIORITA' ALL' ASPIRAZIONE DI INQUINANTI</strong>


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 0</strong> , NON APPENA:

        {% elif spia_co2_o_voc_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 0</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_1=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 1</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 3</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_4=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 4</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_notturna=="on" %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Heating" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE HEATING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA’ FREE COOLING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_iperventilazione=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' IPERVENTILAZIONE</strong>,
        NON APPENA:{% else %}

        {% endif %}

          - L’ANIDRIDE CARBONICA, CO₂ > DI 350 ppm;
            e
          - L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO.

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>


        {% else %}

        {% endif %}

        Msg. 5, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------6-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppm


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" or
        spia_co2_o_voc_velocita_0=="on" or spia_co2_o_voc_velocita_1=="on"or
        spia_co2_o_voc_velocita_2=="on" or spia_co2_o_voc_velocita_3=="on" or
        spia_co2_o_voc_velocita_4=="on" or
        spia_co2_o_voc_velocita_notturna=="on"or
        spia_co2_o_voc_velocita_freecooling=="on" or
        spia_co2_o_voc_velocita_iperventilazione=="on"%}


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 0</strong> , NON APPENA:

        {% elif spia_co2_o_voc_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 0</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_1=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 1</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 3</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_4=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 4</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_notturna=="on" %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Heating" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE HEATING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA’ FREE COOLING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_iperventilazione=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' IPERVENTILAZIONE</strong>,
        NON APPENA:{% else %}

        {% endif %}

          - L’ANIDRIDE CARBONICA, CO₂ > DI 350 ppm;
            e
          - L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO.

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>


        {% else %}

        {% endif %}

        Msg. 6, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------7.1-----[CO2 OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_co2_status') == '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        Msg. 7.1


        <!-------7.2-----[CO2 OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_co2_status') != '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}}


        Msg. 7.2


        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - condition: state
        entity: sensor.vmc_master_alert_monitoraggio_voc
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >
        {% set spia_co2_o_voc_partenza_ritorno_velocita_0 =
        states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')
        %}

        {% set spia_co2_o_voc_velocita_0  = 
        states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_1 = 
        states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_2 =
        states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_3   =
        states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_4 =
        states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_notturna =
        states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_freecooling = 
        states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        %}

        {% set spia_co2_o_voc_velocita_iperventilazione =
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')
        %}


        {% set freeheating_cooling =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}



        <!-------1-----[VOC ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% if is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>ASPIRAZIONE DI INQUINANTI INTERNI</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        Msg. 1


        <!-------2-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
        ne sconsiglia l'impiego"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 2


        <!-------3-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        OFF]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 3


        <!-------4-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 4


        <!-------5-----[VOC ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppm


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" or
        spia_co2_o_voc_velocita_0=="on" or spia_co2_o_voc_velocita_1=="on"or
        spia_co2_o_voc_velocita_2=="on" or spia_co2_o_voc_velocita_3=="on" or
        spia_co2_o_voc_velocita_4=="on" or
        spia_co2_o_voc_velocita_notturna=="on"or
        spia_co2_o_voc_velocita_freecooling=="on" or
        spia_co2_o_voc_velocita_iperventilazione=="on"%}


        <strong>PRIORITA' ALL' ASPIRAZIONE DI INQUINANTI</strong>


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 0</strong> , NON APPENA:

        {% elif spia_co2_o_voc_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 0</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_1=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 1</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 3</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_4=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 4</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_notturna=="on" %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Heating" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE HEATING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA’ FREE COOLING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_iperventilazione=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' IPERVENTILAZIONE</strong>,
        NON APPENA:{% else %}

        {% endif %}

          - I COMPOSTI ORGANICI VOLATICI, VOC > DI 300 ppb;
            e
          - L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO.

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>


        {% else %}

        {% endif %}

        Msg. 5, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------6-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppm


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" or
        spia_co2_o_voc_velocita_0=="on" or spia_co2_o_voc_velocita_1=="on"or
        spia_co2_o_voc_velocita_2=="on" or spia_co2_o_voc_velocita_3=="on" or
        spia_co2_o_voc_velocita_4=="on" or
        spia_co2_o_voc_velocita_notturna=="on"or
        spia_co2_o_voc_velocita_freecooling=="on" or
        spia_co2_o_voc_velocita_iperventilazione=="on"%}


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 0</strong> , NON APPENA:

        {% elif spia_co2_o_voc_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 0</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_1=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 1</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 3</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_4=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 4</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_notturna=="on" %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Heating" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE HEATING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA’ FREE COOLING</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:

        {% elif spia_co2_o_voc_velocita_iperventilazione=="on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' IPERVENTILAZIONE</strong>,
        NON APPENA:{% else %}

        {% endif %}

          - I COMPOSTI ORGANICI VOLATICI, VOC > DI 300 ppb;
            e
          - L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO.

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>


        {% else %}

        {% endif %}

        Msg. 6, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------7.1-----[VOC OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_voc_status') == '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        Msg. 7.1


        <!-------7.2-----[VOC OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_voc_status') != '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}}


        Msg. 7.2


        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_alert_monitoraggio_pdr
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >
        {% set spia_velocita_0 =
        states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') %}

        {% set spia_velocita_1 =
        states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') %}

        {% set spia_velocita_2 =
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') %}

        {% set spia_velocita_3 =
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') %}

        {% set spia_velocita_4 =
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') %}

        {% set spia_notturna =
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        %}

        {% set spia_freecooling =
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        %}

        {% set spia_iperventilazione =
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        %}


        {% set spia_velocita_1_co2_o_voc_pdr =
        states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') %}


        {% set freeheating_cooling =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}



        <!-------1-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinanti Off] [Interruttore Inquinanti
        OFF]-------------------------------------------------->

        {% if (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and states('input_boolean.vmc_master_spia_co2_o_voc') ==
        'off') and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off" 
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {%if spia_velocita_1_co2_o_voc_pdr!="on"%}<strong>ARRESTO DELLA
        VMC</strong>{% else %}{% endif %}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 1, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------2-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinanti Off] [Interruttore Inquinanti
        ON]----------------------------------------------------->

        {% elif (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and states('input_boolean.vmc_master_spia_co2_o_voc') ==
        'off') and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on" 
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {%if spia_velocita_1_co2_o_voc_pdr!="on"%}<strong>ARRESTO DELLA
        VMC</strong>{% else %}{% endif %}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 2, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------3-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinante CO2 ON, VOC OFF]
        --------------------------------------------------------- -->

        {% elif (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')))  %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 3, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------4-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinante CO2 OFF, VOC ON]
        --------------------------------------------------------- -->

        {% elif (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        or is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')))  %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 4, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------5-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr ON], [Inquinante CO2 OFF, VOC
        OFF]--------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0")  and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc', 'Nessuna
        Allerta'))%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {%if spia_velocita_1_co2_o_voc_pdr!="on"%}<strong> VMC
        ARRESTATA</strong>{% else %}{% endif %}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 5, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------6-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr OFF] , [Spia Free Heating o Free Cooling
        ON]--------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
        =='on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
        or
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'))%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        Msg. 6


        <!-------7-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti
        OFF]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong> SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        Msg. 7


        <!-------8-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti
        ON]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}

        <strong>AVVIO VMC, PRIORITA' ALL' ASPIRAZIONE DI INQUINANTI</strong>

        {% else %}{% endif %}


        Msg. 8


        <!-------9-----[PdR ON] , [Interruttore PdR OFF] , [Velocità != 0] ,
        [Spia CO2 o VOC ON], [Interruttore Inquinanti
        OFF]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0") and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 9


        <!-------10-----[PdR ON] , [Interruttore PdR OFF] , [Velocità != 0] ,
        [Spia CO2 o VOC ON], [Interruttore Inquinanti
        ON]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0") and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 10


        <!-------11-----[PdR ON] , [Interruttore PdR OFF] , [Velocità != 0] ,
        [Spia CO2 o VOC OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0") and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta'))%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA:</strong>
          - DI ARRESTARE LA VMC NEL CASO IN CUI NON SIA GIÀ STATA ARRESTATA A CAUSA DI ALTRE ALLERTE.
        e/o
          - DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada]

        Msg. 11


        <!-------12-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong> SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 12


        <!-------13-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , 
        [Spia Pdr ON] , [Spia CO2 o VOC ON], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>VMC ARRESTATA</strong>


        {% if spia_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{% else %}{%
        endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 13, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato



        <!-------14-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , 
        [Spia Pdr ON] , [Spia CO2 o VOC ON], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>VMC ARRESTATA</strong>


        {% if spia_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{% else %}{%
        endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 14, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato



        <!-------15 -----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] , 
        [Spia Pdr ON] , [Spia CO2 o VOC ON], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>ARRESTO DELLA VMC</strong>



        {% if spia_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{% else %}{%
        endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        <strong>, DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>

        {% else %}{% endif %}


        Msg. 15


        <!-------16-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong> SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 16


        <!-------17-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 17


        <!-------18-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 18


        <!-------19-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong> SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 19


        <!-------20-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 20


        <!-------21-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        Msg. 21


        <!-------22-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        Msg. 22


        <!-------23-----[PdR OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Si può impiegare" and
        is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA PER SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        Msg. 23


        <!-------24-----[PdR NON CALCOLABILE]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "[Non Calcolabile]" and
        is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> LIM. Δ PUNTO DI RUGIADA NON CALCOLABILE</strong></font>

        Msg. 24


        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_alert_monitoraggio_congelamento
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if
        is_state('sensor.vmc_master_alert_monitoraggio_congelamento','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA CONGELAMENTO</strong></font>

        {{states('sensor.vmc_master_congelamento_verifica_soglia_valore')}}


        Msg. 1


        {% elif
        is_state('sensor.vmc_master_alert_monitoraggio_congelamento','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line')%}
         <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA CONGELAMENTO</strong></font>
                 
        {{states('sensor.vmc_master_congelamento_verifica_soglia_valore')}}


        Msg. 2


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_alert_monitoraggio_delta
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_master_alert_monitoraggio_delta', 'Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA DIFF. TEMP. (INT-EST) > 23 °C</strong></font>

        {{states('sensor.vmc_master_delta_temp_verifica_soglia_valore')}}


        Msg. 1


        {% elif is_state('sensor.vmc_master_alert_monitoraggio_delta', 'Nessuna
        Allerta') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')%}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA DIFF. TEMP. (INT-EST) > 23 °C</strong></font>


        {{states('sensor.vmc_master_delta_temp_verifica_soglia_valore')}}


        Msg. 2


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: 'on'
      - condition: state
        entity: >-
          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_disabilitato
        state: OK
    card:
      type: markdown
      content: >
        {% set spia_free_cooling =
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        %}

        {% set spia_free_heating =
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        %}


        {% set co2 = states('sensor.vmc_master_alert_monitoraggio_co2') %}

        {% set voc = states('sensor.vmc_master_alert_monitoraggio_voc') %}  


        {% set automazione_free_cooling =
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling')
        %}

        {% set automazione_free_heating =
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating')
        %} 


        {% set tipologia =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}


        {% set velocita =
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        %}


        {% set temp_interna = states('sensor.vmc_master_temp_interna_status') |
        float(0) %}

        {% set temp_esterna = states('sensor.vmc_master_temp_esterna_status') |
        float(0) %} 


        {% set avviso_da_mostrare =
        states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_disabilitato')
        %}


        {% set interruttore_inquinanti =
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')
        %}




        <!--------------------------------- INIZIO FREE HEATING
        ----------------------------------- -->
         <!--------------------------------------1 ------------------------------- -->
        {% if ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>VMC ARRESTATA</strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 1, Free Heating Allarmato


        <!--------------------------------------2-------------------------------
        -->

        <!------------------2.1 Interruttore Inquinanti ON ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>IN ALTERNATIVA, LA VMC SI RIAVVIERÀ AUTOMATICAMENTE ALLA
        VELOCITÀ FREE HEATING (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING;

        <strong> ALTRIMENTI, LA RIPRESA AUTOMATICA VERRÀ ANNULLATA IMPOSTANDO LA
        VELOCITÀ DELLA VMC A 1.</strong>


        Msg. 2.1, Free Heating Allarmato


        <!------------------2.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 2.2, Free Heating Allarmato


        <!--------------------------------------3-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %} 
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>VMC ARRESTATA </strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 3, Free Heating Allarmato


        <!--------------------------------------4-------------------------------
        -->
         {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and automazione_free_heating == "on" and temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>VMC IN ARRESTO</strong>


        Msg. 4, Free Heating Allarmato


        <!--------------------------------------5-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 5 Free Heating


        <!--------------------------------------6-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]
          
        <strong>VMC IN ARRESTO</strong>


        Msg. 6 Free Heating


        <!--------------------------------------7-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and
        ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK")
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 7, Free Heating Allarmato


        <!--------------------------------------8-------------------------------
        -->

        <!------------------8.1 Interruttore Inquinanti ON ---------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 8.1, Free Heating Allarmato


        <!------------------8.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 8.2, Free Heating Allarmato


        <!-------------------------------------13-------------------------------
        -->

        <!------------------13.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA
        RAFFRESCAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 13.1 Free Heating


        <!------------------13.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA
        RAFFRESCAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 13.2 Free Heating


        <!-------------------------------------14 [CRITERIO MODIFICATO RISPETTO
        LA CONFIGURAZIONE PER AGGIUNTA VELOCITA' DIVERSA DA
        0]------------------------------- -->

        <!------------------14.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        velocita != "Velocità 0" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 14.1 Free Heating


        <!------------------14.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        velocita != "Velocità 0" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 14.2 Free Heating


        <!-------------------------------------14.1 [CRITERIO AGGIUNTO RISPETTO
        LA CONFIGURAZIONE]------------------------------- -->

        <!------------------14.1.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>AVVIO VMC A VELOCITA' 1 </strong>


        <strong>DIVERSAMENTE SI CONFERMA L'ARRESTO DELLA VMC:</strong>

          - NON APPENA L'ANIDRIDE CARBONICA, CO₂ ≤ DI 350 ppm e/o I COMPOSTI ORGANICI VOLATICI, VOC ≤ DI 300 ppb;
            o
          - FINCHE' L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO.

        Msg. 14.1.1 Free Heating


        <!------------------14.1.2 Interruttore Inquinanti OFF
        ------------------ -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        velocita == "Velocità 0" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        Msg. 14.1.2 Free Heating




        <!--------------------------------- INIZIO INIZIO FREE COOLING
        ----------------------------------- -->
         <!--------------------------------------1 ------------------------------- -->
        {% elif (  tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>VMC ARRESTATA</strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 1, Free Cooling Allarmato


        <!--------------------------------------2-------------------------------
        -->

        <!------------------2.1 Interruttore Inquinanti ON ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>IN ALTERNATIVA, LA VMC SI RIAVVIERÀ AUTOMATICAMENTE ALLA
        VELOCITÀ FREE COOLING (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING;

        <strong> ALTRIMENTI, LA RIPRESA AUTOMATICA VERRÀ ANNULLATA IMPOSTANDO LA
        VELOCITÀ DELLA VMC A 1.</strong>


        Msg. 2.1, Free Cooling Allarmato


        <!------------------2.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 2.2, Free Cooling Allarmato


        <!--------------------------------------3-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %} 
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>VMC ARRESTATA </strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 3, Free Cooling Allarmato


        <!--------------------------------------4-------------------------------
        -->
         {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling" and automazione_free_cooling == "on" and temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>VMC IN ARRESTO</strong>


        Msg. 4, Free Cooling Allarmato


        <!--------------------------------------5-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 5 Free Cooling


        <!--------------------------------------6-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]
          
        <strong>VMC IN ARRESTO</strong>


        Msg. 6 Free Cooling


        <!--------------------------------------7-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and
        ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK")
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 7, Free Cooling Allarmato


        <!--------------------------------------8-------------------------------
        -->

        <!------------------8.1 Interruttore Inquinanti ON ---------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 8.1, Free Cooling Allarmato


        <!------------------8.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO;
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING;

        <strong>, DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA,
        CONFERMANDO L'ARRESTO DELLA VMC. </strong>


        Msg. 8.2, Free Cooling Allarmato


        <!-------------------------------------13-------------------------------
        -->

        <!------------------13.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA
        RISCALDAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 13.1 Free Cooling


        <!------------------13.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA
        RISCALDAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 13.2 Free Cooling


        <!-------------------------------------14 [CRITERIO MODIFICATO RISPETTO
        LA CONFIGURAZIONE PER AGGIUNTA VELOCITA' DIVERSA DA
        0]------------------------------- -->

        <!------------------14.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and velocita != "Velocità 0" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 14.1 Free Cooling


        <!------------------14.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and velocita != "Velocità 0" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 14.2 Free Cooling


        <!-------------------------------------14.1 [CRITERIO AGGIUNTO RISPETTO
        LA CONFIGURAZIONE]------------------------------- -->

        <!------------------14.1.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>AVVIO VMC A VELOCITA' 1 </strong>


        <strong>DIVERSAMENTE SI CONFERMA L'ARRESTO DELLA VMC:</strong>

          - NON APPENA L'ANIDRIDE CARBONICA, CO₂ ≤ DI 350 ppm e/o I COMPOSTI ORGANICI VOLATICI, VOC ≤ DI 300 ppb;
            o
          - FINCHE' L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO.

        Msg. 14.1.1 Free Cooling


        <!------------------14.1.2 Interruttore Inquinanti OFF
        ------------------ -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and velocita == "Velocità 0" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        Msg. 14.1.2 Free Cooling




        <!--------------------------------- INIZIO INIZIO FREE HEATING/FREE
        COOLING  DISABILITATO ----------------------------------- -->

        <!-------------------------------------33
        ------------------------------- -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RAFFRESCAMENTO IN ATTO</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 33


        <!-------------------------------------34-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RAFFRESCAMENTO IN ATTO, PRESENZA DI INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 34


        <!-------------------------------------35-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_esterna > temp_interna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RISCALDAMENTO IN ATTO</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 35


        <!-------------------------------------36-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_esterna > temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RISCALDAMENTO IN ATTO, PRESENZA DI INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 36


        <!-------------------------------------39-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita != "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA
        RAFFRESCAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 39
           
        <!-------------------------------------40-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita != "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA RAFFRESCAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]     


        Msg. 40


        <!-------------------------------------41-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and  velocita != "Free Cooling"
        and temp_esterna > temp_interna | float(0) and ((co2 !="Allerta") and
        (voc !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA
        RISCALDAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 41


        <!-------------------------------------42-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita != "Free Cooling" and
        temp_esterna > temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]     


        Msg. 42




        <!--------------------------------- NESSUNA_ALLERTA_INIZIO_FREE_HEATING
        ----------------------------------- -->

        <!-------------------------------------9-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9 Free Heating


        <!-------------------------------------9.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9.1 Free Heating


        <!-------------------------------------10-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10 Free Heating


        <!-------------------------------------10.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10.1 Free Heating


        <!-------------------------------------11-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11 Free Heating


        <!-------------------------------------11.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11.1 Free Heating


        <!-------------------------------------12-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12 Free Heating


        <!-------------------------------------12.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12.1 Free Heating


        <!-------------------------------------13-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna < temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 13 Free Heating


        <!-------------------------------------15.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna == temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 15.1 Free Heating


        <!-------------------------------------16-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna < temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16 Free Heating


        <!-------------------------------------16.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna == temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16.1 Free Heating




        <!--------------------------------- NESSUNA ALLERTA INIZIO FREE COOLING
        ----------------------------------- -->

        <!-------------------------------------9-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9 Free Cooling"


        <!-------------------------------------9.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9.1 Free Cooling


        <!-------------------------------------10-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10 Free Cooling


        <!-------------------------------------10.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10.1 Free Cooling


        <!-------------------------------------11-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11 Free Cooling


        <!-------------------------------------11.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11.1 Free Cooling


        <!-------------------------------------12-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12 Free Cooling


        <!-------------------------------------12.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12.1 Free Cooling


        <!-------------------------------------13-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna < temp_interna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 13 Free Cooling


        <!-------------------------------------15.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna == temp_interna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 15.1 Free Cooling


        <!-------------------------------------16-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna < temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16 Free Cooling


        <!-------------------------------------16.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna == temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16.1 Free Cooling







        <!--------------------------------- NESSUNA ALLERTA INIZIO FREE HEATING,
        FREE COOLING DISABILITATO ----------------------------------- -->

        <!-------------------------------------37-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna == temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING/FREE COOLING</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 37


        <!-------------------------------------38-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna ==temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING/FREE COOLING, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 38


        <!-------------------------------------43-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and  velocita != "Free Cooling"
        and temp_esterna == temp_interna | float(0) and ((co2 !="Allerta") and
        (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 43


        <!-------------------------------------44-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and  velocita != "Free Cooling"
        and temp_esterna == temp_interna | float(0) and ((co2 =="Allerta") or
        (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA, PRESENZA DI INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 44




        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:help-circle-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+0"> STATO NON
        DISPONIBILE</font>


        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
    card:
      type: vertical-stack
      cards:
        - type: entities
          entities:
            - entity: sensor.vmc_master_nome_status
              secondary_info: last-updated
            - entity: >-
                sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
              secondary_info: last-updated
            - entity: sensor.vmc_master_spia_pannello_alert_monitoraggio_totale
              secondary_info: last-updated
          state_color: true
          show_header_toggle: true
          title: Ventilazione Meccanica Controllata
          footer:
            type: buttons
            entities:
              - entity: input_boolean.vmc_master_opzioni_vmc
              - entity: input_boolean.vmc_master_opzioni_monitoraggio_sensori
              - entity: input_boolean.vmc_master_opzioni_interruttore_calendario
              - entity: input_boolean.vmc_master_opzioni_offset_sensori
              - entity: input_boolean.vmc_master_opzioni_avvisi
              - entity: input_boolean.vmc_master_opzioni_lettura_sensori
          header:
            type: picture
            image: >-
              https://user-images.githubusercontent.com/102819027/253794765-72d95647-d900-4fbc-acfa-6864b7f76321.png
            tap_action:
              action: call-service
              service: input_boolean.toggle
              service_data:
                entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
            hold_action:
              action: call-service
              service: input_boolean.toggle
              service_data:
                entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_master_opzioni_vmc
              state: 'on'
          card:
            square: false
            type: grid
            cards:
              - square: false
                type: grid
                cards:
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_sensori_off
                      target: {}
                    name: Sensori Off
                    show_state: true
                    icon: mdi:chip
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_sensori_on
                      target: {}
                    name: Sensori On
                    show_state: true
                    icon: mdi:chip
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_pannello_led_off
                      target: {}
                    name: Led Pannello Off
                    show_state: true
                    icon: mdi:led-off
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_pannello_led_on
                      target: {}
                    name: Led Pannello On
                    show_state: true
                    icon: mdi:led-on
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_0
                      target: {}
                    show_state: true
                    name: Velocità 0
                    icon: mdi:numeric-0-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_1
                      target: {}
                    name: Velocità 1
                    show_state: true
                    icon: mdi:numeric-1-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_2
                      target: {}
                    name: Velocità 2
                    show_state: true
                    icon: mdi:numeric-2-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_3
                      target: {}
                    name: Velocità 3
                    show_state: true
                    icon: mdi:numeric-3-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_4
                      target: {}
                    name: Velocità 4
                    show_state: true
                    icon: mdi:numeric-4-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_notturna
                      target: {}
                    name: Notturna
                    show_state: true
                    icon: mdi:weather-night
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_iperventilazione
                      target: {}
                    name: Iperventilazione
                    show_state: true
                    icon: mdi:wind-power
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_freecooling
                      target: {}
                    name: Free Cool./Heat.
                    show_state: true
                    icon: mdi:sun-snowflake-variant
                    hold_action:
                      action: none
                columns: 4
              - type: horizontal-stack
                cards:
                  - type: entities
                    entities:
                      - entity: >-
                          sensor.vmc_master_status_sensori_lettura_codice_interpretato
                        secondary_info: last-updated
                      - entity: >-
                          sensor.vmc_master_status_led_pannello_lettura_codice_interpretato
                        secondary_info: last-updated
                      - entity: sensor.vmc_master_status_calcolo_portata_ventola
                        secondary_info: last-updated
                      - entity: >-
                          sensor.vmc_master_status_portata_ventola_lettura_codice_interpretato
                        secondary_info: last-updated
            columns: 1
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_master_opzioni_monitoraggio_sensori
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: sensor.vmc_master_temp_esterna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_temp_interna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_umidita_esterna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_umidita_interna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_co2_status
                    secondary_info: last-changed
                  - entity: sensor.vmc_master_voc_status
                    secondary_info: last-changed
                  - entity: script.vmc_master_upgrade_sensors
                title: Sensori
                footer:
                  type: buttons
                  entities:
                    - entity: >-
                        input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                    - entity: >-
                        input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_number.vmc_master_offset_temp_esterna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_temp_interna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_umidita_esterna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_umidita_interna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_co2
                        - entity: input_number.vmc_master_offset_voc
                        - entity: script.vmc_master_azzera_offset_sensors
                          secondary_info: last-triggered
                      title: Sensori - Offset
                      state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: sensor.vmc_master_punto_di_rugiada_esterno
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_punto_di_rugiada_interno
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_umidita_assoluta_esterna
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_umidita_assoluta_interna
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_punto_di_rugiada_valore
                          secondary_info: last-changed
                      title: Sensori - Extra
                      state_color: true
                    - type: vertical-stack
                      cards:
                        - type: entities
                          entities:
                            - entity: >-
                                sensor.vmc_master_temp_esterna_status_senza_offset
                              secondary_info: last-updated
                            - entity: >-
                                sensor.vmc_master_temp_interna_status_senza_offset
                              secondary_info: last-updated
                            - entity: >-
                                sensor.vmc_master_umidita_esterna_status_senza_offset
                              secondary_info: last-updated
                            - entity: >-
                                sensor.vmc_master_umidita_interna_status_senza_offset
                              secondary_info: last-updated
                            - entity: sensor.vmc_master_co2_status_senza_offset
                            - entity: sensor.vmc_master_voc_status_senza_offset
                          title: Sensori - Offset Disabilitato
                          state_color: true
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_master_opzioni_interruttore_calendario
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: >-
                      sensor.vmc_master_status_accensione_vmc_tramite_calendario_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_master_status_accensione_vmc_tramite_calendario_2_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2_interfaccia
                    secondary_info: last-updated
                title: Programmazione Giornaliera
                state_color: true
              - type: entities
                entities:
                  - entity: >-
                      sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                    secondary_info: last-updated
                state_color: true
                title: Programmazione Mensile
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_master_opzioni_offset_sensori
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: sensor.vmc_master_ip
                  - entity: input_text.vmc_master_ip_insert
                    secondary_info: last-changed
                  - entity: input_text.vmc_master_nome_da_inserire
                    secondary_info: last-updated
                  - entity: input_number.vmc_master_volume_da_inserire
                    secondary_info: last-updated
                  - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
                    secondary_info: last-updated
                  - entity: >-
                      input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc
                  - entity: automation.automazione_vmc_master
                    secondary_info: last-updated
                    icon: mdi:light-switch-off
                  - entity: script.vmc_master_bottone_panico
                    secondary_info: last-updated
                  - entity: script.vmc_master_profilo_inizializzazione
                    secondary_info: last-updated
                state_color: false
                title: Opzioni
                footer:
                  type: buttons
                  entities:
                    - entity: input_boolean.vmc_master_opzioni_punto_di_rugiada
                    - entity: input_boolean.vmc_master_opzioni_calendario_main
                    - entity: >-
                        input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                show_header_toggle: false
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_master_opzioni_punto_di_rugiada
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_number.vmc_master_offset_verifica_impiego_vmc
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr
                          secondary_info: last-updated
                        - entity: script.vmc_master_profilo_pdr
                          secondary_info: last-updated
                      state_color: false
                      title: Opzioni - Punto di Rugiada
                      show_header_toggle: false
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_master_opzioni_calendario_main
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_select.vmc_master_speed_1_fascia_calendario
                        - entity: input_select.vmc_master_speed_2_fascia_calendario
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
                          secondary_info: last-updated
                        - entity: script.vmc_master_profilo_calendario
                          secondary_info: last-updated
                      footer:
                        type: buttons
                        entities:
                          - entity: input_boolean.vmc_master_opzioni_calendario
                      title: Opzioni - Calendario
                      state_color: false
                      show_header_toggle: false
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_master_opzioni_calendario
                    state: 'on'
                card:
                  square: true
                  columns: 2
                  type: grid
                  cards:
                    - type: entities
                      entities:
                        - entity: input_datetime.vmc_master_accensione_lunedi
                        - entity: input_datetime.vmc_master_accensione_lunedi_2
                        - entity: input_datetime.vmc_master_accensione_martedi
                        - entity: input_datetime.vmc_master_accensione_martedi_2
                        - entity: input_datetime.vmc_master_accensione_mercoledi
                        - entity: input_datetime.vmc_master_accensione_mercoledi_2
                        - entity: input_datetime.vmc_master_accensione_giovedi
                        - entity: input_datetime.vmc_master_accensione_giovedi_2
                        - entity: input_datetime.vmc_master_accensione_venerdi
                        - entity: input_datetime.vmc_master_accensione_venerdi_2
                        - entity: input_datetime.vmc_master_accensione_sabato
                        - entity: input_datetime.vmc_master_accensione_sabato_2
                        - entity: input_datetime.vmc_master_accensione_domenica
                        - entity: input_datetime.vmc_master_accensione_domenica_2
                      title: Accensione
                      state_color: true
                    - type: entities
                      entities:
                        - entity: input_datetime.vmc_master_spegnimento_lunedi
                        - entity: input_datetime.vmc_master_spegnimento_lunedi_2
                        - entity: input_datetime.vmc_master_spegnimento_martedi
                        - entity: input_datetime.vmc_master_spegnimento_martedi_2
                        - entity: input_datetime.vmc_master_spegnimento_mercoledi
                        - entity: input_datetime.vmc_master_spegnimento_mercoledi_2
                        - entity: input_datetime.vmc_master_spegnimento_giovedi
                        - entity: input_datetime.vmc_master_spegnimento_giovedi_2
                        - entity: input_datetime.vmc_master_spegnimento_venerdi
                        - entity: input_datetime.vmc_master_spegnimento_venerdi_2
                        - entity: input_datetime.vmc_master_spegnimento_sabato
                        - entity: input_datetime.vmc_master_spegnimento_sabato_2
                        - entity: input_datetime.vmc_master_spegnimento_domenica
                        - entity: input_datetime.vmc_master_spegnimento_domenica_2
                      title: Spegnimento
                      state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                    state: 'on'
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_select.vmc_master_mese_1_fascia_freeheating
                          secondary_info: last-updated
                        - entity: input_select.vmc_master_mese_2_fascia_freeheating
                          secondary_info: last-updated
                        - entity: input_select.vmc_master_mese_1_fascia_freecooling
                          secondary_info: last-changed
                        - entity: input_select.vmc_master_mese_2_fascia_freecooling
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling
                          secondary_info: last-updated
                        - entity: script.vmc_master_profilo_free_heating_cooling
                          secondary_info: last-updated
                      title: Opzioni - Free Heating / Free Cooling
                      state_color: true
                      show_header_toggle: false
        - type: conditional
          conditions:
            - condition: state
              entity: input_boolean.vmc_master_opzioni_avvisi
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: entities
                    entities:
                      - entity: sensor.vmc_master_co2_status_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_voc_status_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_alert_monitoraggio_pdr
                        secondary_info: last-changed
                      - entity: >-
                          sensor.vmc_master_umidita_interna_status_verifica_soglia
                        secondary_info: last-changed
                      - entity: >-
                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_delta_temp_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_congelamento_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_alert_monitoraggio_black_out
                        secondary_info: last-changed
                    title: Avvisi
                    state_color: true
                    footer:
                      type: buttons
                      entities:
                        - entity: input_boolean.vmc_master_opzioni_avvisi_grafici
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.vmc_master_opzioni_avvisi_grafici
                    state: 'on'
                card:
                  square: false
                  type: grid
                  cards:
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_temp_interna_status
                      name: Temperatura Interna
                      unit: '[°C]'
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_temp_esterna_status
                      name: Temperatura Esterna
                      unit: '[°C]'
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_umidita_interna_status
                      name: Umidità Interna
                      unit: '[%]'
                    - graph: line
                      type: sensor
                      detail: 2
                      name: Umidità Esterna
                      entity: sensor.vmc_master_umidita_esterna_status
                      unit: '[%]'
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_co2_status
                      name: Anidride Carbonica
                      unit: '[ppm]'
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_voc_status
                      name: VOC
                      unit: '[ppm]'
                    - graph: line
                      type: sensor
                      detail: 2
                      name: Punto di Rugiada Interno
                      entity: sensor.vmc_master_punto_di_rugiada_interno
                      unit: '[°C]'
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_punto_di_rugiada_esterno
                      name: Punto di Rugiada Esterno
                      unit: '[°C]'
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_umidita_assoluta_interna
                      name: Umidità Assoluta Interna
                      unit: ' [g/m³]'
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_umidita_assoluta_esterna
                      name: Umidità Assoluta Esterna
                      unit: ' [g/m³]'
                  columns: 2
        - type: conditional
          conditions:
            - entity: input_boolean.vmc_master_opzioni_lettura_sensori
              state: 'on'
          card:
            type: vertical-stack
            cards:
              - type: markdown
                content: >-
                  <pre style="font-size:6px; background-color: #d9ffcc;">

                  <ha-icon icon="mdi:hvac"></ha-icon><strong> VMC HELTY FLOW
                  Plus/Elite</strong> by Ing. Danilo Robotti    
                      - Release Installata: {{ states('sensor.vmc_master_versione_corrente')}}{% if states('sensor.vmc_master_versione_repository') != states('sensor.vmc_master_versione_corrente') and states('sensor.vmc_master_versione_repository') != "Errore Connessione" %}
                      -</ha-icon><strong> Aggiornamento Repository: {{ states('sensor.vmc_master_versione_repository') }}</strong>
                  {% else %}
                      -</ha-icon><strong> Nessun Aggiornamento</strong>
                  {% endif %}

                  <ha-icon icon="mdi:email-fast"></ha-icon> <a
                  href="mailto:danilo.robotti@gmail.com">Mail</a> <ha-icon
                  icon="mdi:human-handsup"></ha-icon><a
                  href="https://github.com/DanRobo76/VMC-HELTY-FLOW">Link</a><br>

                  <ha-icon icon="mdi:file-sign"></ha-icon> <strong>Esonero di
                  Responsabilità:</strong> 

                  In nessun caso lo sviluppatore sarà responsabile 

                  di danneggiamenti diretti, indiretti o conseguenti

                  , correlati a difetti del presente SoftWare. 

                  Il Cliente ha l’onere e la responsabilità della 

                  scelta, dell’installazione,  dell’uso e della 

                  gestione del SoftWare al fine del raggiungimento 

                  del  risultato prefissatosi.

                  </pre>


                  ### **Info Lettura Dati nella VMC**


                  <strong>- Sensori Ventilazione</strong> 

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{
                  states('sensor.vmc_master_status_ventola') }} {% endif
                  %}</pre>

                  <strong>- Sensori Ambientali</strong>

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_master_sensori') }}
                  {% endif %}</pre> 

                  <strong>- Lan</strong>

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_master_lan') }} {%
                  endif %}</pre>

                  <strong>- Nome</strong>

                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_master_nome') }} {%
                  endif %}</pre>


                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Status Routine Sensori</strong><br>

                  Se la funzione è disabilitata i valori rilevati dai sensori
                  nella schermata INFO dell'App Mobile non saranno più

                  disponibili e le relative funzioni e allarmi settati nel
                  Firmware della VMC saranno disattivati. 

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Status Pannello Led</strong><br>

                  Per attivare o disattivare i LED

                  del pannello comandi della VMC. 

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Congelamento [°C]</strong><br>

                  Blocca l’unità se la temperatura esterna rilevata è inferiore
                  di -18 °C,

                  indipendentemente dall'Offset settato.

                  <br>

                  Impostazione di default nel firmware della VMC.

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Differenziale tra temperatura interna ed esterna
                  [°C]</strong><br>

                  Se il differenziale è maggiore di 23°C Porta l’unità a
                  Velocità 1

                  indipendentemente dagli Offset settati.

                  <br>

                  Impostazione di default nel firmware della VMC.

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Punto di Rugiada [°C]</strong><br>

                  Quando la temperatura di un oggetto è inferiore al punto di
                  rugiada, il vapore acqueo presente nell'aria si condenserà
                  sulla superficie dell'oggetto. 

                  </div>

                  <br>


                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Verifica Impiego della VMC per il superamento del
                  [Lim. Δ P. di Rugiada]</strong><br>

                  Assicurarsi che il punto di rugiada dell'aria esterna meno il
                  punto di rugiada dell'aria interna, sia minore di qualche
                  grado  °C (impostare il [Set Lim. Δ P. di Rugiada]) prima di
                  iniziare la ventilazione.

                  In questo modo si ha la garanzia di trasportare l'umidità
                  dall'interno verso l'esterno.

                  <br>

                  <br>

                  Valutare pertanto se Attivare l'Opzione:

                  <br>

                  [VMC ON/OFF, per Superamento Lim. Δ P. di Rugiada]

                  <br>

                  <br>

                  Le soglie di differenza di rugiada da considerare per la
                  ventilazione possono variare in funzione delle condizioni
                  ambientali. Ecco alcune soglie di differenza di rugiada da
                  considerare in base alle diverse condizioni:


                  In condizioni normali di temperatura e umidità, una differenza
                  di rugiada di almeno 3-4°C è sufficiente per garantire un
                  adeguato trasporto dell'umidità dall'interno all'esterno
                  dell'edificio.


                  In presenza di temperature esterne particolarmente elevate e
                  di un elevato tasso di umidità, potrebbe essere necessario
                  aumentare la differenza di rugiada a 5-6°C o anche di più per
                  evitare la formazione di condensa.


                  In presenza di temperature esterne particolarmente basse e di
                  un basso tasso di umidità, la differenza di rugiada necessaria
                  potrebbe essere inferiore, anche solo di 1-2°C.


                  In ambienti particolarmente umidi, come ad esempio nei bagni o
                  nelle cucine, potrebbe essere necessario adottare una soglia
                  di differenza di rugiada più elevata per evitare la formazione
                  di condensa sulle superfici.


                  In ambienti in cui è presente un elevato tasso di inquinamento
                  dell'aria, come ad esempio in prossimità di strade trafficate
                  o di impianti industriali, potrebbe essere necessario adottare
                  una soglia di differenza di rugiada più elevata per evitare
                  l'ingresso di agenti inquinanti nell'edificio.


                  Tuttavia, è importante considerare che queste soglie sono
                  indicative e che la scelta della soglia più appropriata
                  dipende da una serie di fattori, come ad esempio il tipo di
                  edificio, le attività svolte al suo interno, il numero di
                  persone presenti e le condizioni climatiche locali. In ogni
                  caso, è consigliabile consultare un esperto del settore per
                  determinare la soglia di differenza di rugiada più appropriata
                  per le specifiche condizioni dell'edificio.


                  <pre style="font-size: smaller;">

                  P.di Rugiada Esterna - P. di Rugiada Interno < Set Lim. Δ P.
                  di Rugiada -> <font color="rgb(128, 0, 128)">Si può impiegare
                  [Nessuna Allerta]</font>

                  P.di Rugiada Esterna - P. di Rugiada Interno ≥ Set Lim. Δ P.
                  di Rugiada ->  <font color="rgb(100, 100, 100)">Se ne
                  sconsiglia l'impiego [Allerta]</font>

                  <font color='green'><br>Se l'Opzione [VMC ON/OFF, per
                  Superamento Lim. Δ P. di Rugiada] è Attiva ed è stato superato
                  il valore 

                  del [Set Lim. Δ P. di Rugiada], allora la VMC si
                  Arresterà.</font>

                  </pre>


                  Suggerimenti di impostazione del [Set Lim. Δ P. di Rugiada]:
                    - Locale Bagno, Master: 7°C
                    - Locale Camera: 5°C
                  </div>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Lim. CO₂ e/o VOC</strong><br>

                  Quando l'impostazione è Attiva e l'Anidride Carbonica supera
                  il valore di soglia (350 [ppm]) o i Composti Organici
                  Volatici, VOC, superano il valore di soglia (300 [ppb]), viene
                  avviata la VMC da Velocità 0 a Velocità 1; se non intervengono
                  altri fattori esterni la VMC viene nuovamente arrestata non
                  appena i valori si trovano sotto i valori di soglia.

                  <br>

                  L'impostazione ha priorità rispetto il Superamento del Lim. Δ
                  P. di Rugiada, il Calendario e sul Free Heating / Free
                  Cooling.

                  </div>

                  <br>

                  <h4 style="font-size: smaller;">Range Sensore Umidità U [%],
                  se:</h4>

                  <pre style="font-size: smaller;">
                           U ≤ 0     <font color="rgb(128, 0, 128)">Non Calcolabile [Nessuna Allerta]</font>
                       0 < U ≤ 35    <font color="rgb(100, 100, 100)">Possibile Secchezza, Disidratazione [Allerta Pop-Up]</font>
                      35 < U ≤ 65    <font color="rgb(128, 0, 128)">Normale [Nessuna Allerta]</font>
                      65 < U ≤ 100   <font color="rgb(100, 100, 100)">Possibile Muffe, Batteri [Allerta Pop-Up]</font>
                  </pre>

                  <h4 style="font-size: smaller;">Umidità Assoluta U [g/m³],
                  se:</h4>

                  <pre style="font-size: smaller;">
                              U ≤ 0  Non Calcolabile
                  Temp. Interna ≤ 0  Non Calcolabile

                  </pre>

                  <h4 style="font-size: smaller;">Range Sensore CO₂ [ppm],
                  se:</h4>

                  <pre style="font-size: smaller;">
                         CO₂ ≤ 0     <font color="rgb(128, 0, 128)">Assente [Nessuna Allerta]</font>
                     0 < CO₂ ≤ 350   <font color="rgb(128, 0, 128)">Bassa Contentrazione [Nessuna Allerta]</font>
                   350 < CO₂ ≤ 600   <font color="rgb(100, 100, 100)">Moderata Concentrazione [Allerta Pop-Up]</font>
                   600 < CO₂ < 1200  <font color="rgb(100, 100, 100)">Alta Concentrazione [Allerta Pop-Up]</font>
                         CO₂ ≥ 1200  <font color="rgb(100, 100, 100)">Pessima Concentrazione [Allerta Pop-Up]</font>
                  </pre>

                  <h4 style="font-size: smaller;">Range Sensore VOC [ppb],
                  se:</h4>

                  <pre style="font-size: smaller;">
                        VOC ≤ 0     <font color="rgb(128, 0, 128)">Assente [Nessuna Allerta]</font>
                    0 < VOC ≤ 300   <font color="rgb(128, 0, 128)">Bassa Contentrazione [Nessuna Allerta]</font>
                  300 < VOC ≤ 600   <font color="rgb(100, 100, 100)">Moderata
                  Concentrazione [Allerta Pop-Up]</font>
                        VOC > 600   <font color="rgb(100, 100, 100)">Pessima Concentrazione [Allerta Pop-Up]</font>
                  </pre>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Calendario</strong><br>

                  Permette di organizzare per ogni giorno della settimana
                  l'orario di Accensione e l'orario di Spegnimento su due fasce
                  di orario; le stesse possono essere contigue.<br> Selezionare
                  la velocità dal menù "Opzioni - Calendario" per ogni fascia di
                  orario.<br> <strong>Riavviare Home Assistant per memorizzare i
                  valori inseriti nel calendario</strong>

                  </div>

                  <pre style="font-size: smaller;">

                  <strong>Regole:</strong>

                  - l'opzione Calendario deve essere impostato su "ON"

                  - l'oradio di Accensione  della 1° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere MINORE  
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Accensiore  della 2° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Accensiore  della 2° Fascia deve essere MAGGIORE
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere DIVERSO 
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 2° Fascia

                  <br>

                  - E' consigliato aver attivato l'opzione "VMC ON/OFF, per
                  Superamento Lim. Δ P. di Rugiada", diversamente non verranno
                  presi in considerazione i parametri ambientali [Punto di
                  Rugiada Esterno (Temperatura Esterna, Umidità Esterna) e Punto
                  di Rugiada Interno (Temperatura Interna, Umidità Interna)].

                  </pre>

                  <br>

                  <strong>Es. Programmazione 1° e 2° Fascia contigue, dalle
                  10:00 alle 10:30</strong><br>

                  Dom. 1° Accensione: 10:00<br>

                  Dom. 1° Spegnimento: 10:28<br>

                  Dom. 2° Accensione: 10:29<br>

                  Dom. 2° Spegnimento: 10:30<br>

                  N.b. dalle 10:28 alle 10:29, la VMC si spegnerà per
                  riattivarsi alle 10:29

                  <br>

                  <br>

                  <strong>Es. Programmazione 1° e 2° Fascia non contigue, dalle
                  00:00 alle 06:00 e dalle 20:00 alle 23:59</strong><br>

                  Dom. 1° Accensione: 00:00<br>

                  Dom. 1° Spegnimento: 06:00<br>

                  Dom. 2° Accensione: 20:00<br>

                  Dom. 2° Spegnimento: 23:59<br>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>Free Heating / Free Cooling</strong><br>

                  Permette di settare per la 1° e 2° Fascia (Set Inizio Mese -
                  Set Fine Mese) i mesi soggetti a Riscaldamento (impiegando la
                  velocità Free Heating) o a Raffrescamento (impiegando la
                  velocità Free Cooling) se le condizioni ambientali sono
                  favorevoli.<br> Selezionare i mesi dal menù "Opzioni - Free
                  Heating / Free Cooling" per ogni fascia (Set Inizio Mese - Set
                  Fine Mese).<br> 

                  </div>

                  <pre style="font-size: smaller;">

                  <strong>Regole:</strong>

                  - l'opzione VMC ON/OFF, in Funzione della Vel. Free Heating,
                  deve essere impostato su "ON"

                  - l'opzione VMC ON/OFF, in Funzione della Vel. Free Cooling,
                  deve essere impostato su "ON"

                  - i mesi di ogni fascia (Set Inizio Mese - Set Fine Mese)
                  devono essere contigui

                  - i mesi di ogni fascia (Set Inizio Mese - Set Fine Mese) non
                  devono essere ripetuti

                  </pre>

                  <h4 style="font-size: smaller;">Riscaldamento /
                  Raffrescamento, se:</h4>

                  <pre style="font-size: smaller;">

                  -<strong>Velocità Free Heating</strong>: Temperatura Esterna >
                  Temperatura Interna <font color="rgb(128, 0,
                  128)">Riscaldamento</font>

                  -<strong>Velocità Free Heating</strong>: Temperatura Esterna <
                  Temperatura Interna <font color="rgb(100, 100, 100)">[Allerta]
                  Raffrescamento</font>

                  -<strong>Velocità Free Cooling</strong>: Temperatura Esterna <
                  Temperatura Interna <font color="rgb(128, 0,
                  128)">Raffrescamento</font>

                  -<strong>Velocità Free Cooling</strong>: Temperatura Esterna >
                  Temperatura Interna <font color="rgb(100, 100, 100)">[Allerta]
                  Riscaldamento</font>


                  Se le condizioni ambientali non saranno ideali, mancato
                  Riscaldamento o Raffrescamento, la VMC si arresterà, mostrando
                  un avviso; la ripresa avviene non appena le condizioni
                  risultano idonee per il Riscaldamento o Raffrescamento.

                  E' consigliato aver attivato l'opzione "VMC ON/OFF, per
                  Superamento Lim. Δ P. di Rugiada".

                  </pre>

                  <h4 style="font-size: smaller;">Es. Programmazione 1° e 2°
                  Fascia (Set Inizio Mese - Set Fine Mese) contigue:</h4>

                  <pre style="font-size: smaller;">

                  Set Inizio Mese Free Heating - Set Fine Mese Free Heating:
                  Novembre

                  Set Inizio Mese Free Heating - Set Fine Mese Free Heating:
                  Maggio

                  Set Inizio Mese Free Cooling - Set Fine Mese Free Cooling:
                  Luglio

                  Set Inizio Mese Free Cooling - Set Fine Mese Free Cooling:
                  Ottobre

                  N.b. i Mesi Giugno e Settembre sono mesi non programmati,
                  pertanto in caso di impiego della Velocità Free Heating o Free
                  Cooling nelle condizioni non ideali, la VMC non si arresterà
                  ma mostrerà un avviso di Raffrescamento o di Riscaldamento.

                  </pre>


                  <h4 style="font-size: smaller;">Nota Programmazione
                  Giornaliera / Mensile:</h4>

                  <pre style="font-size: smaller;">

                  Controllare la scheda <strong>Status Programmazione
                  Giornaliera</strong> per verificare se i valori di
                  programmazione sono visibili.

                  Diversamente se viene visualizzato <font color="rgb(100, 100,
                  100)"><strong>Disabiliata</strong></font> è necessario
                  rivedere e correggere i valori di programmazione.

                  </pre>


                  <h4 style="font-size: smaller;">Profili:</h4>

                  <pre style="font-size: smaller;">

                  <strong>1° VMC Master - Profilo Lim. Δ P. di Rugiada</strong>

                  Attiva [VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada] e
                  imposta il [Set Lim. Δ Punto di Rugiada] a 5 °C

                  <br>

                  <strong>2° VMC Master - VMC Master - Profilo
                  Calendario</strong>

                  Attiva [VMC ON/OFF, in Funzione del Calendario], imposta la
                  velocità della VMC su [Velocità 1] per entrambe le Fascie, e
                  Programma la 1° e 2° Fascia dalle 00:00 alle 06:00 e dalle
                  20:00 alle 23:59

                  <br>

                  <strong>3° VMC Master - Profilo Free Heating/Cooling</strong>

                  Attiva [VMC ON/OFF, in Funzione della Vel. Free Heating] e
                  [VMC ON/OFF, in Funzione della Vel. Free Cooling], Programma
                  il Free Heating da Ottobre a Giugno e Programma il Free
                  Cooling da Luglio a Settembre

                  <br>

                  <strong>VMC Master - Panic Botton (Riavvio di H.A.)</strong>

                  Da impiegare se il comportamento della VMC non risponde
                  correttamente alle automazioni e/o comandi.

                  Disattiva i primi 3 Profili sopra Esposti, Attiva lo Status
                  Routine Sensori, lo Status Pannello Led, Disattiva [VMC
                  ON/OFF, in Funzione del Lim. CO₂ e/o VOC], Arresta la VMC,
                  Inizializza tutte le Varibili Booleane su [False] e Riavvia
                  Home Assistant.

                  <br>

                  <strong>VMC Master - Profilo Inizializzazione (Riavvio di
                  H.A.)</strong>

                  Da impiegare solo la prima volta appena installato il Package.

                  Attiva i primi 3 Profili sopra Esposti, Attiva lo Status
                  Routine Sensori, lo Status Pannello Led, Attiva [VMC ON/OFF,
                  in Funzione del Lim. CO₂ e/o VOC], Arresta la VMC, Inizializza
                  tutte le Varibili Booleane su [False] e Riavvia Home
                  Assistant.

                  <br>

                  </pre>


                  &nbsp;&nbsp;&nbsp;&nbsp;<strong>Offrimi un
                  <a>Ginseng</a></strong>&nbsp;&nbsp;&nbsp;&nbsp;[<img
                  src="https://user-images.githubusercontent.com/102819027/253791354-81ba7208-fbad-4fab-8ceb-cdcf901fdb61.png"
                  alt=""
                  width="38%">](https://www.paypal.com/donate/?business=YU9379GL8VDW4&amount=1.2&no_recurring=1&item_name=Se+il+progetto+ti+%C3%A8+piaciuto%2C++offrimi+un+GinSeng%21+%0A%3B%29&currency_code=EUR)
                  <strong>&nbsp;&nbsp;<a>Grazie!</a>&nbsp;</strong>&nbsp;<ha-icon
                  icon="mdi:tag-faces"></ha-icon>
