###########################################################################################################################################################################################################################
#                                                                                                                                                                                                                         #
#                                                          SCHEDA MANUALE INTERFACCIA VMC HELTY FLOW PLUS RELEASE [VER. 7.0.0]                                                                                            #
#                                                                                                                                                                                                                         #
# SVILUPPATO DA ING. DANILO ROBOTTI, ALLE PRIME ARMI CON HOME ASSISTANT :)                                                                                                                                                #
#                                                                                                                                                                                                                         #
# LICENZA D'USO – USO PERSONALE NON COMMERCIALE                                                                                                                                                                           #
#                                                                                                                                                                                                                         #
# COPYRIGHT © ING. DANILO ROBOTTI                                                                                                                                                                                         #
#                                                                                                                                                                                                                         #
# TUTTI I DIRITTI RISERVATI.                                                                                                                                                                                              #
#                                                                                                                                                                                                                         #
# QUESTA LICENZA SI APPLICA A TUTTE LE VERSIONI DEL PRESENTE SOFTWARE CHE INCLUDE I SEGUENTI FILES:                                                                                                                       #
#   - VMC_CLONA.YAML                                                                                                                                                                                                      #
#   - VMC_CLONA_SCHEDA_MANUALE_INTERFACCIA.TXT                                                                                                                                                                            #
#   - VMC_MASTER.YAML                                                                                                                                                                                                     #
#   - VMC_MASTER_AUTOMAZIONE.TXT                                                                                                                                                                                          #
#   - VMC_MASTER_SCHEDA_MANUALE_INTERFACCIA.TXT                                                                                                                                                                           #
#   - VMC_MASTER_SCRIPT_CAMBIO_IP.SH                                                                                                                                                                                      #
#   - VMC_MASTER_SCRIPT_CAMBIO_NOME.SH                                                                                                                                                                                    #
#   - VMC_SCRIPT_CLONA.SH                                                                                                                                                                                                 #
# A PARTIRE DALLA PRIMA VERSIONE PUBBLICATA E SUCCESSIVE                                                                                                                                                                  #
#                                                                                                                                                                                                                         #
# È CONCESSO:                                                                                                                                                                                                             #
#  - L'UTILIZZO DEL SOFTWARE ESCLUSIVAMENTE PER FINI PERSONALI E NON COMMERCIALI                                                                                                                                          #
#  - LA DISTRIBUZIONE LIBERA, PURCHÉ VENGA MANTENUTO IL PRESENTE TESTO DI LICENZA E SIA RISPETTATO IL DIVIETO D'USO COMMERCIALE                                                                                           #
#                                                                                                                                                                                                                         #
# QUALSIASI USO NON AUTORIZZATO AD USO COMMERCIALE COSTITUISCE VIOLAZIONE DEL DIRITTO D'AUTORE E POTRÀ ESSERE PERSEGUITO LEGALMENTE                                                                                       #
#                                                                                                                                                                                                                         #
# PER RICHIESTE DI LICENZA COMMERCIALE O USI PARTICOLARI, CONTATTARE L’AUTORE: danilo.robotti@gmail.com                                                                                                                   #
#                                                                                                                                                                                                                         #
# VERSIONE LICENZA: 1.0                                                                                                                                                                                                   #
# DATA: 30 APRILE 2025                                                                                                                                                                                                    #
#                                                                                                                                                                                                                         #
# Esonero di Responsabilità                                                                                                                                                                                               #
# In nessun caso lo sviluppatore sarà responsabile di danneggiamenti diretti, indiretti o conseguenti, correlati a difetti del presente software                                                                          #
# L’usufruitore ha l’onere e la responsabilità della scelta, dell’installazione, dell’uso e della gestione del software al fine del raggiungimento del risultato prefissatosi                                             #
#                                                                                                                                                                                                                         #
###########################################################################################################################################################################################################################
type: vertical-stack
cards:
  - type: conditional
    conditions:
      - condition: or
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "on"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "on"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "on"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "on"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "on"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "on"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "on"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "on"
          - condition: state
            entity: sensor.vmc_master_status_ip_interfaccia
            state: OFF-Line
    card:
      type: entities
      entities:
        - entity: script.vmc_master_upgrade_sensors
          secondary_info: last-updated
        - entity: sensor.vmc_master_nome_status
          secondary_info: last-changed
        - entity: sensor.vmc_master_status_ip_interfaccia
          secondary_info: last-changed
        - entity: sensor.vmc_master_ip
          secondary_info: last-changed
        - entity: input_boolean.vmc_master_notifica_status_vmc
          secondary_info: last-changed
        - entity: input_text.vmc_master_ip_insert
          secondary_info: last-changed
      state_color: true
      show_header_toggle: false
      title: Ventilazione Meccanica Controllata
      header:
        type: picture
        image: >-
          https://user-images.githubusercontent.com/102819027/253794765-72d95647-d900-4fbc-acfa-6864b7f76321.png
        tap_action:
          action: none
        hold_action:
          action: none
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - entity: sensor.vmc_master_alert_monitoraggio_offset_tutti_min
        state: NOT OK
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% if
        is_state('sensor.vmc_master_alert_monitoraggio_offset_tutti_min','NOT
        OK') and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA OFFSET MINIMI</strong></font>

        Valore Offset Min settato per la Temeratura Esterna: {{
        state_attr('input_number.vmc_master_offset_temp_esterna', 'min') |
        float  }}

        Valore Offset Min settato per la Temperatura Interna: {{
        state_attr('input_number.vmc_master_offset_temp_interna', 'min') |
        float  }}

        Valore Offset Min settato per l'Umidità Esterna: {{
        state_attr('input_number.vmc_master_offset_umidita_esterna', 'min') |
        float  }}

        Valore Offset Min settato per l'Umidità Interna: {{
        state_attr('input_number.vmc_master_offset_umidita_interna', 'min') |
        float  }}

        Valore Offset Min settato per l'Anidride Carbonica, CO₂: {{
        state_attr('input_number.vmc_master_offset_co2', 'min') | float  }}

        Valore Offset Min settato per i Composti Organici Volatici, VOC: {{
        state_attr('input_number.vmc_master_offset_voc', 'min') | float  }}


        {% elif
        is_state('sensor.vmc_master_alert_monitoraggio_offset_tutti_min','OK')
        and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')%}
         <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA OFFSET</strong></font>
                 
        Valore Offset settato per la Temeratura Esterna: {{
        states('input_number.vmc_master_offset_temp_esterna') | float  }}

        Valore Offset settato per la Temperatura Interna: {{
        states('input_number.vmc_master_offset_temp_interna') | float  }}

        Valore Offset settato per l'Umidità Esterna: {{
        states('input_number.vmc_master_offset_umidita_esterna') | float  }}

        Valore Offset settato per l'Umidità Interna: {{
        states('input_number.vmc_master_offset_umidita_interna') | float  }}

        Valore Offset Minimo settato per l'Anidride Carbonica, CO₂: {{
        states('input_number.vmc_master_offset_co2') | float  }}

        Valore Offset Minimo settato per i Composti Organici Volatici, VOC: {{
        states('input_number.vmc_master_offset_voc') | float  }}


        Msg. 1


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: or
        conditions:
          - entity: sensor.vmc_master_congelamento_verifica_soglia
            state: Si
          - condition: state
            entity: sensor.vmc_master_congelamento_verifica_soglia
            state: "[No ma Prossimo]"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% set spia_congelamento_velocita_0  = 
        states('input_boolean.vmc_master_spia_velocita_0_congelamento') %}

        {% set spia_congelamento_velocita_1 = 
        states('input_boolean.vmc_master_spia_velocita_1_congelamento') %}

        {% set spia_congelamento_velocita_2 =
        states('input_boolean.vmc_master_spia_velocita_2_congelamento') %}

        {% set spia_congelamento_velocita_3   =
        states('input_boolean.vmc_master_spia_velocita_3_congelamento') %}

        {% set spia_congelamento_velocita_4 =
        states('input_boolean.vmc_master_spia_velocita_4_congelamento') %}

        {% set spia_congelamento_velocita_iperventilazione =
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')
        %}

        {% set spia_congelamento_velocita_notturna = 
        states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')
        %}

        {% set spia_congelamento_velocita_freecooling =
        states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')
        %}

        {% set freeheating_cooling =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}

        {% set congelamento = states('sensor.vmc_master_temp_esterna_status') |
        float(default=none) %}

        {% set congelamento_vmc =
        states('sensor.vmc_master_temp_esterna_status_senza_offset') |
        float(default=none) %}


        {% if states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' %}
          {% if congelamento_vmc is not none %}
            {# Usa congelamento_vmc per le allerte e per la visualizzazione standard se congelamento è none #}
            {% if congelamento_vmc <= -18 %}
              <font color="rgb(100, 100, 100)">
                <font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA CONGELAMENTO</strong></font>

        <strong>ARRESTO DELLA VMC Temp. Esterna ≤ -18 [°C]</strong>


        TEMPERATURA ESTERNA RILEVATA DALLA VMC {{ congelamento_vmc }} °C


        Msg. 1 bis
              </font>
            {% elif -18 < congelamento_vmc <= -15 %}
              <font color="rgb(100, 100, 100)">
                <font size="+1">
                  <strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong>
                </font>
                <span style="padding-right: 10px;"></span>
                <font size="+1">
                  <strong> ALLERTA CONGELAMENTO PROSSIMO</strong>
                </font>

        <strong>VMC IN PROSSIMITÀ DI ARRESTO PER CONGELAMENTO (-18 °C <
        TEMPERATURA ESTERNA ≤ -15 °C)</strong>


        TEMPERATURA RILEVATA DALLA VMC {{ congelamento_vmc }} °C


        SI CONSIGLIA DI ARRESTARE LA VMC.


        Msg. 2 bis
              </font>
            {% elif congelamento is not none %}
               {% if congelamento <= -18 %}
                  <font color="rgb(100, 100, 100)">
                    <font size="+1">
                      <strong>
                        <ha-icon icon="mdi:alarm-light-outline"></ha-icon>
                      </strong>
                    </font>
                    <span style="padding-right: 10px;"></span>
                    <font size="+1">
                      <strong> ALLERTA CONGELAMENTO</strong>
                    </font>

        <strong>ARRESTO DELLA VMC Temp. Esterna ≤ -18 [°C]</strong>

        TEMPERATURA ESTERNA RILEVATA {{ congelamento }} °C

        {% if (states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') ==
        'off' and states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off'
        and states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') ==
        'off' and states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') ==
        'off' and
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        == 'off') == true and
        (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') ==
        'off' and
        states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') ==
        'off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') ==
        'off' and
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') ==
        'off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') ==
        'off' and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        == 'off') == true and
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'off') == true %}

        {% if spia_congelamento_velocita_0 == "on" %}RIPRESA FUNZIONAMENTO DELLA
        VMC NON APPENA:{% endif %}

        {% if spia_congelamento_velocita_1 == "on" %}RIPRESA AUTOMATICA DELLA
        VMC SULLA <strong>VELOCITA' 1</strong>, NON APPENA:{% endif %}

        {% if spia_congelamento_velocita_2 == "on" %}RIPRESA AUTOMATICA DELLA
        VMC SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% endif %}

        {% if spia_congelamento_velocita_3 == "on" %}RIPRESA AUTOMATICA DELLA
        VMC SULLA <strong>VELOCITA' 3</strong>, NON APPENA:{% endif %} 

        {% if spia_congelamento_velocita_4 == "on" %}RIPRESA AUTOMATICA DELLA
        VMC SULLA <strong>VELOCITA' 4</strong>, NON APPENA:{% endif %}

        {% if spia_congelamento_velocita_notturna == "on" %}RIPRESA AUTOMATICA
        DELLA VMC SULLA
                        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% endif %}
        {% if spia_congelamento_velocita_freecooling == "on" and
        freeheating_cooling == "Free Heating" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA
                        <strong>VELOCITA' FREE HEATING</strong>, NON APPENA:{% endif %}
        {% if spia_congelamento_velocita_freecooling == "on" and
        freeheating_cooling == "Free Cooling" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA
                        <strong>VELOCITA’ FREE COOLING</strong>, NON APPENA:{% endif %}
        {% if spia_congelamento_velocita_freecooling == "on" and
        freeheating_cooling == "Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% endif
        %}

        {% if spia_congelamento_velocita_iperventilazione == "on" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA

        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{% endif %}
                    {% endif %}
                    {% if (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off') and states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'on' or states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'on' %}RIPRESA FUNZIONAMENTO DELLA VMC NON APPENA:{% endif %}
        {% if
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'off') and
        states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'on' or
        states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'on'
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% endif %}

        {% if
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'off') and
        states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'on' or
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'on'
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 2</strong>, NON
        APPENA:{% endif %}

        {% if
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'off') and
        states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'on'
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 3</strong>, NON
        APPENA:{% endif %}

        {% if
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'off') and
        states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'on' or
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'on'
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% endif %}

        {% if
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'off') and
        states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') ==
        'on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        == 'on' %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA'
        NOTTURNA</strong>, NON APPENA:{% endif %}

        {% if
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'off') and
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        == 'on' %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA'
        IPERVENTILAZIONE</strong>, NON APPENA:{% endif %}

        {% if (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') ==
        'off') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'on')) and freeheating_cooling == 'Free Heating' %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON APPENA:{%
        endif %}

        {% if (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') ==
        'off') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'on')) and freeheating_cooling == 'Free Cooling' %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' FREE COOLING</strong>, NON APPENA:{%
        endif %}

        {% if (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') ==
        'off') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'on')) and freeheating_cooling == 'Disabilitata' %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON
        APPENA:{% endif %}

        {% if (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') ==
        'on') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'on')) and freeheating_cooling == 'Free Heating' %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON APPENA:{% endif %}

        {% if (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') ==
        'on') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'on')) and freeheating_cooling == 'Free Cooling' %}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON APPENA:{% endif %}

        {% if (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') ==
        'on') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        == 'on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        == 'on')) and freeheating_cooling=='Disabilitata'%}RIPRESA AUTOMATICA
        DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON APPENA:{% endif %} LA
        TEMPERATURA ESTERNA E' > DI -18 °C


        Msg. 1

        </font>
                {% elif -18 < congelamento <= -15 %}
                  <font color="rgb(100, 100, 100)">
                    <font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font>
                    <span style="padding-right: 10px;"></span>
                    <font size="+1">
                      <strong> ALLERTA CONGELAMENTO PROSSIMO</strong></font>
                    <br><br>
                    <strong>VMC IN PROSSIMITÀ DI ARRESTO PER CONGELAMENTO (-18 °C < TEMPERATURA ESTERNA ≤ -15 °C)</strong>

        TEMPERATURA RILEVATA {{ congelamento }} °C


        SI CONSIGLIA DI ARRESTARE LA VMC.


        Msg. 2
                  </font>
                {% else %}
                  <font color="rgb(128, 0, 128)">
                    <font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA CONGELAMENTO TEMPERATURA ESTERNA ≤ -18 [°C]</strong>
                      </font>

        LA TEMPERATURA ESTERNA RILEVATA È DI {{ congelamento }} °C , NON C'È
        PERICOLO DI CONGELAMENTO DELLA VMC (TEMPERATURA ESTERNA > -15 °C).


        Msg. 3
                  </font>
                {% endif %}
            {% else %}
                  <font color="rgb(128, 0, 128)">
                    <font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA CONGELAMENTO TEMPERATURA ESTERNA ≤ -18 [°C]</strong>
                      </font>

        LA TEMPERATURA ESTERNA RILEVATA È DI {{ congelamento_vmc }} °C , NON C'È
        PERICOLO DI CONGELAMENTO DELLA VMC (TEMPERATURA ESTERNA > -15 °C).


        Msg. 3 bis
                  </font>

            {% endif %}
          {% else %}
            <font color="rgb(100, 100, 100)">
              <font size="+1">
                <strong>
                  <ha-icon icon="mdi:help-circle-outline"></ha-icon>
                </strong>
              </font>
              <span style="padding-right: 10px;"></span>
              <font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default
            </font>
          {% endif %}
        {% else %}
          <font color="rgb(100, 100, 100)">
            <font size="+1">
              <strong>
                <ha-icon icon="mdi:help-circle-outline"></ha-icon>
              </strong>
            </font>
            <span style="padding-right: 10px;"></span>
            <font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default
          </font>
        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: or
        conditions:
          - entity: sensor.vmc_master_alert_monitoraggio_delta
            state: Allerta
          - condition: state
            entity: sensor.vmc_master_delta_temp_verifica_soglia
            state: "[No ma Prossimo]"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_master_delta_temp_verifica_soglia', 'Si') and
        is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA DIFF. TEMP. (INT-EST) > 23 [°C] NEI SENSORI DELLA VMC</strong></font>

        {{states('sensor.vmc_master_delta_temp_verifica_soglia_valore')}}


        Impostazione di Default della VMC - Vedere Libretto di Uso e
        Manutenzione


        Msg. 1


        {% elif is_state('sensor.vmc_master_delta_temp_verifica_soglia', '[No ma
        Prossimo]') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')%}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA 20 °C < DIFF. TEMP. (INT-EST)  ≤  23 °C PROSSIMA NEI SENSORI DELLA VMC</strong></font>

        {{states('sensor.vmc_master_delta_temp_verifica_soglia_valore')}}


        Impostazione di Default della VMC - Vedere Libretto di Uso e
        Manutenzione


        Msg. 2



        {% elif is_state('sensor.vmc_master_delta_temp_verifica_soglia', 'No')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')%}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA DIFF. TEMP. (INT-EST) > 23 [°C] NEI SENSORI DELLA
        VMC</strong></font>


        {{states('sensor.vmc_master_delta_temp_verifica_soglia_valore')}}


        Impostazione di Default della VMC - Vedere Libretto di Uso e
        Manutenzione


        Msg. 3


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_umidita_interna_status
        state: "[Non Calcolabile]"
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_master_umidita_interna_status','[Non
        Calcolabile]') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' NON CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] NON CALCOLABILE
         - Umidità Assoluta [g/m³] NON CALCOLABILE       

        Msg. 1


        {% elif states('sensor.vmc_master_umidita_interna_status')!='[Non
        Calcolabile]' and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' CALCOLABILE</strong></font>
         - Punto di Rugiada [°C] CALCOLABILE
         - Umidità Assoluta [g/m³] CALCOLABILE  

        Msg. 2


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_umidita_esterna_status
        state: "[Non Calcolabile]"
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% if is_state('sensor.vmc_master_umidita_esterna_status','[Non
        Calcolabile]') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' ESTERNA NON CALCOLABILE</strong></font>
         - Punto di Rugiada Esterno [°C] NON CALCOLABILE
         - Umidità Assoluta Esterna [g/m³] NON CALCOLABILE      

        Msg. 1


        {% elif states('sensor.vmc_master_umidita_esterna_status')!='[Non
        Calcolabile]' and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' ESTERNA CALCOLABILE</strong></font>
         - Punto di Rugiada Esterno [°C] CALCOLABILE
         - Umidità Assoluta Esterna [g/m³] CALCOLABILE

        Msg. 2


        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_alert_monitoraggio_umidita
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% if states('input_boolean.vmc_master_spia_calendario_lunedi_1') ==
        'on' or
              states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'on' or
              states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'on' %}
          {% if is_state('sensor.vmc_master_alert_monitoraggio_umidita','Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' %}
            <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

          Msg. 1.1
          {% elif is_state('sensor.vmc_master_alert_monitoraggio_umidita','Nessuna Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line') and states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]'%}
            <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

          Msg. 2.1

          {% elif is_state('sensor.vmc_master_alert_monitoraggio_umidita','Nessuna Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')=='[Non Calcolabile]' %}
            <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' NON CALCOLABILE</strong></font>
           - Punto di Rugiada [°C] NON CALCOLABILE
           - Umidità Assoluta [g/m³] NON CALCOLABILE

          Msg. 3.1

          {% else %}
            <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

          Msg. Default
          {% endif %}
        {% else %}
          {% if states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
                states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off' %}


            {% if states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!= 'Velocità 0' and
                  states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and
                  states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
                  states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                  states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
                  states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') != 'on' and
                  states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and ((
                  states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off') and (

                  states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off') and

                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and (

                  states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off') and (

                  states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
          )) %}
              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}
              
              {% if (states('input_select.vmc_master_speed_umidita') == 'Free Cool./Heat.' and states('input_boolean.vmc_master_spia_umidita_velocita_0')=='on' and
              (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                "Allerta Free Heating Programmato (Raffrescamento in atto)",
                "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                "Allerta Raffrescamento in atto",
                "Allerta Riscaldamento in atto",
                "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
              ]
              ))%}
          PREPARAZIONE AL MANTENIMENTO AUTOMATICO DELLA VMC SU <strong>Velocita 1</strong> IMPOSTATA PER ALLERTA FREE COOLING O FREE HEATING

          ATTENDERE..
              {% else %}
          PREPARAZIONE AL MANTENIMENTO AUTOMATICO DELLA VMC SU <strong>{{ states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') }}</strong>

          ATTENDERE..
              {% endif %}

          Msg. 0


            {% elif states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!= 'Velocità 0' and
                  states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and
                  states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
                  states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                  states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
                  states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
                  states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and ((
                  states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off') and (

                  states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off') and

                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and (

                  states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off') and (

                  states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
          )) %}
              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}
              
              {% if (states('input_select.vmc_master_speed_umidita') == 'Free Cool./Heat.' and states('input_boolean.vmc_master_spia_umidita_velocita_0')=='on' and
              (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                "Allerta Free Heating Programmato (Raffrescamento in atto)",
                "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                "Allerta Raffrescamento in atto",
                "Allerta Riscaldamento in atto",
                "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
              ]
              ))%}
          MANTENIMENTO AUTOMATICO DELLA VMC SU <strong>Velocita 1</strong> IMPOSTATA PER ALLERTA FREE COOLING O FREE HEATING
              {% else %}
          MANTENIMENTO AUTOMATICO DELLA VMC SU <strong>{{ states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') }}</strong>, FINCHE’:
              {% endif %}

          - L'OPZIONE [VMC ON/OFF, in Funzione dell'Umidità Interna] RIMARRÀ IMPOSTATA SU ACCESO, <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
              {% if states('input_boolean.vmc_master_spia_umidita_velocita_0')=='on'%}
          - L'UMIDITA' INTERNA AVRA' UN VALORE ≥ DI {{ states('input_number.vmc_master_umidita_avvio') | float }}%, <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
              {% else %}
          - L'UMIDITA' INTERNA AVRA' UN VALORE ≥ DI {{ states('input_number.vmc_master_umidita_avvio') | float }}%, <strong>DIVERSAMENTE LA VMC MANTERRA' LA VELOCITA' IMPOSTATA: {{ states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') }}</strong>
              {% endif %}
          - NON SONO PRESENTI ALTRE ALLERTE CHE POTREBBERO ARRESTRAE LA VMC

          Msg. 1


            {% elif states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Velocità 0' and
                  states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and
                  states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
                  states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                  states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
                  states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') != 'on' and
                  states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and (( 
                  states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off') and (

                  states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off') and

                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and (

                  states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off') and (

                  states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off' )) %}
              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

              {% if (states('input_select.vmc_master_speed_umidita') == 'Free Cool./Heat.' and
              (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                "Allerta Free Heating Programmato (Raffrescamento in atto)",
                "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                "Allerta Raffrescamento in atto",
                "Allerta Riscaldamento in atto",
                "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
              ]
              ))%}
          AVVIO AUTOMATICO DELLA VMC SU <strong>Velocita 1</strong> IMPOSTATA PER ALLERTA FREE COOLING O FREE HEATING
          
          ATTENDERE..
              {% else %}
          AVVIO AUTOMATICO DELLA VMC SU <strong>{{ states('input_select.vmc_master_speed_umidita') }}</strong> IMPOSTATA
          
          ATTENDERE..
              {% endif %}


          Msg. 2


            {% elif states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Velocità 0' and
                  states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and
                  states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
                  states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                  states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
                  states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
                  states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and (( 
                  states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off') and (

                  states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

                  states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off') and

                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and (

                  states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
                  states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off') and (

                  states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
                  states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off' )) %}
              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

              {% if (states('input_select.vmc_master_speed_umidita') == 'Free Cool./Heat.' and
              (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                "Allerta Free Heating Programmato (Raffrescamento in atto)",
                "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                "Allerta Raffrescamento in atto",
                "Allerta Riscaldamento in atto",
                "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
              ]
              ))%}
          SI CONSIGLIA DI AVVIARE LA VMC SU <strong>Velocita 1</strong> IMPOSTATA PER ALLERTA FREE COOLING O FREE HEATING
              {% else %}
          SI CONSIGLIA DI AVVIARE LA VMC SU <strong>{{ states('input_select.vmc_master_speed_umidita') }}</strong> IMPOSTATA
              {% endif %}

          Msg. 3


            {% elif
                    states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and
                    states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
                    states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                    states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and (
                    states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'on' or
                  
                    states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'on' or
                  
                    states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'on' or
                  
                    states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'on' or
                  
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'on' or
                  
                    states('input_boolean.vmc_master_spia_velocita_0') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_1') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_2') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_3') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_4') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_notturna') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_freecooling') == 'on' or
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'on' or
                  
                    states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'on' or
                    states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'on') %}

              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

          NON E' POSSIBILE DISABILITARE L'OPZIONE [VMC ON/OFF, in Funzione dell'Umidità Interna]
           
          {% if is_state('sensor.vmc_master_alert_monitoraggio_pdr','Allerta') %} PER ALLERTA SUPERAMENTO Lim. Δ PUNTO DI RUGIADA {% endif %}
          {% if is_state('input_boolean.vmc_master_spia_co2_o_voc','on') %} PER ALLERTA LIVELLO DI CONCENTRAZIONE INQUINANTI {% endif %}
          {% if is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling','on') %} PER ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO) {% endif %}
          {% if is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating','on') %} PER ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO) {% endif %}

          Msg. 4


            {% elif is_state('sensor.vmc_master_alert_monitoraggio_umidita','Allerta') and 
                    is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and 
                    states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                    is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita','off') %}
              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

          <strong>SI CONSIGLIA DI ACCENDERE L'OPZIONE [VMC ON/OFF, in Funzione dell'Umidità Interna] IN MODO DA DARE PRIORITA' ALL' ASPIRAZIONE DELL'UMIDITA' INTERNA, COMPATTIBILMENTE CON LE ALTRE ALLERTE</strong>

          Msg. 5


            {% elif is_state('sensor.vmc_master_alert_monitoraggio_umidita','Nessuna Allerta') and 
                    is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line') and 
                    states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                    is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita','on') %}
              <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

          PROGRAMMATA LA PARTENZA E IL RIPRISTINO DELLA VMC SULLA <strong>VELOCITA' 0</strong>, FINCHE’:

          - L'OPZIONE [VMC ON/OFF, in Funzione dell'Umidità Interna], <strong>E' ATTIVATA</strong>
          
          Msg. 6


            {% elif is_state('sensor.vmc_master_alert_monitoraggio_umidita','Nessuna Allerta') and 
                    is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line') and 
                    states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')!='[Non Calcolabile]' and 
                    is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita','off') %}
              <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA UMIDITA'</strong></font>

          {{states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')}}

          L'OPZIONE [VMC ON/OFF, in Funzione dell'Umidità Interna], <strong>E' DISATTIVATA, SI CONSIGLIA DI ATTIVARLA</strong>

          Msg. 7


            {% elif is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and states('sensor.vmc_master_umidita_interna_status_verifica_soglia_valore')=='[Non Calcolabile]' %}
              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> UMIDITA' NON CALCOLABILE</strong></font>

           - Punto di Rugiada [°C] NON CALCOLABILE
           - Umidità Assoluta [g/m³] NON CALCOLABILE

          Msg. 8

            {% else %}
              <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

          Msg. Default
            {% endif %}
          {% endif %}
        {% endif %}
  - type: conditional
    conditions:
      - condition: state
        entity: sensor.vmc_master_alert_monitoraggio_co2
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% set spia_co2_o_voc_partenza_ritorno_velocita_0 =
        states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')
        %}

        {% set spia_co2_o_voc_velocita_0  = 
        states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_1 = 
        states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_2 =
        states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_3   =
        states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_4 =
        states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_notturna =
        states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_freecooling = 
        states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        %}

        {% set spia_co2_o_voc_velocita_iperventilazione =
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')
        %}


        {% set freeheating_cooling =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}



        <!-------1-----[CO2 ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% if is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>ASPIRAZIONE DI INQUINANTI INTERNI</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        Msg. 1


        <!-------2-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
        ne sconsiglia l'impiego"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 2


        <!-------3-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        OFF]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        {% if
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" %}

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>

        {% endif %}


        Msg. 3


        <!-------4-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        {% if
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" %}

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>

        {% endif %}

        Msg. 4


        <!-------5-----[CO2 ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppm


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" or
        spia_co2_o_voc_velocita_0=="on" or spia_co2_o_voc_velocita_1=="on"or
        spia_co2_o_voc_velocita_2=="on" or spia_co2_o_voc_velocita_3=="on" or
        spia_co2_o_voc_velocita_4=="on" or
        spia_co2_o_voc_velocita_notturna=="on"or
        spia_co2_o_voc_velocita_freecooling=="on" or
        spia_co2_o_voc_velocita_iperventilazione=="on"%}


        <strong>PRIORITA' ALL' ASPIRAZIONE DI INQUINANTI</strong>


        {% if spia_co2_o_voc_velocita_0=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 1</strong>, FINCHE’:

        {% elif spia_co2_o_voc_partenza_ritorno_velocita_0=="on" %}MANTENIMENTO
        AUTOMATICO DELLA VMC SULLA <strong>VELOCITA' 1</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_1=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 1</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_2=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 2</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_3=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 3</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_4=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 4</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_notturna=="on" %}MANTENIMENTO AUTOMATICO
        DELLA VMC SULLA <strong>VELOCITA' NOTTURNA</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Heating" %}MANTENIMENTO AUTOMATICO DELLA VMC
        SULLA <strong>VELOCITA' FREE HEATING</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Cooling" %}MANTENIMENTO AUTOMATICO DELLA VMC
        SULLA <strong>VELOCITA’ FREE COOLING</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}MANTENIMENTO AUTOMATICO DELLA VMC
        SULLA <strong>VELOCITA' FREE COOL./HEAT.</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_iperventilazione=="on" %}MANTENIMENTO
        AUTOMATICO DELLA VMC SULLA <strong>VELOCITA' IPERVENTILAZIONE</strong>,
        FINCHE’:{% else %}

        {% endif %}

          - L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO;
        <strong>(DIVERSAMENTE LA VMC VERRA' ARRESTATA)</strong>
           e
         - L'ANIDRIDE CARBONICA, CO₂ ,AVRA' UN VALORE > DI 350 ppm

        {% else %}

        {% endif %}

        Msg. 5, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------6-----[CO2 ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}},
        {{states('sensor.vmc_master_co2_status')}} ppm


        <strong>PRIORITA' ALL' ASPIRAZIONE DI INQUINANTI</strong>


        <strong>AVVIO VMC A VELOCITA' 1 PER DARE PRIORITA' ALL' ASPIRAZIONE DI
        INQUINANTI</strong>


        Msg. 6, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------7.1-----[CO2 OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_co2_status') == '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        Msg. 7.1


        <!-------7.2-----[CO2 OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_co2_status') != '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DI ANIDRIDE CARBONICA, CO₂</strong></font>

        {{states('sensor.vmc_master_co2_status_verifica_soglia')}}


        Msg. 7.2


        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - condition: state
        entity: sensor.vmc_master_alert_monitoraggio_voc
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% set spia_co2_o_voc_partenza_ritorno_velocita_0 =
        states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')
        %}

        {% set spia_co2_o_voc_velocita_0  = 
        states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_1 = 
        states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_2 =
        states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_3   =
        states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_4 =
        states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_notturna =
        states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') %}

        {% set spia_co2_o_voc_velocita_freecooling = 
        states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')
        %}

        {% set spia_co2_o_voc_velocita_iperventilazione =
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')
        %}


        {% set freeheating_cooling =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}



        <!-------1-----[VOC ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% if is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta') and
        is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>ASPIRAZIONE DI INQUINANTI INTERNI</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        Msg. 1


        <!-------2-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
        ne sconsiglia l'impiego"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>


        Msg. 2


        <!-------3-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        OFF]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>


        {% if
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" %}

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>

        {% endif %}


        Msg. 3


        <!-------4-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI OFF],
        [PdR ON] , [INTERRUTTORE PdR
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        and states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
        ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppb


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        {% if
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" %}

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI, COMPATTIBILMENTE CON LE ALTRE
        ALLERTE</strong>

        {% endif %}

        Msg. 4


        <!-------5-----[VOC ON] , [VELOCITA' !=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppm


        {% if spia_co2_o_voc_partenza_ritorno_velocita_0=="on" or
        spia_co2_o_voc_velocita_0=="on" or spia_co2_o_voc_velocita_1=="on"or
        spia_co2_o_voc_velocita_2=="on" or spia_co2_o_voc_velocita_3=="on" or
        spia_co2_o_voc_velocita_4=="on" or
        spia_co2_o_voc_velocita_notturna=="on"or
        spia_co2_o_voc_velocita_freecooling=="on" or
        spia_co2_o_voc_velocita_iperventilazione=="on"%}


        <strong>PRIORITA' ALL' ASPIRAZIONE DI INQUINANTI</strong>


        {% if spia_co2_o_voc_velocita_0=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 1</strong>, FINCHE’:

        {% elif spia_co2_o_voc_partenza_ritorno_velocita_0=="on" %}MANTENIMENTO
        AUTOMATICO DELLA VMC SULLA <strong>VELOCITA' 1</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_1=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 1</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_2=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 2</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_3=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 3</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_4=="on" %}MANTENIMENTO AUTOMATICO DELLA
        VMC SULLA <strong>VELOCITA' 4</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_notturna=="on" %}MANTENIMENTO AUTOMATICO
        DELLA VMC SULLA <strong>VELOCITA' NOTTURNA</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Heating" %}MANTENIMENTO AUTOMATICO DELLA VMC
        SULLA <strong>VELOCITA' FREE HEATING</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Free Cooling" %}MANTENIMENTO AUTOMATICO DELLA VMC
        SULLA <strong>VELOCITA’ FREE COOLING</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}MANTENIMENTO AUTOMATICO DELLA VMC
        SULLA <strong>VELOCITA' FREE COOL./HEAT.</strong>, FINCHE’:

        {% elif spia_co2_o_voc_velocita_iperventilazione=="on" %}MANTENIMENTO
        AUTOMATICO DELLA VMC SULLA <strong>VELOCITA' IPERVENTILAZIONE</strong>,
        FINCHE’:{% else %}

        {% endif %}

          - L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO.
        <strong>(DIVERSAMENTE LA VMC VERRA' ARRESTATA)</strong>
           e
        - I COMPOSTI ORGANICI VOLATICI, VOC, AVRANNO UN VALORE > DI 300 ppb


        {% else %}

        {% endif %}

        Msg. 5, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------6-----[VOC ON] , [VELOCITA'=0], [INTERRUTTORE INQUINANTI
        ON]-------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')
        and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line') and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=="Velocità
        0" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}},
        {{states('sensor.vmc_master_voc_status')}} ppm


        <strong>AVVIO VMC A VELOCITA' 1 PER DARE PRIORITA' ALL' ASPIRAZIONE DI
        INQUINANTI</strong>


        Msg. 6, VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC Allarmato


        <!-------7.1-----[VOC OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_voc_status') == '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        Msg. 7.1


        <!-------7.2-----[VOC OFF]
        -------------------------------------------------------- -->

        {% elif is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta') and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line') and states('sensor.vmc_master_voc_status') != '-' %}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA LIVELLO DI CONCENTRAZIONE DEI COMPOSTI ORGANICI VOLATILI, VOC</strong></font>

        {{states('sensor.vmc_master_voc_status_verifica_soglia')}}


        Msg. 7.2


        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_alert_monitoraggio_pdr
        state: Allerta
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% set spia_velocita_0 =
        states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') %}

        {% set spia_velocita_1 =
        states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') %}

        {% set spia_velocita_2 =
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') %}

        {% set spia_velocita_3 =
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') %}

        {% set spia_velocita_4 =
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') %}

        {% set spia_notturna =
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        %}

        {% set spia_freecooling =
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        %}

        {% set spia_iperventilazione =
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        %}


        {% set spia_velocita_1_co2_o_voc_pdr =
        states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') %}


        {% set freeheating_cooling =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}



        <!-------1-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinanti Off] [Interruttore Inquinanti
        OFF]-------------------------------------------------->

        {% if (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and states('input_boolean.vmc_master_spia_co2_o_voc') ==
        'off') and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off" 
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {%if spia_velocita_1_co2_o_voc_pdr!="on"%}<strong>ARRESTO DELLA
        VMC</strong>{% else %}{% endif %}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]
         
        {% else %}{% endif %}


        Msg. 1, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------2-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinanti Off] [Interruttore Inquinanti
        ON]----------------------------------------------------->

        {% elif (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and states('input_boolean.vmc_master_spia_co2_o_voc') ==
        'off') and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on" 
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {%if spia_velocita_1_co2_o_voc_pdr!="on"%}<strong>ARRESTO DELLA
        VMC</strong>{% else %}{% endif %}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        {% else %}{% endif %}


        Msg. 2, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------3-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinante CO2 ON, VOC OFF]
        --------------------------------------------------------- -->

        {% elif (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')))  %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        {% else %}{% endif %}


        Msg. 3, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------4-----[PdR ON] , [Interruttore PdR ON] , [Velocità  != 0] ,
        [Inquinante CO2 OFF, VOC ON]
        --------------------------------------------------------- -->

        {% elif (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')
        and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0" and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        or is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')))  %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        {% else %}{% endif %}


        Msg. 4, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------5-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr ON], [Inquinante CO2 OFF, VOC
        OFF]--------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0")  and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc', 'Nessuna
        Allerta'))%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {%if spia_velocita_1_co2_o_voc_pdr!="on"%}<strong> VMC
        ARRESTATA</strong>{% else %}{% endif %}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        {% else %}{% endif %}


        Msg. 5, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato


        <!-------6-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr OFF] , [Spia Free Heating o Free Cooling
        ON]--------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
        =='on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
        or
        (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'))%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>NON AVVIARE LA VMC</strong>


        Msg. 6


        <!-------7-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti
        OFF]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>NON AVVIARE LA VMC</strong>


        Msg. 7


        <!-------8-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti
        ON]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>
                  
        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>AVVIO VMC, PRIORITA' ALL' ASPIRAZIONE DI INQUINANTI</strong>


        Msg. 8


        <!-------9-----[PdR ON] , [Interruttore PdR OFF] , [Velocità != 0] ,
        [Spia CO2 o VOC ON], [Interruttore Inquinanti
        OFF]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0") and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 9


        <!-------10-----[PdR ON] , [Interruttore PdR OFF] , [Velocità != 0] ,
        [Spia CO2 o VOC ON], [Interruttore Inquinanti
        ON]-------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0") and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 10


        <!-------11-----[PdR ON] , [Interruttore PdR OFF] , [Velocità != 0] ,
        [Spia CO2 o VOC OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        != "Velocità 0") and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta'))%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA:</strong>
          - DI ARRESTARE LA VMC NEL CASO IN CUI NON SIA GIÀ STATA ARRESTATA A CAUSA DI ALTRE ALLERTE.
        e/o
          - DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada]

        Msg. 11


        <!-------12-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        Msg. 12


        <!-------13-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , 
        [Spia Pdr ON] , [Spia CO2 o VOC ON], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>VMC ARRESTATA</strong>


        {% if spia_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{% else %}{%
        endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        {% else %}{% endif %}


        Msg. 13, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato



        <!-------14-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] , 
        [Spia Pdr ON] , [Spia CO2 o VOC ON], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>VMC ARRESTATA</strong>


        {% if spia_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{% else %}{%
        endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        {% else %}{% endif %}


        Msg. 14, VMC ON/OFF, in Funzione del Lim. ∆ P. di Rugiada Allarmato



        <!-------15 -----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] , 
        [Spia Pdr ON] , [Spia CO2 o VOC ON], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>ARRESTO DELLA VMC</strong>



        {% if spia_velocita_0=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{% else %}{%
        endif %}


        {% if (spia_velocita_0=="on" or spia_velocita_1=="on" or
        spia_velocita_2=="on" or spia_velocita_3=="on" or spia_velocita_4=="on"
        or spia_notturna=="on" or spia_freecooling=="on" or
        spia_iperventilazione=="on")%}
          - LA DIFFERENZA DEL PUNTO DI RUGIADA ESTERNO, {{states('sensor.vmc_master_punto_di_rugiada_esterno') | float(0) }} [°C] - PUNTO DI RUGIADA INTERNO, {{states('sensor.vmc_master_punto_di_rugiada_interno') | float(0) }} [°C] SARÀ MINORE DEL LIM. Δ P. DI RUGIADA {{states('input_number.vmc_master_offset_verifica_impiego_vmc') | float(0) }} [°C] DEL VALORE SETTATO;
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DEL LIM. Δ P. Di RUGIADA] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE LA VMC VERRA' ARRESTATA</strong>
            e 
          - IL PUNTO DI RUGIADA INTERNO SIA DIVERSO DA [NON CALCOLABILE]
            e
          - IL PUNTO DI RUGIADA ESTERNO SIA DIVERSO DA [NON CALCOLABILE]

        {% else %}{% endif %}


        Msg. 15


        <!-------16-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 16


        <!-------17-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 17


        <!-------18-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 18


        <!-------19-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 o VOC ON], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') =='on'
        or states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='on' or
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='on' or 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='on') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Allerta') or
        is_state('sensor.vmc_master_alert_monitoraggio_voc','Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 19


        <!-------20-----[PdR ON] , [Interruttore PdR OFF] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'off' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. Δ P. di Rugiada]</strong>


        Msg. 20


        <!-------21-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti ON]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="on"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>NON AVVIARE LA VMC</strong>


        Msg. 21


        <!-------22-----[PdR ON] , [Interruttore PdR ON] , [Velocità = 0] ,  [
        Spia Pdr OFF] , [Spia CO2 e VOC OFF], [Interruttore Inquinanti OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Se ne sconsiglia l\'impiego" and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
        'on' and is_state('sensor.vmc_master_status_ip_interfaccia','ON-Line')
        and
        (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        == "Velocità 0") and
        (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') =='off'
        and states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') =='off'
        and
        states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
        =='off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
        =='off' and 
        states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
        =='off') and
        (is_state('sensor.vmc_master_alert_monitoraggio_co2','Nessuna Allerta')
        and is_state('sensor.vmc_master_alert_monitoraggio_voc','Nessuna
        Allerta')) and 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=="off"
        %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA </strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        <strong>SI CONSIGLIA DI NON AVVIARE LA VMC</strong>


        Msg. 22


        <!-------23-----[PdR OFF]
        -------------------------------------------------------- -->

        {% elif states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "Si può impiegare" and
        is_state('sensor.vmc_master_status_ip_interfaccia', 'ON-Line')%}
          <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA ALLERTA PER SUPERAMENTO DEL LIM. Δ PUNTO DI RUGIADA</strong></font>

        {{
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto_valore')}}


        {% if spia_velocita_0=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong> , NON APPENA:{% elif spia_velocita_1=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 1</strong>, NON
        APPENA:{% elif spia_velocita_2=="on" %}RIPRESA AUTOMATICA DELLA VMC
        SULLA <strong>VELOCITA' 2</strong>, NON APPENA:{% elif
        spia_velocita_3=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 3</strong>, NON APPENA:{% elif spia_velocita_4=="on"
        %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' 4</strong>, NON
        APPENA:{% elif spia_notturna=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' NOTTURNA</strong>, NON APPENA:{% elif
        spia_freecooling=="on" and freeheating_cooling=="Free Heating" %}RIPRESA
        AUTOMATICA DELLA VMC SULLA <strong>VELOCITA' FREE HEATING</strong>, NON
        APPENA:{% elif spia_freecooling=="on" and freeheating_cooling=="Free
        Cooling" %}RIPRESA AUTOMATICA DELLA VMC SULLA <strong>VELOCITA’ FREE
        COOLING</strong>, NON APPENA:{% elif spia_freecooling=="on" and
        freeheating_cooling=="Disabilitata" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' FREE COOL./HEAT.</strong>, NON APPENA:{% elif
        spia_iperventilazione=="on" %}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' IPERVENTILAZIONE</strong>, NON APPENA:{%elif
        spia_velocita_1_co2_o_voc_pdr=="on"%}RIPRESA AUTOMATICA DELLA VMC SULLA
        <strong>VELOCITA' 0</strong>{% else %}{% endif %}


        Msg. 23


        <!-------24-----[PdR NON CALCOLABILE]
        -------------------------------------------------------- -->

        {% elif (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
        == "[Non Calcolabile]" or
        states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') == "[Non
        Disponibile]" ) and is_state('sensor.vmc_master_status_ip_interfaccia',
        'ON-Line')%}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> LIM. Δ PUNTO DI RUGIADA NON CALCOLABILE</strong></font>

        Msg. 24


        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}
          <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default

        {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        state: "on"
      - condition: state
        entity: >-
          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_disabilitato
        state: OK
      - condition: state
        entity: input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia
        state: "off"
      - condition: state
        entity: >-
          sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
        state_not: Non disponibile
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: markdown
      content: >-
        {% set spia_free_cooling =
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
        %}

        {% set spia_free_heating =
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
        %}


        {% set co2 = states('sensor.vmc_master_alert_monitoraggio_co2') %}

        {% set voc = states('sensor.vmc_master_alert_monitoraggio_voc') %}  


        {% set automazione_free_cooling =
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling')
        %}

        {% set automazione_free_heating =
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating')
        %} 


        {% set tipologia =
        states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')
        %}


        {% set velocita =
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
        %}


        {% set temp_interna = states('sensor.vmc_master_temp_interna_status') |
        float(0) %}

        {% set temp_esterna = states('sensor.vmc_master_temp_esterna_status') |
        float(0) %} 


        {% set avviso_da_mostrare =
        states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_disabilitato')
        %}


        {% set interruttore_inquinanti =
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')
        %}



        {% if states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' %}

        <!--------------------------------- INIZIO FREE HEATING
        ----------------------------------- -->
         <!--------------------------------------1 ------------------------------- -->
        {% if ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>VMC ARRESTATA</strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong>DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 1, Free Heating Allarmato


        <!--------------------------------------2-------------------------------
        -->

        <!------------------2.1 Interruttore Inquinanti ON ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>IN ALTERNATIVA, LA VMC SI RIAVVIERÀ AUTOMATICAMENTE ALLA
        VELOCITÀ FREE HEATING (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> ALTRIMENTI, LA RIPRESA AUTOMATICA VERRÀ ANNULLATA IMPOSTANDO LA
        VELOCITÀ DELLA VMC A 1.</strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 2.1, Free Heating Allarmato


        <!------------------2.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 2.2, Free Heating Allarmato


        <!--------------------------------------3-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %} 
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>VMC ARRESTATA </strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 3, Free Heating Allarmato


        <!--------------------------------------4-------------------------------
        -->
         {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and automazione_free_heating == "on" and temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>VMC IN ARRESTO</strong>


        Msg. 4, Free Heating Allarmato


        <!--------------------------------------5-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 5 Free Heating


        <!--------------------------------------6-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE HEATING PROGRAMMATO (RAFFRESCAMENTO IN ATTO)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]
          
        <strong>VMC IN ARRESTO</strong>


        Msg. 6 Free Heating


        <!--------------------------------------7-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and
        ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK")
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 7, Free Heating Allarmato


        <!--------------------------------------8-------------------------------
        -->

        <!------------------8.1 Interruttore Inquinanti ON ---------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 8.1, Free Heating Allarmato


        <!------------------8.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE HEATING PROGRAMMATO (RAFFRESCAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE HEATING
        (RISCALDAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MAGGIORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE HEATING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRA IMPOSTATO SU FREE HEATING

        Msg. 8.2, Free Heating Allarmato

        ------------------

        <!-------------------------------------13-------------------------------
        -->

        <!------------------13.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA
        RAFFRESCAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 13.1 Free Heating


        <!------------------13.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA
        RAFFRESCAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 13.2 Free Heating


        <!-------------------------------------14 [CRITERIO MODIFICATO RISPETTO
        LA CONFIGURAZIONE PER AGGIUNTA VELOCITA' DIVERSA DA
        0]------------------------------- -->

        <!------------------14.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        velocita != "Velocità 0" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 14.1 Free Heating


        <!------------------14.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        velocita != "Velocità 0" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 14.2 Free Heating


        <!-------------------------------------14.1 [CRITERIO AGGIUNTO RISPETTO
        LA CONFIGURAZIONE]------------------------------- -->

        <!------------------14.1.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna > temp_esterna |
        float(0) and spia_free_heating=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 14.1.1 Free Heating


        <!------------------14.1.2 Interruttore Inquinanti OFF
        ------------------ -->

        {% elif ( tipologia == "Free Heating" and velocita != "Free Cooling" and
        velocita == "Velocità 0" and automazione_free_heating == "on" and
        temp_interna > temp_esterna | float(0) and spia_free_heating=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE HEATING PROGRAMMATO (ALLERTA RAFFRESCAMENTO, PRESENZA
        DI INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        Msg. 14.1.2 Free Heating




        <!--------------------------------- INIZIO INIZIO FREE COOLING
        ----------------------------------- -->
         <!--------------------------------------1 ------------------------------- -->
        {% elif (  tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>VMC ARRESTATA</strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 1, Free Cooling Allarmato


        <!--------------------------------------2-------------------------------
        -->

        <!------------------2.1 Interruttore Inquinanti ON ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>IN ALTERNATIVA, LA VMC SI RIAVVIERÀ AUTOMATICAMENTE ALLA
        VELOCITÀ FREE COOLING (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> ALTRIMENTI LA RIPRESA AUTOMATICA VERRÀ ANNULLATA IMPOSTANDO LA
        VELOCITÀ DELLA VMC A 1.</strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 2.1, Free Cooling Allarmato


        <!------------------2.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 2.2, Free Cooling Allarmato


        <!--------------------------------------3-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="on" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %} 
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>VMC ARRESTATA </strong>


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 3, Free Cooling Allarmato


        <!--------------------------------------4-------------------------------
        -->
         {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling" and automazione_free_cooling == "on" and temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>VMC IN ARRESTO</strong>


        Msg. 4, Free Cooling Allarmato


        <!--------------------------------------5-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA'</strong>
            
        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 5 Free Cooling


        <!--------------------------------------6-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        FREE COOLING PROGRAMMATO (RISCALDAMENTO IN ATTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]
          
        <strong>VMC IN ARRESTO</strong>


        Msg. 6 Free Cooling


        <!--------------------------------------7-------------------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and
        ((co2 !="Allerta") and (voc !="Allerta")) and avviso_da_mostrare=="OK")
        %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 7, Free Cooling Allarmato


        <!--------------------------------------8-------------------------------
        -->

        <!------------------8.1 Interruttore Inquinanti ON ---------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 8.1, Free Cooling Allarmato


        <!------------------8.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="on" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}
         <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon icon="mdi:alarm-light-outline"></ha-icon></strong></font><span style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA FREE COOLING PROGRAMMATO (RISCALDAMENTO ARRESTATO, PRESENZA DI INQUINANTI)</strong></font></br>
        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>RIPRESA AUTOMATICA DELLA VMC SULLA VELOCITÀ FREE COOLING
        (RAFFRESCAMENTO), NON APPENA:</strong>

          - LA TEMPERATURA ESTERNA SARÀ MINORE DELLA TEMPERATURA INTERNA
            e
          - L'OPZIONE [VMC ON/OFF, IN FUNZIONE DELLA VEL. FREE COOLING] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>
            e 
          - IL MESE CORRENTE PROGRAMMATO RIMARRÀ IMPOSTATO SU FREE COOLING

        Msg. 8.2, Free Cooling Allarmato


        <!-------------------------------------13-------------------------------
        -->

        <!------------------13.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA
        RISCALDAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 13.1 Free Cooling


        <!------------------13.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA
        RISCALDAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 13.2 Free Cooling


        <!-------------------------------------14 [CRITERIO MODIFICATO RISPETTO
        LA CONFIGURAZIONE PER AGGIUNTA VELOCITA' DIVERSA DA
        0]------------------------------- -->

        <!------------------14.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and velocita != "Velocità 0" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 14.1 Free Cooling


        <!------------------14.2 Interruttore Inquinanti OFF ------------------
        -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and velocita != "Velocità 0" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 14.2 Free Cooling


        <!-------------------------------------14.1 [CRITERIO AGGIUNTO RISPETTO
        LA CONFIGURAZIONE]------------------------------- -->

        <!------------------14.1.1 Interruttore Inquinanti ON
        --------------------- -->

        {% elif (  tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna > temp_interna |
        float(0) and spia_free_cooling=="off" and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK" and
        interruttore_inquinanti=="on") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>AVVIO VMC A VELOCITA' 1 </strong>


        <strong>DIVERSAMENTE SI CONFERMA L'ARRESTO DELLA VMC:</strong>

          - NON APPENA L'ANIDRIDE CARBONICA, CO₂ ≤ DI 350 ppm e/o I COMPOSTI ORGANICI VOLATICI, VOC ≤ DI 300 ppb
            o
          - FINCHE' L'OPZIONE [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC] RIMARRÀ IMPOSTATA SU ACCESO
        <strong> DIVERSAMENTE VERRÀ ANNULLATA LA RIPRESA AUTOMATICA, CONFERMANDO
        L'ARRESTO DELLA VMC. </strong>


        Msg. 14.1.1 Free Cooling


        <!------------------14.1.2 Interruttore Inquinanti OFF
        ------------------ -->

        {% elif (  tipologia == "Free Cooling" and velocita != "Free Cooling"
        and velocita == "Velocità 0" and automazione_free_cooling == "on" and
        temp_esterna > temp_interna | float(0) and spia_free_cooling=="off" and
        ((co2 =="Allerta") or (voc =="Allerta")) and avviso_da_mostrare=="OK"
        and interruttore_inquinanti=="off") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NON AVVIARE
        IN VELOCITÀ FREE COOLING PROGRAMMATO (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        <strong>SI CONSIGLIA DI IMPOSTARE SU ACCESO L'OPZIONE [VMC ON/OFF, in
        Funzione del Lim. CO₂ e/o VOC]</strong>

        o

        <strong>SI CONSIGLIA DI CAMBIARE VELOCITA' IN MODO DA DARE PRIORITA'
        ALL' ASPIRAZIONE DI INQUINANTI </strong>


        Msg. 14.1.2 Free Cooling




        <!--------------------------------- INIZIO INIZIO FREE HEATING/FREE
        COOLING  DISABILITATO ----------------------------------- -->

        <!-------------------------------------33
        ------------------------------- -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RAFFRESCAMENTO IN ATTO</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 33


        <!-------------------------------------34-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RAFFRESCAMENTO IN ATTO, PRESENZA DI INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 34


        <!-------------------------------------35-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_esterna > temp_interna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RISCALDAMENTO IN ATTO</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 35


        <!-------------------------------------36-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_esterna > temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> ALLERTA
        RISCALDAMENTO IN ATTO, PRESENZA DI INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 36


        <!-------------------------------------39-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita != "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA
        RAFFRESCAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 39
           
        <!-------------------------------------40-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita != "Free Cooling" and
        temp_interna > temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA RAFFRESCAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MINORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]     


        Msg. 40


        <!-------------------------------------41-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and  velocita != "Free Cooling"
        and temp_esterna > temp_interna | float(0) and ((co2 !="Allerta") and
        (voc !="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA
        RISCALDAMENTO)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]


        Msg. 41


        <!-------------------------------------42-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita != "Free Cooling" and
        temp_esterna > temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) and avviso_da_mostrare=="OK") %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> SE AVVIATA
        IN VELOCITÀ FREE COOL./HEAT. (ALLERTA RISCALDAMENTO, PRESENZA DI
        INQUINANTI)</strong></font></br>

        LA TEMPERATURA ESTERNA, {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] ATTUALMENTE È
        MAGGIORE DELLA TEMPERATURA INTERNA, {{
        states('sensor.vmc_master_temp_interna_status')}} [°C]     


        Msg. 42




        <!--------------------------------- NESSUNA_ALLERTA_INIZIO_FREE_HEATING
        ----------------------------------- -->

        <!-------------------------------------9-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9 Free Heating


        <!-------------------------------------9.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9.1 Free Heating


        <!-------------------------------------10-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10 Free Heating


        <!-------------------------------------10.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Free Cooling" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10.1 Free Heating


        <!-------------------------------------11-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11 Free Heating


        <!-------------------------------------11.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11.1 Free Heating


        <!-------------------------------------12-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna < temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12 Free Heating


        <!-------------------------------------12.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita == "Velocità 0" and
        automazione_free_heating == "on" and temp_interna == temp_esterna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12.1 Free Heating


        <!-------------------------------------15-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna < temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 15 Free Heating


        <!-------------------------------------15.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna == temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 15.1 Free Heating


        <!-------------------------------------16-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna < temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MAGGIORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16 Free Heating


        <!-------------------------------------16.1-------------------------------
        -->

        {% elif ( tipologia == "Free Heating" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_heating == "on" and
        temp_interna == temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16.1 Free Heating




        <!--------------------------------- NESSUNA ALLERTA INIZIO FREE COOLING
        ----------------------------------- -->

        <!-------------------------------------9-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9 Free Cooling"


        <!-------------------------------------9.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 9.1 Free Cooling


        <!-------------------------------------10-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10 Free Cooling


        <!-------------------------------------10.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Free Cooling" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong>NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 10.1 Free Cooling


        <!-------------------------------------11-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11 Free Cooling


        <!-------------------------------------11.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 !="Allerta") and (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 11.1 Free Cooling


        <!-------------------------------------12-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna < temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12 Free Cooling


        <!-------------------------------------12.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita == "Velocità 0" and
        automazione_free_cooling == "on" and temp_esterna == temp_interna |
        float(0) and ((co2 =="Allerta") or (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 12.1 Free Cooling


        <!-------------------------------------15-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna < temp_interna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 15 Free Cooling


        <!-------------------------------------15.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna == temp_interna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 15.1 Free Cooling


        <!-------------------------------------16-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna < temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È MINORE DELLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16 Free Cooling


        <!-------------------------------------16.1-------------------------------
        -->

        {% elif ( tipologia == "Free Cooling" and velocita != "Velocità 0" and 
        velocita != "Free Cooling" and automazione_free_cooling == "on" and
        temp_esterna == temp_interna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE COOLING PROGRAMMATO, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 16.1 Free Cooling







        <!--------------------------------- NESSUNA ALLERTA INIZIO FREE HEATING,
        FREE COOLING DISABILITATO ----------------------------------- -->

        <!-------------------------------------37-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna == temp_esterna | float(0) and ((co2 !="Allerta") and (voc
        !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING/FREE COOLING</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 37


        <!-------------------------------------38-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and velocita == "Free Cooling" and
        temp_interna ==temp_esterna | float(0) and ((co2 =="Allerta") or (voc
        =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING/FREE COOLING, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 38


        <!-------------------------------------43-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and  velocita != "Free Cooling"
        and temp_esterna == temp_interna | float(0) and ((co2 !="Allerta") and
        (voc !="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING/FREE COOLING </strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 43


        <!-------------------------------------44-------------------------------
        -->

        {% elif ( tipologia == "Disabilitata" and  velocita != "Free Cooling"
        and temp_esterna == temp_interna | float(0) and ((co2 =="Allerta") or
        (voc =="Allerta")) ) %}

        <font color="rgb(128, 0, 128)"><font size="+1"><strong><ha-icon
        icon="mdi:alarm-light-off-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+1"><strong> NESSUNA
        ALLERTA FREE HEATING/FREE COOLING, PRESENZA DI
        INQUINANTI</strong></font></br>

        LA TEMPERATURA ESTERNA {{
        states('sensor.vmc_master_temp_esterna_status')}} [°C] È UGUALE ALLA
        TEMPERATURA INTERNA {{ states('sensor.vmc_master_temp_interna_status')}}
        [°C]


        Msg. 44




        <!-- OFF LINE / ALTRI CASI NON ANALIZZATI -->

        {% else %}

        <font color="rgb(100, 100, 100)"><font size="+1"><strong><ha-icon
        icon="mdi:help-circle-outline"></ha-icon></strong></font><span
        style="padding-right: 10px;"></span><font size="+0"> STATO NON
        DISPONIBILE</font>


        Msg. Default

        {% endif %}
          {% else %}
            <font color="rgb(100, 100, 100)">
              <font size="+1"><strong><ha-icon icon="mdi:help-circle-outline"></ha-icon></strong></font>
              <span style="padding-right: 10px;"></span>
              <font size="+0"> STATO NON DISPONIBILE</font>

        Msg. Default      
            </font>
          {% endif %}
  - type: conditional
    conditions:
      - entity: sensor.vmc_master_status_ip_interfaccia
        state: ON-Line
      - condition: and
        conditions:
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_0
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_1
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_2
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_3
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_4
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_notturna
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_freecooling
            state: "off"
          - condition: state
            entity: input_boolean.vmc_master_spia_velocita_iperventilazione
            state: "off"
    card:
      type: vertical-stack
      cards:
        - type: entities
          entities:
            - entity: sensor.vmc_master_nome_status
              secondary_info: last-updated
            - entity: >-
                sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
              secondary_info: last-updated
            - entity: sensor.vmc_master_spia_pannello_alert_monitoraggio_totale
              secondary_info: last-updated
          state_color: true
          show_header_toggle: true
          title: Ventilazione Meccanica Controllata
          footer:
            type: buttons
            entities:
              - entity: input_boolean.vmc_master_opzioni_vmc
              - entity: input_boolean.vmc_master_opzioni_monitoraggio_sensori
              - entity: input_boolean.vmc_master_opzioni_interruttore_calendario
              - entity: input_boolean.vmc_master_opzioni_offset_sensori
              - entity: input_boolean.vmc_master_opzioni_avvisi
              - entity: input_boolean.vmc_master_opzioni_lettura_sensori
          header:
            type: picture
            image: >-
              https://user-images.githubusercontent.com/102819027/253794765-72d95647-d900-4fbc-acfa-6864b7f76321.png
            tap_action:
              action: call-service
              service: input_boolean.toggle
              service_data:
                entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
            hold_action:
              action: call-service
              service: input_boolean.toggle
              service_data:
                entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
        - type: conditional
          conditions:
            - condition: and
              conditions:
                - condition: state
                  entity: input_boolean.vmc_master_opzioni_vmc
                  state: "on"
                - condition: state
                  entity: >-
                    sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
                  state_not: Non disponibile
          card:
            square: false
            type: grid
            cards:
              - square: false
                type: grid
                cards:
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_sensori_off
                      target: {}
                    name: Sensori Off
                    show_state: true
                    icon: mdi:chip
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_sensori_on
                      target: {}
                    name: Sensori On
                    show_state: true
                    icon: mdi:chip
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_pannello_led_off
                      target: {}
                    name: Led Pannello Off
                    show_state: true
                    icon: mdi:led-off
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_pannello_led_on
                      target: {}
                    name: Led Pannello On
                    show_state: true
                    icon: mdi:led-on
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_0
                      target: {}
                    show_state: true
                    name: Velocità 0
                    icon: mdi:numeric-0-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_1
                      target: {}
                    name: Velocità 1
                    show_state: true
                    icon: mdi:numeric-1-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_2
                      target: {}
                    name: Velocità 2
                    show_state: true
                    icon: mdi:numeric-2-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_3
                      target: {}
                    name: Velocità 3
                    show_state: true
                    icon: mdi:numeric-3-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_velocita_4
                      target: {}
                    name: Velocità 4
                    show_state: true
                    icon: mdi:numeric-4-box
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_notturna
                      target: {}
                    name: Notturna
                    show_state: true
                    icon: mdi:weather-night
                    hold_action:
                      action: none
                  - show_name: true
                    show_icon: true
                    type: button
                    tap_action:
                      action: call-service
                      service: shell_command.vmc_master_iperventilazione
                      target: {}
                    name: Iperventilazione
                    show_state: true
                    icon: mdi:wind-power
                    hold_action:
                      action: none
                  - type: vertical-stack
                    cards:
                      - type: conditional
                        conditions:
                          - condition: and
                            conditions:
                              - condition: state
                                entity: >-
                                  sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                                state: Free Heating
                              - condition: or
                                conditions:
                                  - condition: state
                                    entity: >-
                                      sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                    state: Nessuna Allerta Free Heating Programmato
                                  - condition: state
                                    entity: >-
                                      sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                    state: >-
                                      Nessuna Allerta Free Heating Programmato,
                                      Presenza di Inquinanti
                        card:
                          show_name: true
                          show_icon: true
                          type: button
                          tap_action:
                            action: call-service
                            service: shell_command.vmc_master_freecooling
                          icon: mdi:weather-sunny
                          name: Free Heating
                          show_state: true
                          hold_action:
                            action: none
                      - type: conditional
                        conditions:
                          - condition: and
                            conditions:
                              - entity: >-
                                  sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                                state: Free Heating
                              - condition: and
                                conditions:
                                  - condition: or
                                    conditions:
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Heating Programmato
                                          (Raffrescamento in atto)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Heating Programmato
                                          (Raffrescamento in atto, Presenza di
                                          Inquinanti)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Heating Programmato
                                          (Raffrescamento Arrestato)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Heating Programmato
                                          (Raffrescamento Arrestato, Presenza di
                                          Inquinanti)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Non Avviare in Velocità Free Heating
                                          Programmato (Allerta Raffrescamento)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Non Avviare in Velocità Free Heating
                                          Programmato (Allerta Raffrescamento,
                                          Presenza di Inquinanti)
                        card:
                          show_name: true
                          show_icon: true
                          type: button
                          tap_action:
                            action: call-service
                            service: shell_command.vmc_master_freecooling
                          icon: mdi:weather-sunny-alert
                          name: Free Heating Alert
                          show_state: true
                          hold_action:
                            action: none
                      - type: conditional
                        conditions:
                          - condition: and
                            conditions:
                              - condition: state
                                entity: >-
                                  sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                                state: Free Cooling
                              - condition: or
                                conditions:
                                  - condition: state
                                    entity: >-
                                      sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                    state: Nessuna Allerta Free Cooling Programmato
                                  - condition: state
                                    entity: >-
                                      sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                    state: >-
                                      Nessuna Allerta Free Cooling Programmato,
                                      Presenza di Inquinanti
                        card:
                          type: button
                          tap_action:
                            action: call-service
                            service: shell_command.vmc_master_freecooling
                          icon: mdi:snowflake
                          name: Free Cooling
                          show_name: true
                          show_icon: true
                          show_state: true
                          hold_action:
                            action: none
                      - type: conditional
                        conditions:
                          - condition: and
                            conditions:
                              - condition: state
                                entity: >-
                                  sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                                state: Free Cooling
                              - condition: and
                                conditions:
                                  - condition: or
                                    conditions:
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Cooling Programmato
                                          (Riscaldamento in atto)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Cooling Programmato
                                          (Riscaldamento in atto, Presenza di
                                          Inquinanti)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Cooling Programmato
                                          (Riscaldamento Arrestato)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Allerta Free Cooling Programmato
                                          (Riscaldamento Arrestato, Presenza di
                                          Inquinanti)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Non Avviare in Velocità Free Cooling
                                          Programmato (Allerta Riscaldamento)
                                      - condition: state
                                        entity: >-
                                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                                        state: >-
                                          Non Avviare in Velocità Free Cooling
                                          Programmato (Allerta Riscaldamento,
                                          Presenza di Inquinanti)
                        card:
                          show_name: true
                          show_icon: true
                          type: button
                          tap_action:
                            action: call-service
                            service: shell_command.vmc_master_freecooling
                          icon: mdi:snowflake-alert
                          name: Free Cooling Alert
                          show_state: true
                          hold_action:
                            action: none
                      - type: conditional
                        conditions:
                          - condition: or
                            conditions:
                              - condition: state
                                entity: >-
                                  sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                                state: Disabilitata
                              - condition: state
                                entity: >-
                                  sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                                state: Non disponibile
                              - condition: state
                                entity: sensor.vmc_master_temp_esterna_status
                                state: unavailable
                              - condition: state
                                entity: sensor.vmc_master_temp_interna_status
                                state: unavailable
                              - condition: state
                                entity: sensor.vmc_master_temp_interna_status
                                state: Non disponibile
                              - condition: state
                                entity: sensor.vmc_master_temp_esterna_status
                                state: Non disponibile
                        card:
                          type: button
                          tap_action:
                            action: call-service
                            service: shell_command.vmc_master_freecooling
                          icon: mdi:sun-snowflake-variant
                          name: Free Cool./Heat.
                          show_name: true
                          show_icon: true
                          show_state: true
                          hold_action:
                            action: none
                columns: 4
              - type: horizontal-stack
                cards:
                  - type: entities
                    entities:
                      - entity: >-
                          sensor.vmc_master_status_sensori_lettura_codice_interpretato
                        secondary_info: last-updated
                      - entity: >-
                          sensor.vmc_master_status_led_pannello_lettura_codice_interpretato
                        secondary_info: last-updated
                      - entity: sensor.vmc_master_status_calcolo_portata_ventola
                        secondary_info: last-updated
                      - entity: >-
                          sensor.vmc_master_status_portata_ventola_lettura_codice_interpretato
                        secondary_info: last-updated
                      - entity: sensor.vmc_master_tempo_mancante_ricambio
                        secondary_info: last-updated
                      - entity: sensor.vmc_master_cicli_ricambio_aria
                        secondary_info: last-updated
                      - entity: sensor.vmc_master_status_calcolo_aria_scambiata_totale
                        secondary_info: last-updated
                      - entity: script.vmc_master_azzera_aria_scambiata
                        secondary_info: last-triggered
            columns: 1
        - type: conditional
          conditions:
            - condition: and
              conditions:
                - condition: state
                  entity: input_boolean.vmc_master_opzioni_monitoraggio_sensori
                  state: "on"
                - condition: state
                  entity: >-
                    sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
                  state_not: Non disponibile
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: sensor.vmc_master_temp_esterna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_temp_interna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_umidita_esterna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_umidita_interna_status
                    secondary_info: last-updated
                  - entity: sensor.vmc_master_co2_status
                    secondary_info: last-changed
                  - entity: sensor.vmc_master_voc_status
                    secondary_info: last-changed
                  - entity: script.vmc_master_upgrade_sensors
                    secondary_info: last-triggered
                title: Sensori - Selezionati
                footer:
                  type: buttons
                  entities:
                    - entity: >-
                        input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                    - entity: >-
                        input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: sensor.vmc_master_punto_di_rugiada_esterno
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_punto_di_rugiada_interno
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_punto_di_rugiada_valore
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_umidita_assoluta_esterna
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_umidita_assoluta_interna
                          secondary_info: last-updated
                        - entity: sensor.vmc_master_calcolo_confort_interno
                          secondary_info: last-changed
                      title: Sensori - Extra
                      state_color: true
                    - type: vertical-stack
                      cards:
                        - type: entities
                          entities:
                            - entity: >-
                                sensor.vmc_master_temp_esterna_status_senza_offset
                              secondary_info: last-changed
                            - entity: >-
                                sensor.vmc_master_temp_interna_status_senza_offset
                              secondary_info: last-updated
                            - entity: >-
                                sensor.vmc_master_umidita_interna_status_senza_offset
                              secondary_info: last-updated
                            - entity: sensor.vmc_master_co2_status_senza_offset
                              secondary_info: last-updated
                            - entity: sensor.vmc_master_voc_status_senza_offset
                              secondary_info: last-updated
                          title: Sensori VMC Interni
                          state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_number.vmc_master_offset_temp_esterna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_temp_interna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_umidita_esterna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_umidita_interna
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_co2
                          secondary_info: last-updated
                        - entity: input_number.vmc_master_offset_voc
                          secondary_info: last-updated
                        - entity: script.vmc_master_azzera_offset_sensors
                          secondary_info: last-triggered
                      title: Sensori - Offset
                      state_color: true
        - type: conditional
          conditions:
            - condition: and
              conditions:
                - condition: state
                  entity: input_boolean.vmc_master_opzioni_interruttore_calendario
                  state: "on"
                - condition: state
                  entity: >-
                    sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
                  state_not: Non disponibile
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: >-
                      sensor.vmc_master_status_accensione_vmc_tramite_calendario_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_master_status_accensione_vmc_tramite_calendario_2_interfaccia
                    secondary_info: last-updated
                  - entity: >-
                      sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2_interfaccia
                    secondary_info: last-updated
                title: Programmazione Giornaliera
                state_color: true
              - type: entities
                entities:
                  - entity: >-
                      sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling
                    secondary_info: last-updated
                state_color: true
                title: Programmazione Mensile
        - type: conditional
          conditions:
            - condition: and
              conditions:
                - condition: state
                  entity: input_boolean.vmc_master_opzioni_offset_sensori
                  state: "on"
                - condition: state
                  entity: >-
                    sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
                  state_not: Non disponibile
          card:
            type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: sensor.vmc_master_ip
                  - entity: input_text.vmc_master_ip_insert
                    secondary_info: last-changed
                  - entity: input_text.vmc_master_nome_da_inserire
                    secondary_info: last-updated
                  - entity: input_number.vmc_master_volume_da_inserire
                    secondary_info: last-updated
                  - entity: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi
                    secondary_info: last-updated
                  - entity: input_boolean.vmc_master_notifica_status_vmc
                    secondary_info: last-changed
                  - entity: script.vmc_master_bottone_panico
                    secondary_info: last-updated
                  - entity: script.vmc_master_profilo_inizializzazione
                    secondary_info: last-updated
                  - entity: script.vmc_master_pulisci_cronologia_entita
                    secondary_info: last-updated
                state_color: false
                title: Opzioni
                footer:
                  type: buttons
                  entities:
                    - entity: input_boolean.vmc_master_opzioni_scelta_sensori
                    - entity: input_boolean.vmc_master_opzioni_elementi_chimici
                    - entity: input_boolean.vmc_master_opzioni_punto_di_rugiada
                    - entity: input_boolean.vmc_master_opzioni_calendario_main
                    - entity: >-
                        input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                show_header_toggle: false
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.vmc_master_opzioni_scelta_sensori
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: >-
                            input_select.vmc_master_selected_temp_external_entity
                          secondary_info: last-changed
                        - entity: >-
                            input_select.vmc_master_selected_temp_internal_entity
                          secondary_info: last-changed
                        - entity: >-
                            input_select.vmc_master_selected_humidity_external_entity
                          secondary_info: last-changed
                        - entity: >-
                            input_select.vmc_master_selected_humidity_internal_entity
                          secondary_info: last-changed
                        - entity: input_select.vmc_master_selected_co2_internal_entity
                          secondary_info: last-changed
                        - entity: input_select.vmc_master_selected_notification_device
                          secondary_info: last-changed
                      state_color: false
                      title: Opzioni - Sensori da Selezionare
                      show_header_toggle: false
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.vmc_master_opzioni_elementi_chimici
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc
                          secondary_info: last-changed
                      state_color: false
                      title: Opzioni - Elementi Chimici
                      show_header_toggle: false
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_master_opzioni_punto_di_rugiada
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_number.vmc_master_umidita_avvio
                          secondary_info: last-updated
                        - entity: input_select.vmc_master_speed_umidita
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita
                          secondary_info: last-updated
                        - entity: script.vmc_master_profilo_umidita
                          secondary_info: last-updated
                      state_color: false
                      title: Opzioni - Umidità Interna
                      show_header_toggle: false
                    - type: entities
                      entities:
                        - entity: input_number.vmc_master_offset_verifica_impiego_vmc
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr
                          secondary_info: last-updated
                        - entity: script.vmc_master_profilo_pdr
                          secondary_info: last-updated
                      state_color: false
                      title: Opzioni - Punto di Rugiada
                      show_header_toggle: false
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_master_opzioni_calendario_main
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_select.vmc_master_speed_1_fascia_calendario
                        - entity: input_select.vmc_master_speed_2_fascia_calendario
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
                          secondary_info: last-updated
                        - entity: script.vmc_master_profilo_calendario
                          secondary_info: last-updated
                      footer:
                        type: buttons
                        entities:
                          - entity: input_boolean.vmc_master_opzioni_calendario
                      title: Opzioni - Calendario
                      state_color: false
                      show_header_toggle: false
              - type: conditional
                conditions:
                  - entity: input_boolean.vmc_master_opzioni_calendario
                    state: "on"
                card:
                  square: true
                  columns: 2
                  type: grid
                  cards:
                    - type: entities
                      entities:
                        - entity: input_datetime.vmc_master_accensione_lunedi
                        - entity: input_datetime.vmc_master_accensione_lunedi_2
                        - entity: input_datetime.vmc_master_accensione_martedi
                        - entity: input_datetime.vmc_master_accensione_martedi_2
                        - entity: input_datetime.vmc_master_accensione_mercoledi
                        - entity: input_datetime.vmc_master_accensione_mercoledi_2
                        - entity: input_datetime.vmc_master_accensione_giovedi
                        - entity: input_datetime.vmc_master_accensione_giovedi_2
                        - entity: input_datetime.vmc_master_accensione_venerdi
                        - entity: input_datetime.vmc_master_accensione_venerdi_2
                        - entity: input_datetime.vmc_master_accensione_sabato
                        - entity: input_datetime.vmc_master_accensione_sabato_2
                        - entity: input_datetime.vmc_master_accensione_domenica
                        - entity: input_datetime.vmc_master_accensione_domenica_2
                      title: Accensione
                      state_color: true
                    - type: entities
                      entities:
                        - entity: input_datetime.vmc_master_spegnimento_lunedi
                        - entity: input_datetime.vmc_master_spegnimento_lunedi_2
                        - entity: input_datetime.vmc_master_spegnimento_martedi
                        - entity: input_datetime.vmc_master_spegnimento_martedi_2
                        - entity: input_datetime.vmc_master_spegnimento_mercoledi
                        - entity: input_datetime.vmc_master_spegnimento_mercoledi_2
                        - entity: input_datetime.vmc_master_spegnimento_giovedi
                        - entity: input_datetime.vmc_master_spegnimento_giovedi_2
                        - entity: input_datetime.vmc_master_spegnimento_venerdi
                        - entity: input_datetime.vmc_master_spegnimento_venerdi_2
                        - entity: input_datetime.vmc_master_spegnimento_sabato
                        - entity: input_datetime.vmc_master_spegnimento_sabato_2
                        - entity: input_datetime.vmc_master_spegnimento_domenica
                        - entity: input_datetime.vmc_master_spegnimento_domenica_2
                      title: Spegnimento
                      state_color: true
              - type: conditional
                conditions:
                  - entity: >-
                      input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                    state: "on"
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      entities:
                        - entity: input_select.vmc_master_mese_1_fascia_freeheating
                          secondary_info: last-updated
                        - entity: input_select.vmc_master_mese_2_fascia_freeheating
                          secondary_info: last-updated
                        - entity: input_select.vmc_master_mese_1_fascia_freecooling
                          secondary_info: last-changed
                        - entity: input_select.vmc_master_mese_2_fascia_freecooling
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating
                          secondary_info: last-updated
                        - entity: >-
                            input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling
                          secondary_info: last-updated
                        - entity: script.vmc_master_profilo_free_heating_cooling
                          secondary_info: last-updated
                      title: Opzioni - Free Heating / Free Cooling
                      state_color: true
                      show_header_toggle: false
        - type: conditional
          conditions:
            - condition: and
              conditions:
                - condition: state
                  entity: input_boolean.vmc_master_opzioni_avvisi
                  state: "on"
                - condition: state
                  entity: >-
                    sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
                  state_not: Non disponibile
          card:
            type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: entities
                    entities:
                      - entity: sensor.vmc_master_co2_status_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_voc_status_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_alert_monitoraggio_pdr
                        secondary_info: last-changed
                      - entity: >-
                          sensor.vmc_master_umidita_interna_status_verifica_soglia
                        secondary_info: last-changed
                      - entity: >-
                          sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_delta_temp_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_congelamento_verifica_soglia
                        secondary_info: last-changed
                      - entity: sensor.vmc_master_alert_monitoraggio_black_out
                        secondary_info: last-changed
                    title: Avvisi
                    state_color: true
                    footer:
                      type: buttons
                      entities:
                        - entity: input_boolean.vmc_master_opzioni_avvisi_grafici
              - type: conditional
                conditions:
                  - condition: state
                    entity: input_boolean.vmc_master_opzioni_avvisi_grafici
                    state: "on"
                card:
                  square: false
                  type: grid
                  cards:
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_temp_interna_status
                      name: Temperatura Interna
                      unit: "[°C]"
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_temp_esterna_status
                      name: Temperatura Esterna
                      unit: "[°C]"
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_umidita_interna_status
                      name: Umidità Interna
                      unit: "[%]"
                    - graph: line
                      type: sensor
                      detail: 2
                      name: Umidità Esterna
                      entity: sensor.vmc_master_umidita_esterna_status
                      unit: "[%]"
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_co2_status
                      name: Anidride Carbonica
                      unit: "[ppm]"
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_voc_status
                      name: VOC
                      unit: "[ppm]"
                    - graph: line
                      type: sensor
                      detail: 2
                      name: Punto di Rugiada Interno
                      entity: sensor.vmc_master_punto_di_rugiada_interno
                      unit: "[°C]"
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_punto_di_rugiada_esterno
                      name: Punto di Rugiada Esterno
                      unit: "[°C]"
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_umidita_assoluta_interna
                      name: Umidità Assoluta Interna
                      unit: " [g/m³]"
                    - graph: line
                      type: sensor
                      detail: 2
                      entity: sensor.vmc_master_umidita_assoluta_esterna
                      name: Umidità Assoluta Esterna
                      unit: " [g/m³]"
                  columns: 2
        - type: conditional
          conditions:
            - condition: and
              conditions:
                - condition: state
                  entity: input_boolean.vmc_master_opzioni_lettura_sensori
                  state: "on"
                - condition: state
                  entity: >-
                    sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia
                  state_not: Non disponibile
          card:
            type: vertical-stack
            cards:
              - type: markdown
                content: >-
                  <pre style="font-size:6px; background-color:
                  #d9ffcc;"><ha-icon icon="mdi:hvac"></ha-icon><strong> VMC
                  HELTY FLOW Plus/Elite</strong>    
                      - Release Installata: {{ states('sensor.vmc_master_versione_corrente')}}{% if states('sensor.vmc_master_versione_repository') != states('sensor.vmc_master_versione_corrente') and states('sensor.vmc_master_versione_repository') != "Errore Connessione" %}
                      -</ha-icon><strong> Aggiornamento Repository: {{ states('sensor.vmc_master_versione_repository') }}</strong>
                  {% else %}
                      -</ha-icon><strong> Nessun Aggiornamento</strong>
                  {% endif %}

                  <ha-icon icon="mdi:email-fast"></ha-icon> <a

                  href="mailto:danilo.robotti@gmail.com">Mail</a> <ha-icon

                  icon="mdi:human-handsup"></ha-icon><a
                  href="https://github.com/DanRobo76/VMC-HELTY-FLOW">Link</a>


                  LICENZA D'USO – USO PERSONALE NON COMMERCIALE

                  COPYRIGHT © ING. DANILO ROBOTTI

                  TUTTI I DIRITTI RISERVATI.

                  <br><ha-icon icon="mdi:file-sign"></ha-icon><strong> Esonero
                  di Responsabilità:</strong> 

                  In nessun caso lo sviluppatore sarà responsabile 

                  di danneggiamenti diretti, indiretti o conseguenti

                  , correlati a difetti del presente SoftWare. 

                  Il Cliente ha l’onere e la responsabilità della 

                  scelta, dell’installazione,  dell’uso e della 

                  gestione del SoftWare al fine del raggiungimento 

                  del risultato prefissatosi.

                  </pre>

                  <strong>Indice:</strong>


                  <details> <summary><b>1 Info Lettura Dati nella
                  VMC</b></summary> <br> <strong>- Sensori Ventilazione</strong>
                  <pre style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{
                  states('sensor.vmc_master_status_ventola') }} {% endif
                  %}</pre> <strong>- Sensori Ambientali</strong> <pre
                  style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_master_sensori') }}
                  {% endif %}</pre> <strong>- Lan</strong> <pre
                  style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_master_lan') }} {%
                  endif %}</pre> <strong>- Nome</strong> <pre
                  style="font-size:6px; background-color: #d9ffcc;">{% if
                  states('sensor.vmc_master_status_ip_interfaccia')=='OFF-Line'%}Non
                  disponibile{% else %}{{ states('sensor.vmc_master_nome') }} {%
                  endif %}</pre>

                  </details>


                  <details>

                  <summary><b>2 Status Routine Sensori</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  Se la funzione è disabilitata i valori rilevati dai sensori
                  nella schermata INFO dell'App Mobile non saranno più

                  disponibili e le relative funzioni e allarmi settati nel
                  Firmware della VMC saranno disattivati.

                  </div>

                  <br>

                  </details>


                  <details>

                  <summary><b>3 Status Pannello Led</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  Per attivare o disattivare i LED

                  del pannello comandi della VMC. 

                  </div>

                  <br>

                  </details>


                  <details>

                  <summary><b>4 Congelamento [°C]</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  Blocco automatico dell’unità.

                  <br>

                  L'unità si blocca automaticamente se la temperatura esterna
                  scende sotto -18 °C. Un pre-avviso viene emesso quando la
                  temperatura raggiunge -15 °C.

                  <br>

                  <b>Priorità sulle impostazioni:</b>

                  <br>

                  Questa configurazione è integrata nel firmware della VMC e si
                  basa sui suoi sensori interni.

                  <br>

                  <b>N.b.</b>

                  i valori Offset configurati dall'utente non influenzano in
                  alcun modo i sensori interni della VMC.

                  </div>

                  <br>

                  </details>


                  <details>

                  <summary><b>5 Differenziale tra temperature [°C]</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  Riduzione automatica della velocità.

                  <br>

                  Se la differenza tra la temperatura interna ed esterna letta
                  dai sensori interni della VMC supera 23°C, l'unità viene
                  automaticamente impostata su Velocità 1.

                  <br>

                  <b>Priorità sulle impostazioni:</b>

                  <br>

                  Questa configurazione è integrata nel firmware della VMC e si
                  basa sui suoi sensori interni.

                  <br>

                  <b>N.b.</b>

                  Questa azione avviene indipendentemente dalle Entità e/o dagli
                  Offset configurati dall'utente.

                  </div>

                  <br>

                  </details>


                  <details>

                  <summary><b>6 Punto di Rugiada [°C]</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  È la temperatura alla quale l'aria diventa satura di vapore
                  acqueo e inizia a formare goccioline d'acqua.

                  Se un oggetto ha una temperatura inferiore al punto di rugiada
                  dell'aria circostante, l'umidità in eccesso si depositerà su
                  di esso.

                  <br>

                  Formazione di Condensato: Il vapore acqueo si trasforma in
                  acqua liquida, creando rugiada o goccioline sulla superficie
                  dell'oggetto.

                  </div>

                  <br>

                  </details>


                  <details>

                  <summary><b>7.1 Verifica Superamento dell'Umidità
                  Interna</b></summary>


                  <pre style="font-size:6px; background-color: #d9ffcc;">

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  <strong>AVVIO VMC PER RILEVAMENTO UMIDITA' INTERNA:</strong>
                   - L'UMIDITA' E' MAGGIORE O UGUALE DEL VALORE LIMITE IMPOSTATO 
                   - [VMC ON/OFF, in Funzione dell'Umidità Interna] RIMANE SU ON
                   - NON SONO PRESENTI ALLERTE

                  <strong>ARRESTO DELLA VMC PER ASSENZA DI UMIDITA' INTERNA
                  :</strong>
                   - L'UMIDITA' E' MINORE DEL VALORE LIMITE IMPOSTATO
                   - [VMC ON/OFF, in Funzione dell'Umidità Interna] RIMANE SU ON
                   - NON SONO PRESENTI ALLERTE

                  <strong>NOTE:</strong>

                  - L'AVVIO E L'ARRESTO NON HA EFFETTO NELLA PROGRAMMAZIONE DEL
                  CALENDARIO

                  - SE NON SONO PRESENTI ALLERTE:
                       - LA VMC SI AVVIA ALLA VELOCITÀ PROGRAMMATA SOLO SE PARTE DA VELOCITÀ 0 
                         OPPURE SE LA VELOCITÀ PROGRAMMATA COINCIDE CON QUELLA ATTUALE DELLA VMC. 
                         IN TUTTI GLI ALTRI CASI, MANTIENE LA NUOVA VELOCITÀ IMPOSTATA, 
                         INDIPENDENTEMENTE DALLA PRESENZA O MENO DI UMIDITÀ
                       - SE VIENE PROGRAMMATA CON VELOCITA'  Free Cool./Heat. MANTIENE LA STESSA
                         SE NON SONO PRESENTI DELLE ALLERTE, DIVERSAMENTE VIENE IMPOSTATA LA 
                         VELOCITA' 1
                       - SE [VMC ON/OFF, in Funzione dell'Umidità Interna] VIENE IMPOSTATO 
                         SU OFF MENTRE LA VMC E' IN FUNZIONE, LA VMC SI ARRESTA
                         N.B. NEL CASO DI ALLERTE DIVERSE DALL'ALLERTA UMIDITA' OPPURE A VMC 
                         AVVIATA ALL'INTERNO DEL PERIODO PROGRAMMATO DEL CALENDARIO, L'INTERRUTTORE
                         POTRA' ESSERE DISABILITATO SOLO AL TERMINE DELLE ALLERTE O ALL'USCITA DEL
                         PERIODO PROGRAMMATO DEL CALENDARIO
                  </pre>

                  </details>


                  <details>

                  <summary><b>7.2 Verifica Superamento del [Lim. Δ P. di
                  Rugiada]</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  Assicurarsi che il punto di rugiada dell'aria esterna meno il
                  punto di rugiada dell'aria interna, sia minore di qualche
                  grado  °C (impostare il [Set Lim. Δ P. di Rugiada]) prima di
                  iniziare la ventilazione.

                  <br>

                  <br>

                  In questo modo si ha la garanzia di trasportare l'umidità
                  dall'interno verso l'esterno.

                  <br>

                  <br>

                  <b>Tabella di Attivazione della VMC in Base al Punto di
                  Rugiada:</b><br>

                  <br>


                  | Δ P. di Rugiada (°C)             | Condizione
                  Climatica             |
                  Effetto                                                                
                  |
                  Raccomandazione                                                                         
                  |

                  |:---------------------------------|:---------------------------------|:------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------|

                  | -10                              | Estremamente freddo e
                  secco      | Massimo abbassamento dell'umidità
                  interna                               | Altamente raccomandato
                  attivare la VMC per ridurre significativamente l'umidità
                  interna. |

                  | -9 a -8                          | Molto freddo e
                  secco             | Abbassamento significativo dell'umidità
                  interna                         | Attiva la VMC per ridurre
                  l'umidità interna.                                            
                  |

                  | -7 a -6                          | Freddo e
                  secco                   | Miglioramento moderato della qualità
                  dell'aria                          | Consigliato attivare la
                  VMC per gestire
                  l'umidità.                                       |

                  | -5 a -4                          | Freddo e leggermente
                  secco       | Miglioramento moderato dell'umidità interna,
                  monitora per condensazione | Attiva la VMC con cautela,
                  monitora per condensazione.                                  
                  |

                  | -3 a -1                          | Temperato e leggermente
                  secco    | Lieve abbassamento dell'umidità
                  interna                                 | Uso limitato della
                  VMC; monitora le condizioni per evitare
                  problemi.                     |

                  | 0                                | Temperato, equilibrio di
                  umidità | Bilanciamento
                  dell'umidità                                              |
                  Attiva la VMC solo se necessario per la qualità
                  dell'aria.                               |

                  | 1 a 3                            | Temperato e leggermente
                  umido    | Possibile aumento di umidità
                  interna                                    | Limita l'uso
                  della VMC per evitare aumento di umidità
                  interna.                           |

                  | 4 a 5                            | Caldo e
                  umido                    | Aumento significativo dell'umidità
                  interna                              | Non attivare la VMC;
                  l'aria esterna aumenterà l'umidità
                  interna.                         |

                  | 6 a 7                            | Molto caldo e
                  umido              | Condizioni interne potenzialmente
                  sgradevoli                            | Fortemente
                  sconsigliato attivare la VMC; condizioni
                  avverse.                             |

                  | > 7                              | Estremamente caldo e
                  umido       | Clima interno eccessivamente
                  umido                                      | Non attivare la
                  VMC; condizioni troppo avverse per un miglioramento
                  significativo dell'umidità interna. |


                  ### Spiegazione

                  - **Estremamente freddo e secco**: Ideale per ridurre
                  l'umidità interna senza rischi di condensazione.

                  - **Molto freddo e secco**: Ottimo per gestire l'umidità
                  interna, attiva la VMC.

                  - **Freddo e secco**: Buone condizioni per la gestione
                  dell'umidità interna.

                  - **Freddo e leggermente secco**: Monitora per evitare rischi
                  di condensazione, ma può essere utile per ridurre l'umidità.

                  - **Temperato e leggermente secco**: L'uso della VMC deve
                  essere limitato e ben monitorato.

                  - **Temperato, equilibrio di umidità**: Mantenere
                  l'equilibrio, attiva la VMC solo per migliorare la qualità
                  dell'aria.

                  - **Temperato e leggermente umido**: Aumentare l'umidità
                  interna può essere rischioso, limita l'uso della VMC.

                  - **Caldo e umido**: Evita l'uso della VMC; aumenterebbe
                  l'umidità interna.

                  - **Molto caldo e umido**: In queste condizioni estreme, la
                  VMC non aiuterebbe a migliorare il comfort interno e potrebbe
                  aggravare i problemi di umidità e calore.

                  - **Estremamente caldo e umido**: Condizioni troppo avverse
                  per un miglioramento significativo dell'umidità interna, non
                  attivare la VMC.


                  <pre style="font-size: smaller;">

                  P.di Rugiada Esterna - P. di Rugiada Interno < Set Lim. Δ P.
                  di Rugiada -> <font color="rgb(128, 0, 128)">Si può impiegare
                  [Nessuna Allerta]</font>

                  P.di Rugiada Esterna - P. di Rugiada Interno ≥ Set Lim. Δ P.
                  di Rugiada ->  <font color="rgb(100, 100, 100)">Se ne
                  sconsiglia l'impiego [Allerta]</font>

                  <font color='green'><br>Se l'Impostazione [VMC ON/OFF, per
                  Superamento Lim. Δ P. di Rugiada] è Attiva ed è stato superato
                  il valore 

                  del [Set Lim. Δ P. di Rugiada], allora la VMC si Arresterà,
                  per poi riattivarsi successivamente non appena le condizioni
                  lo permetterano.</font>

                  </pre>


                  Suggerimenti di impostazione del [Set Lim. Δ P. di Rugiada]:
                    - Locale Bagno : -7°C
                    - Locale Camera: -5°C
                  <br>

                  </details>


                  <details>

                  <summary><b>8 Range Sensore Umidità U [%]</b></summary>

                  <b><h4 style="font-size: smaller;"></h4></b>

                  <pre style="font-size: smaller;">
                           U ≤ 0     <font color="rgb(128, 0, 128)">Non Calcolabile [Nessuna Allerta]</font>
                       0 < U ≤ 35    <font color="rgb(100, 100, 100)">Possibile Secchezza, Disidratazione [Allerta Pop-Up]</font>
                      35 < U < {{states('input_number.vmc_master_umidita_avvio') | float}}  <font color="rgb(128, 0, 128)">Normale [Nessuna Allerta]</font>
                    {{states('input_number.vmc_master_umidita_avvio') | float}} ≤ U ≤ 100   <font color="rgb(100, 100, 100)">Possibile Muffe, Batteri [Allerta Pop-Up]</font>
                  </pre>

                  <br>

                  </details>


                  <details>

                  <summary><b>9 Umidità Assoluta U [g/m³]</b></summary>

                  <br>

                  <h4 style="font-size: smaller;"></h4>

                  <pre style="font-size: smaller;">
                              U ≤ 0  Non Calcolabile
                  Temp. Interna ≤ 0  Non Calcolabile

                  </pre>

                  <br>

                  </details>


                  <details>

                  <summary><b>10 Range Sensore CO₂ [ppm]</b></summary>

                  <br>

                  <h4 style="font-size: smaller;"></h4>

                  <pre style="font-size: smaller;">
                         CO₂ ≤ 0     <font color="rgb(128, 0, 128)">Assente [Nessuna Allerta]</font>
                     0 < CO₂ ≤ 350   <font color="rgb(128, 0, 128)">Bassa Contentrazione [Nessuna Allerta]</font>
                   350 < CO₂ ≤ 600   <font color="rgb(100, 100, 100)">Moderata Concentrazione [Allerta Pop-Up]</font>
                   600 < CO₂ < 1200  <font color="rgb(100, 100, 100)">Alta Concentrazione [Allerta Pop-Up]</font>
                         CO₂ ≥ 1200  <font color="rgb(100, 100, 100)">Pessima Concentrazione [Allerta Pop-Up]</font>
                  </pre>

                  <br>

                  </details>


                  <details>

                  <summary><b>11 Range Sensore VOC [ppb]</b></summary>

                  <br>

                  <h4 style="font-size: smaller;"></h4>

                  <pre style="font-size: smaller;">
                        VOC ≤ 0     <font color="rgb(128, 0, 128)">Assente [Nessuna Allerta]</font>
                    0 < VOC ≤ 300   <font color="rgb(128, 0, 128)">Bassa Contentrazione [Nessuna Allerta]</font>
                  300 < VOC ≤ 600   <font color="rgb(100, 100, 100)">Moderata
                  Concentrazione [Allerta Pop-Up]</font>
                        VOC > 600   <font color="rgb(100, 100, 100)">Pessima Concentrazione [Allerta Pop-Up]</font>
                  </pre>

                  <br>

                  </details>


                  <details>

                  <summary><b>12 Calendario</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  Permette di organizzare per ogni giorno della settimana
                  l'orario di Accensione e l'orario di Spegnimento su due fasce
                  di orario; le stesse possono essere contigue.<br> Selezionare
                  la velocità dal menù "Opzioni -> Opzioni - Calendario" per
                  ogni fascia di orario.<br> <strong>Riavviare Home Assistant
                  per memorizzare i valori inseriti nel calendario</strong>

                  </div>

                  <pre style="font-size: smaller;">

                  <strong>Regole:</strong>

                  - l'Impostazione [VMC ON/OFF, in Funzione del Calendario] deve
                  essere impostato su "ON"

                  - l'oradio di Accensione  della 1° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere MINORE  
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Accensiore  della 2° Fascia deve essere MINORE  
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Accensiore  della 2° Fascia deve essere MAGGIORE
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 1° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 2° Fascia

                  - l'oradio di Spegnimento della 1° Fascia deve essere DIVERSO 
                  dell'orario di Accensione  della 2° Fascia

                  - l'oradio di Accensione  della 1° Fascia deve essere DIVERSO 
                  dell'orario di Spegnimento della 2° Fascia

                  <br>

                  - E' consigliato avere attive tutte le seguenti Impostazioni
                  su ON:
                   - [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC]
                   - [VMC ON/OFF, in Funzione della Vel. Free Heating]
                   - [VMC ON/OFF, in Funzione della Vel. Free Cooling]
                   - [VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada]
                  </pre>

                  <br>

                  <strong>Es. Programmazione 1° e 2° Fascia contigue, dalle
                  10:00 alle 10:30</strong><br>

                  1° Fascia<br>
                        Dom. 1° Accensione: 10:00<br>
                        Dom. 1° Spegnimento: 10:28<br>
                  2° Fascia<br>
                        Dom. 2° Accensione: 10:29<br>
                        Dom. 2° Spegnimento: 10:30<br>
                  <br>

                  N.b. dalle 10:28 alle 10:29, la VMC si spegnerà per
                  riattivarsi alle 10:29

                  <br>

                  <br>

                  <strong>Es. Programmazione 1° e 2° Fascia non contigue, dalle
                  00:00 alle 06:00 e dalle 20:00 alle 23:59</strong><br>

                  1° Fascia<br>
                        Dom. 1° Accensione: 00:00<br>
                        Dom. 1° Spegnimento: 06:00<br>
                  2° Fascia<br>
                        Dom. 2° Accensione: 20:00<br>
                        Dom. 2° Spegnimento: 23:59<br>
                  <br>

                  </details>


                  <details>

                  <summary><b>13 Free Heating / Free Cooling</b></summary>

                  <br>

                  <div style="background-color: #f0f0f0; padding: 10px;">

                  Permette di settare per la 1° e 2° Fascia (Set Inizio Mese -
                  Set Fine Mese), i mesi soggetti a Riscaldamento (impiegando la
                  velocità Free Heating) o a Raffrescamento (impiegando la
                  velocità Free Cooling) se le condizioni ambientali sono
                  favorevoli.<br> Selezionare i mesi dal menù "Opzion -> Opzioni
                  - Free Heating / Free Cooling" per ogni fascia (Set Inizio
                  Mese - Set Fine Mese).<br> 

                  </div>

                  <pre style="font-size: smaller;">

                  <strong>Regole:</strong>

                  - l'Impostazione VMC ON/OFF, in Funzione della Vel. Free
                  Heating, deve essere impostato su "ON"

                  - l'Impostazione VMC ON/OFF, in Funzione della Vel. Free
                  Cooling, deve essere impostato su "ON"

                  - i mesi di ogni fascia (Set Inizio Mese - Set Fine Mese)
                  devono essere contigui

                  - i mesi di ogni fascia (Set Inizio Mese - Set Fine Mese) non
                  devono essere ripetuti

                  </pre>

                  <br>

                  </details>


                  <details>

                  <summary><b>14 Riscaldamento / Raffrescamento</b></summary>

                  <br>

                  <pre style="font-size: smaller;">

                  -<strong>Velocità Free Heating</strong>: Temperatura Esterna >
                  Temperatura Interna <font color="rgb(128, 0,
                  128)">Riscaldamento</font>

                  -<strong>Velocità Free Heating</strong>: Temperatura Esterna <
                  Temperatura Interna <font color="rgb(100, 100, 100)">[Allerta]
                  Raffrescamento</font>

                  -<strong>Velocità Free Cooling</strong>: Temperatura Esterna <
                  Temperatura Interna <font color="rgb(128, 0,
                  128)">Raffrescamento</font>

                  -<strong>Velocità Free Cooling</strong>: Temperatura Esterna >
                  Temperatura Interna <font color="rgb(100, 100, 100)">[Allerta]
                  Riscaldamento</font>

                  <br>

                  Se le condizioni ambientali non saranno ideali, mancato
                  Riscaldamento o Raffrescamento, la VMC si arresterà, mostrando
                  un avviso; la ripresa avviene non appena le condizioni
                  risultano idonee per il Riscaldamento o Raffrescamento.

                  In caso di presenza di Inquinanti e di allerte Raffrescamento
                  / Riscaldamento, la velocità verrà impostata su 1, purchè la
                  programmazione mensile sia diversa da <font color="rgb(100,
                  100, 100)"><strong>Disabiliata</strong></font>  

                  </pre>

                  E' consigliato avere attive tutte le seguenti Impostazioni su
                  ON:<br>

                  [VMC ON/OFF, in Funzione del Lim. CO₂ e/o VOC]<br>

                  [VMC ON/OFF, in Funzione della Vel. Free Heating]<br>

                  [VMC ON/OFF, in Funzione della Vel. Free Cooling]<br>

                  [VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada]<br>


                  <h4 style="font-size: smaller;">Es. Programmazione 1° e 2°
                  Fascia (Set Inizio Mese - Set Fine Mese) contigue:</h4>

                  <pre style="font-size: smaller;">

                  Set Inizio Mese Free Heating - Set Fine Mese Free Heating:
                  Novembre

                  Set Inizio Mese Free Heating - Set Fine Mese Free Heating:
                  Maggio

                  Set Inizio Mese Free Cooling - Set Fine Mese Free Cooling:
                  Luglio

                  Set Inizio Mese Free Cooling - Set Fine Mese Free Cooling:
                  Ottobre

                  N.b. i Mesi Giugno e Settembre sono mesi non programmati,
                  pertanto in caso di impiego della Velocità Free Heating o Free
                  Cooling nelle condizioni non ideali, la VMC non si arresterà
                  ma mostrerà un avviso di Raffrescamento o di Riscaldamento.

                  </pre>


                  <h4 style="font-size: smaller;">Nota Programmazione
                  Giornaliera / Mensile:</h4>

                  <pre style="font-size: smaller;">

                  Controllare la scheda <strong>Status Programmazione
                  Giornaliera</strong> per verificare se i valori di
                  programmazione sono visibili.

                  Diversamente se viene visualizzato <font color="rgb(100, 100,
                  100)"><strong>Disabiliata</strong></font> è necessario
                  rivedere e correggere i valori di programmazione.

                  </pre>

                  <br>

                  </details>


                  <details>

                  <summary><b>15 Profili</b></summary>

                  <br>

                  <h4 style="font-size: smaller;"></h4>

                  <pre style="font-size: smaller;">

                  <strong>1° VMC Master - Profilo Umidità Interna</strong>

                  Attiva [VMC ON/OFF, in Funzione dell'Umidità Interna], imposta
                  il Valore a 65 % con Velocità Iperventilazione

                  <br>

                  <strong>2° VMC Master - Profilo Lim. Δ P. di Rugiada</strong>

                  Attiva [VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada] e
                  imposta il [Set Lim. Δ Punto di Rugiada] a 0 °C

                  <br>

                  <strong>3° VMC Master - VMC Master - Profilo
                  Calendario</strong>

                  Attiva [VMC ON/OFF, in Funzione del Calendario], imposta la
                  velocità della VMC su [Velocità 1] per entrambe le Fascie, e
                  Programma la 1° e 2° Fascia dalle 00:00 alle 06:00 e dalle
                  20:00 alle 23:59

                  <br>

                  <strong>4° VMC Master - Profilo Free Heating/Cooling</strong>

                  Attiva [VMC ON/OFF, in Funzione della Vel. Free Heating] e
                  [VMC ON/OFF, in Funzione della Vel. Free Cooling], Programma
                  il Free Heating da Ottobre a Giugno e Programma il Free
                  Cooling da Luglio a Settembre

                  <br>

                  <strong>VMC Master - Panic Botton (Riavvio Package)</strong>

                  Da impiegare se il comportamento della VMC non risponde
                  correttamente alle automazioni e/o comandi.

                  Disattiva i primi 4 Profili sopra Esposti, Disattiva [VMC
                  ON/OFF, in Funzione del Lim. CO₂ e/o VOC], Arresta la VMC,
                  Inizializza tutte le Varibili Booleane su [False] e Riavvia il
                  Package.

                  <br>

                  <strong>VMC Master - Profilo Inizializzazione (Riavvio di
                  H.A.)</strong>

                  Da impiegare solo la prima volta appena installato il Package.

                  Attiva i primi 4 Profili sopra Esposti, Attiva lo Status
                  Pannello Led, Disattiva lo Status Routine Sensori, Attiva [VMC
                  ON/OFF, in Funzione del Lim. CO₂ e/o VOC], Arresta la VMC,
                  Inizializza tutte le Varibili Booleane su [False] e Riavvia
                  Home Assistant.

                  <br>

                  </pre>

                  <br>

                  </details>


                  <details>

                  <summary><b>16 Booleans ON</b></summary>

                  <br>

                  {% if is_state('input_boolean.vmc_master_opzioni_vmc', 'on')
                  or
                  is_state('input_boolean.vmc_master_opzioni_monitoraggio_sensori',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_interruttore_offset_sensori',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_interruttore_calendario',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_offset_sensori',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_punto_di_rugiada',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_calendario_main',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_calendario', 'on')
                  or
                  is_state('input_boolean.vmc_master_opzioni_free_heating_o_free_cooling',
                  'on') or is_state('input_boolean.vmc_master_opzioni_avvisi',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_avvisi_grafici',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_lettura_sensori',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_scelta_sensori',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_elementi_chimici',
                  'on')%}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>SCHEDE</b></summary>{% if
                  is_state('input_boolean.vmc_master_opzioni_vmc', 'on')
                  %}vmc_master_opzioni_vmc: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_monitoraggio_sensori',
                  'on') %}vmc_master_opzioni_monitoraggio_sensori: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_interruttore_offset_sensori',
                  'on') %}vmc_master_opzioni_interruttore_offset_sensori: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra',
                  'on')
                  %}vmc_master_opzioni_interruttore_monitoraggio_sensori_extra:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_interruttore_calendario',
                  'on') %}vmc_master_opzioni_interruttore_calendario: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_offset_sensori',
                  'on') %}vmc_master_opzioni_offset_sensori: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_opzioni_punto_di_rugiada',
                  'on') %}vmc_master_opzioni_punto_di_rugiada: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_opzioni_calendario_main',
                  'on') %}vmc_master_opzioni_calendario_main: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_opzioni_calendario', 'on')
                  %}vmc_master_opzioni_calendario: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_free_heating_o_free_cooling',
                  'on') %}vmc_master_opzioni_free_heating_o_free_cooling: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_avvisi', 'on')
                  %}vmc_master_opzioni_avvisi_vmc: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_avvisi_grafici',
                  'on') %}vmc_master_opzioni_avvisi_grafici: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_opzioni_lettura_sensori',
                  'on') %}vmc_master_opzioni_lettura_sensori: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_opzioni_scelta_sensori',
                  'on') %}vmc_master_opzioni_scelta_sensori: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_opzioni_elementi_chimici',
                  'on') %}vmc_master_opzioni_elementi_chimici: On <br>{% endif
                  %}</pre>

                  {% endif %}





                  {% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita',
                  'on')%}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>AUTOMAZIONI
                  [Interruttori]</b></summary>{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita',
                  'on') %}vmc_master_opzioni_accendi_spegni_vmc_vs_umidita: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr',
                  'on') %}vmc_master_opzioni_accendi_spegni_vmc_vs_pdr: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario',
                  'on') %}vmc_master_opzioni_accendi_spegni_vmc_vs_calendario:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating',
                  'on') %}vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling',
                  'on') %}vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc',
                  'on') %}vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc:
                  On<br>{% endif %}</pre>

                  {% endif %}





                  {% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_avvisi',
                  'on') or
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_avvisi_spia',
                  'on') or
                  is_state('input_boolean.vmc_master_notifica_status_vmc',
                  'on')%}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>MOSTRA/NASCONDI
                  AVVISI</b></summary>{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_avvisi',
                  'on')%}vmc_master_opzioni_accendi_spegni_avvisi: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_opzioni_accendi_spegni_avvisi_spia',
                  'on')%}vmc_master_opzioni_accendi_spegni_avvisi_spia: On<br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_notifica_status_vmc','on')
                  %}vmc_master_notifica_status_vmc: On{% endif %}</pre> {% endif
                  %}





                  {% if
                  is_state('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>SPIA
                  CONGELAMENTO</b></summary>{% if
                  is_state('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia',
                  'on') %}vmc_master_congelamento_verifica_soglia_valore_spia:
                  On <br>{% endif %}</pre>

                  {% endif %}





                  {% if
                  is_state('sensor.vmc_master_congelamento_verifica_soglia',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_0_congelamento',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_1_congelamento',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_2_congelamento',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_3_congelamento',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_4_congelamento',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_notturna_congelamento',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_congelamento',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details
                  open><summary><b>CONGELAMENTO</b></summary>{% if
                  is_state('sensor.vmc_master_congelamento_verifica_soglia',
                  'on') %}vmc_master_congelamento_verifica_soglia: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_0_congelamento',
                  'on') %}vmc_master_spia_velocita_0_congelamento: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_1_congelamento',
                  'on') %}vmc_master_spia_velocita_1_congelamento: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_2_congelamento',
                  'on') %}vmc_master_spia_velocita_2_congelamento: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_3_congelamento',
                  'on') %}vmc_master_spia_velocita_3_congelamento: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_4_congelamento',
                  'on') %}vmc_master_spia_velocita_4_congelamento: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento',
                  'on')
                  %}vmc_master_spia_velocita_iperventilazione_congelamento: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_notturna_congelamento',
                  'on') %}vmc_master_spia_velocita_notturna_congelamento: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_congelamento',
                  'on') %}vmc_master_spia_velocita_freecooling_congelamento: On
                  <br>{% endif %}</pre>

                  {% endif %}





                  {% if
                  is_state('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_0',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_2',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_3',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_4',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_iperventilazione',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_notturna',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_freecooling',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>SPIA
                  UMIDITA'</b></summary>{% if
                  is_state('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia',
                  'on') %}vmc_master_umidita_verifica_soglia_valore_spia: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_0',
                  'on') %}vmc_master_spia_umidita_velocita_0: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_1',
                  'on') %}vmc_master_spia_umidita_velocita_1: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_2',
                  'on') %}vmc_master_spia_umidita_velocita_2: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_3',
                  'on') %}vmc_master_spia_umidita_velocita_3: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_4',
                  'on') %}vmc_master_spia_umidita_velocita_4: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_iperventilazione',
                  'on') %}vmc_master_spia_umidita_velocita_iperventilazione: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_notturna',
                  'on') %}vmc_master_spia_umidita_velocita_notturna: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_umidita_velocita_freecooling',
                  'on') %}vmc_master_spia_umidita_velocita_freecooling: On
                  <br>{% endif %}</pre>

                  {% endif %}





                  {% if is_state('input_boolean.vmc_master_spia_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_0_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_1_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_2_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_3_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_4_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>INQUINANTI CO2 E
                  VOC</b></summary>{% if
                  is_state('input_boolean.vmc_master_spia_co2_o_voc', 'on')
                  %}vmc_master_spia_co2_o_voc: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0',
                  'on') %}vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_0_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_0_co2_o_voc: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_1_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_1_co2_o_voc: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_2_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_2_co2_o_voc: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_3_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_3_co2_o_voc: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_4_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_4_co2_o_voc: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_notturna_co2_o_voc: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_iperventilazione_co2_o_voc:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc',
                  'on') %}vmc_master_spia_velocita_freecooling_co2_o_voc: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr',
                  'on') %}vmc_master_spia_velocita_1_co2_o_voc_pdr: On <br>{%
                  endif %}</pre>

                  {% endif %}





                  {% if
                  is_state('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio',
                  'on')  or
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>PUNTO DI
                  RUGIADA</b></summary>{% if
                  is_state('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio',
                  'on') %}vmc_master_spia_velocita_0_un_solo_avvio: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio',
                  'on') %}vmc_master_spia_velocita_1_un_solo_avvio: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio',
                  'on') %}vmc_master_spia_velocita_2_un_solo_avvio: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio',
                  'on') %}vmc_master_spia_velocita_3_un_solo_avvio: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio',
                  'on') %}vmc_master_spia_velocita_4_un_solo_avvio: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio',
                  'on') %}vmc_master_spia_velocita_notturna_un_solo_avvio: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio',
                  'on')
                  %}vmc_master_spia_velocita_iperventilazione_un_solo_avvio: On
                  <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio',
                  'on') %}vmc_master_spia_velocita_freecooling_un_solo_avvio: On
                  <br>{% endif %}</pre>

                  {% endif %}





                  {% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>SPIA ATTIVAZIONE FREE
                  HEATING / FREE COOLING</b></summary>{% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling',
                  'on')
                  %}vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating',
                  'on')
                  %}vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating:
                  On <br>{% endif %}</pre>

                  {% endif %}





                  {% if
                  is_state('input_boolean.vmc_master_spia_calendario_lunedi_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_lunedi_2',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_martedi_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_martedi_2',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_mercoledi_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_mercoledi_2',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_giovedi_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_giovedi_2',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_venerdi_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_venerdi_2',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_sabato_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_sabato_2',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_domenica_1',
                  'on') or
                  is_state('input_boolean.vmc_master_spia_calendario_domenica_2',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>CALENDARIO</b></summary>{%
                  if
                  is_state('input_boolean.vmc_master_spia_calendario_lunedi_1',
                  'on') %}vmc_master_spia_calendario_lunedi_1: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_lunedi_2',
                  'on') %}vmc_master_spia_calendario_lunedi_2: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_martedi_1',
                  'on') %}vmc_master_spia_calendario_martedi_1: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_martedi_2',
                  'on') %}vmc_master_spia_calendario_martedi_2: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_mercoledi_1',
                  'on') %}vmc_master_spia_calendario_mercoledi_1: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_mercoledi_2',
                  'on') %}vmc_master_spia_calendario_mercoledi_2: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_giovedi_1',
                  'on') %}vmc_master_spia_calendario_giovedi_1: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_giovedi_2',
                  'on') %}vmc_master_spia_calendario_giovedi_2: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_venerdi_1',
                  'on') %}vmc_master_spia_calendario_venerdi_1: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_venerdi_2',
                  'on') %}vmc_master_spia_calendario_venerdi_2: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_sabato_1',
                  'on') %}vmc_master_spia_calendario_sabato_1: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_sabato_2',
                  'on') %}vmc_master_spia_calendario_sabato_2: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_domenica_1',
                  'on') %}vmc_master_spia_calendario_domenica_1: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_calendario_domenica_2',
                  'on') %}vmc_master_spia_calendario_domenica_2: On <br>{% endif
                  %}</pre>

                  {% endif %}





                  {% if is_state('input_boolean.vmc_master_spia_velocita_0',
                  'on') or is_state('input_boolean.vmc_master_spia_velocita_1',
                  'on') or is_state('input_boolean.vmc_master_spia_velocita_2',
                  'on') or is_state('input_boolean.vmc_master_spia_velocita_3',
                  'on') or is_state('input_boolean.vmc_master_spia_velocita_4',
                  'on')
                     or is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'on') or is_state('input_boolean.vmc_master_spia_velocita_notturna', 'on') or is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'on') %}

                  <pre style="font-size: 1px; background-color: #d9ffcc">

                  <details open><summary><b>BLACKOUT</b></summary>{% if
                  is_state('input_boolean.vmc_master_spia_velocita_0', 'on')
                  %}vmc_master_spia_velocita_0: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_1', 'on')
                  %}vmc_master_spia_velocita_1: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_2', 'on')
                  %}vmc_master_spia_velocita_2: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_3', 'on')
                  %}vmc_master_spia_velocita_3: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_4', 'on')
                  %}vmc_master_spia_velocita_4: On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione',
                  'on') %}vmc_master_spia_velocita_iperventilazione: On <br>{%
                  endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_notturna',
                  'on') %}vmc_master_spia_velocita_notturna: On <br>{% endif
                  %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling',
                  'on') %}vmc_master_spia_velocita_freecooling: On <br>{% endif
                  %}</pre>

                  {% endif %}





                  {% if
                  is_state('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia',
                  'on') %}


                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>SPIA ALLERTA DIFF. TEMP.
                  (INTEST) > 23 [°C]</b></summary>{% if
                  is_state('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia',
                  'on') %}vmc_master_delta_temp_verifica_soglia_valore_spia: On
                  <br>{% endif %}</pre>

                  {% endif %}





                  {% if is_state('sensor.vmc_master_delta_temp_verifica_soglia',
                  'on')
                     or is_state('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore', 'on') or is_state('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore', 'on') or is_state('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore', 'on')  or is_state('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore', 'on')  or is_state('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore', 'on')  or is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore', 'on')  or is_state('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore', 'on')  or is_state('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore', 'on') %}

                  <pre style="font-size: 1px; background-color:
                  #d9ffcc"><details open><summary><b>DIFF. TEMP. (INTEST) > 23
                  [°C]?</b></summary>{% if
                  is_state('sensor.vmc_master_delta_temp_verifica_soglia', 'on')
                  %}vmc_master_delta_temp_verifica_soglia: On <br>{% endif %}{%
                  if
                  is_state('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}{% if
                  is_state('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore',
                  'on')
                  %}vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore:
                  On <br>{% endif %}</pre>

                  {% endif %}

                  <br>

                  </details>


                  <details> 
                    <summary><b>17 Logiche di Funzionamento</b></summary> 
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;
                      <a href="https://raw.githubusercontent.com/DanRobo76/VMC-HELTY-FLOW/main/Logiche%20di%20Funzionamento.png">
                        <img src="https://raw.githubusercontent.com/DanRobo76/VMC-HELTY-FLOW/main/Logiche%20di%20Funzionamento.png" alt="Logiche di Funzionamento" width="80%">
                      </a> 
                    </p> 
                  </details>





                  <details>

                  <summary><strong>18 Indice di Benessere&nbsp;(Punto di
                  Rugiada)</strong></summary>

                  E' un indicatore che converte il punto di rugiada
                  (T<sub>PdR</sub>) in una classificazione qualitativa del
                  comfort igrometrico all’interno di un ambiente.


                  | Condizione su T<sub>PdR</sub> | Indice di Benessere       |

                  |-------------------------------|---------------------------|

                  | T<sub>PdR</sub> ≥ 29 °C       | –                        |

                  | 25 °C ≤ T<sub>PdR</sub> < 29 °C | Molto fastidioso Liv. 2 |

                  | 22 °C ≤ T<sub>PdR</sub> < 25 °C | Molto fastidioso Liv. 1 |

                  | 19 °C ≤ T<sub>PdR</sub> < 22 °C | Fastidioso              |

                  | 16 °C ≤ T<sub>PdR</sub> < 19 °C | Accettabile             |

                  | 13 °C ≤ T<sub>PdR</sub> < 16 °C | Confortevole Liv. 2     |

                  | 10 °C ≤ T<sub>PdR</sub> < 13 °C | Confortevole Liv. 1     |

                  | 7 °C ≤ T<sub>PdR</sub> < 10 °C  | Umido                   |

                  | T<sub>PdR</sub> < 7 °C         | –                        |


                  <p align="center">
                    <a href="https://raw.githubusercontent.com/DanRobo76/VMC-HELTY-FLOW/main/Indice%20di%20Benessere.png" target="_blank">
                      <img src="https://raw.githubusercontent.com/DanRobo76/VMC-HELTY-FLOW/main/Indice%20di%20Benessere.png"
                           alt="Indice di Benessere – grafico"
                           style="max-width:90%;height:auto;">
                    </a>
                  </p>

                  </details>



                  <details>
                    <summary><b>19 Elenco VMC Installate</b></summary>
                    <pre style="font-size:10px; background-color: #d9ffcc; overflow-x:auto;">
                      <table border="1" style="width:100%; border-collapse: collapse;">
                        <thead>
                          <tr style="background-color: #f2f2f2;">
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;NOME VMC&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;VELOCITÀ&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Status Sensori VMC&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Status Pannello LED&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Temperatura Esterna&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Umidità Esterna&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Temperatura Interna&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Umidità Interna&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;CO2&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;VOC&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Punto di Rugiada&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Umidità Assoluta Esterna&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Umidità Assoluta Interna&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;CO2 Verifica Soglia&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;VOC Verifica Soglia&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Alert Monitoraggio PDR&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Umidità Interna Verifica Soglia&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Alert Monitoraggio Free Heating o Free Cooling&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Delta Temperatura Verifica Soglia&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Congelamento Verifica Soglia&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Alert Monitoraggio Black Out&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Status Calcolo Portata Ventola&nbsp;&nbsp;</th>
                            <th style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;Status Portata Ventola Lettura Codice Interpretato&nbsp;&nbsp;</th>
                          </tr>
                        </thead>
                        <tbody>
                          {%- for state in states.sensor if state.entity_id.endswith('_status_ventola_lettura_codice_interpretato_interfaccia') -%}
                            {%- set parts = state.entity_id.split('_') -%}
                            {%- set location = parts[1].upper() -%} <!-- Correzione: da lower() a upper() -->
                            {%- set status_sensor = states('sensor.vmc_' ~ location ~ '_nome_status') | default('N/A') -%}
                            {%- set sensor_status = states('sensor.vmc_' ~ location ~ '_status_sensori_lettura_codice_interpretato') | default('N/A') -%}
                            {%- set led_status = states('sensor.vmc_' ~ location ~ '_status_led_pannello_lettura_codice_interpretato') | default('N/A') -%}
                            {%- set temp_esterna_status = states('sensor.vmc_' ~ location ~ '_temp_esterna_status') | default('N/A') -%}
                            {%- set umidita_esterna_status = states('sensor.vmc_' ~ location ~ '_umidita_esterna_status') | default('N/A') -%}
                            {%- set temp_interna_status = states('sensor.vmc_' ~ location ~ '_temp_interna_status') | default('N/A') -%}
                            {%- set umidita_interna_status = states('sensor.vmc_' ~ location ~ '_umidita_interna_status') | default('N/A') -%}
                            {%- set co2_status = states('sensor.vmc_' ~ location ~ '_co2_status') | default('N/A') -%}
                            {%- set voc_status = states('sensor.vmc_' ~ location ~ '_voc_status') | default('N/A') -%}
                            {%- set punto_di_rugiada_status = states('sensor.vmc_' ~ location ~ '_punto_di_rugiada_valore') | default('N/A') -%}
                            {%- set umidita_assoluta_esterna_status = states('sensor.vmc_' ~ location ~ '_umidita_assoluta_esterna') | default('N/A') -%}
                            {%- set umidita_assoluta_interna_status = states('sensor.vmc_' ~ location ~ '_umidita_assoluta_interna') | default('N/A') -%}
                            {%- set co2_status_verifica_soglia = states('sensor.vmc_' ~ location ~ '_co2_status_verifica_soglia') | default('N/A') -%}
                            {%- set voc_status_verifica_soglia = states('sensor.vmc_' ~ location ~ '_voc_status_verifica_soglia') | default('N/A') -%}
                            {%- set alert_monitoraggio_pdr = states('sensor.vmc_' ~ location ~ '_alert_monitoraggio_pdr') | default('N/A') -%}
                            {%- set umidita_interna_status_verifica_soglia = states('sensor.vmc_' ~ location ~ '_umidita_interna_status_verifica_soglia') | default('N/A') -%}
                            {%- set alert_monitoraggio_free_heating_o_free_cooling = states('sensor.vmc_' ~ location ~ '_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') | default('N/A') -%}
                            {%- set delta_temp_verifica_soglia = states('sensor.vmc_' ~ location ~ '_delta_temp_verifica_soglia') | default('N/A') -%}
                            {%- set congelamento_verifica_soglia = states('sensor.vmc_' ~ location ~ '_congelamento_verifica_soglia') | default('N/A') -%}
                            {%- set alert_monitoraggio_black_out = states('sensor.vmc_' ~ location ~ '_alert_monitoraggio_black_out') | default('N/A') -%}
                            {%- set status_calcolo_portata_ventola = states('sensor.vmc_' ~ location ~ '_status_calcolo_portata_ventola') | default('N/A') -%}
                            {%- set status_portata_ventola_lettura_codice_interpretato = states('sensor.vmc_' ~ location ~ '_status_portata_ventola_lettura_codice_interpretato') | default('N/A') -%}
                            <tr>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ status_sensor }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ state.state }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ sensor_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ led_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ temp_esterna_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ umidita_esterna_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ temp_interna_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ umidita_interna_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ co2_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ voc_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ punto_di_rugiada_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ umidita_assoluta_esterna_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ umidita_assoluta_interna_status }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ co2_status_verifica_soglia }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ voc_status_verifica_soglia }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ alert_monitoraggio_pdr }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ umidita_interna_status_verifica_soglia }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ alert_monitoraggio_free_heating_o_free_cooling }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ delta_temp_verifica_soglia }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ congelamento_verifica_soglia }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ alert_monitoraggio_black_out }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ status_calcolo_portata_ventola }}&nbsp;&nbsp;</td>
                              <td style="padding: 10px; border: 1px solid black;">&nbsp;&nbsp;{{ status_portata_ventola_lettura_codice_interpretato }}&nbsp;&nbsp;</td>
                            </tr>
                          {%- endfor %}
                        </tbody>
                      </table>
                    </pre>
                  </details>
                   <br> <details> <summary><b>Pacca sulla Spalla 😊</b></summary> <p>&nbsp;&nbsp;&nbsp;&nbsp;Offrimi un Ginseng <a href="https://www.paypal.com/donate/?business=YU9379GL8VDW4&amount=1.2&no_recurring=1&item_name=Se+il+progetto+ti+%C3%A8+piaciuto%2C++offrimi+un+GinSeng%21+%0A%3B%29&currency_code=EUR"><img src="https://user-images.githubusercontent.com/102819027/253791354-81ba7208-fbad-4fab-8ceb-cdcf901fdb61.png" alt="" width="38%"></a> Grazie!</p> </details>