alias: Automazione VMC Master
description: >-
  Automazione VMC Master Release v.4.0.0:

  - Invia Comandi alla VMC leggendone i valori Contenuti;

  - Permette l'accensione e lo spegnimento Automatico, in funzione delle 2 fasce
  orarie programmabili per ogni giorno della settimana;
   - Permette l'accensione e lo spegnimento Automatico, in funzione delle 2 fasce mensili programmabili per la Velocità impostata su Free Heating / Free Cooling;
   - Permette l'accensione e lo spegnimento Automatico, in funzione dei Parametri Ambientali (Lettura del Punto di Rugiada Esterno ed Interno)
   - Permette lo spegnimento Automatico, in funzione della Temperatura Esterna se ≤ -18 [°C] e successiva ripresa, anche in funzione degli Offset settati;
   - Permette l'accensione e lo spegnimento Automatico, in funzione degli inquinanti (CO₂ e VOC);
   - Ripristina la Velocità precedente in caso di Black-Out, se la VMC ha una linea dedicata e/o se installato un relè domotico;
   - Avvisa in caso di Aggiornamento del Package;
   - Rinomina la VMC;
  - Permette di Cambiare l'IP.
trigger:
  - alias: Trigger Attivazione Finestra Avvisi Grafici
    platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_avvisi_grafici
    from: "off"
    to: "on"
    id: Opzioni Avvisi Grafici On
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 0
  - alias: Trigger Disattivazione Finestra Avvisi Grafici
    platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_avvisi_grafici
    id: Opzioni Avvisi Grafici Off
    from: "on"
    to: "off"
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_vmc
    from: "off"
    to: "on"
    id: Opzioni Telecomando On
    alias: Trigger Attivazione Finestra Telecomando
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_vmc
    id: Opzioni Telecomando Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Telecomando
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_monitoraggio_sensori
    to: "on"
    id: Opzioni Monitoraggio On
    alias: Trigger Attivazione Finestra Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_monitoraggio_sensori
    id: Opzioni Monitoraggio Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
    from: "off"
    to: "on"
    id: Opzioni Sub Offset On
    alias: Trigger Attivazione Sotto Finestra Offset - Finestra Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
    from: "on"
    to: "off"
    id: Opzioni Sub Offset Off
    alias: Trigger Disattivazione Sotto Finestra Offset - Finestra Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
    from: "off"
    to: "on"
    id: Opzioni Sub Extra Sensori On
    alias: Trigger Attivazione Sotto Finestra Sensori Extra - Finestra Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
    from: "on"
    to: "off"
    id: Opzioni Sub Extra Sensori Off
    alias: >-
      Trigger Disattivazione Sotto Finestra Sensori Extra - Finestra
      Monitoraggio
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_calendario
    from: "off"
    to: "on"
    id: Opzioni Sub Programmazione Giornaliera On
    alias: Trigger Attivazione Programmazione Giornaliera
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_calendario
    from: "on"
    to: "off"
    id: Opzioni Sub Programmazione Giornaliera Off
    alias: Trigger Disattivazione Programmazione Giornaliera
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_offset_sensori
    from: "off"
    to: "on"
    id: " Opzioni On"
    alias: Trigger Attivazione Finestra Opzioni
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_offset_sensori
    id: Opzioni Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Opzioni
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_punto_di_rugiada
    alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di Rugiada
    id: Opzioni Sub Lim. Δ P. di Rugiada On
    from: "off"
    to: "on"
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_punto_di_rugiada
    alias: >-
      Trigger Disattivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di
      Rugiada
    from: "on"
    to: "off"
    id: Opzioni Sub Lim. Δ P. di Rugiada Off
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_calendario_main
    alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Main
    id: Opzioni Sub Calendario Main On
    from: "off"
    to: "on"
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_calendario_main
    alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario Main
    from: "on"
    to: "off"
    id: Opzioni Sub Calendario Main Off
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_calendario
    alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario
    id: Opzioni Sub Calendario On
    from: "off"
    to: "on"
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_calendario
    alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
    from: "on"
    to: "off"
    id: Opzioni Sub Calendario Off
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
    alias: >-
      Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Free
      Heating / Free Cooling
    id: Opzioni Sub Calendario Free H/C On
    from: "off"
    to: "on"
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
    alias: >-
      Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario Free
      Heating / Free Cooling
    from: "on"
    to: "off"
    id: Opzioni Sub Calendario Free H/C Off
    enabled: true
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_avvisi
    from: "off"
    to: "on"
    id: Opzioni Avvisi On
    alias: Trigger Attivazione Finestra Avvisi
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_avvisi
    id: Opzioni Avvisi Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Avvisi
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_lettura_sensori
    from: "off"
    to: "on"
    id: Opzioni Informazioni On
    alias: Trigger Attivazione Finestra Informazioni
  - platform: state
    entity_id:
      - input_boolean.vmc_master_opzioni_lettura_sensori
    id: Opzioni Informazioni Off
    from: "on"
    to: "off"
    for:
      hours: 0
      minutes: 0
      seconds: 0
    alias: Trigger Disattivazione Finestra Informazioni
  - alias: >-
      Condizioni Sfavorevoli a Velocità 1 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 1")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 1-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità 2 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 2")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 2-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità 3 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 3")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 3-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità 4 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 4")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 4-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità Notturna -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Notturna")) and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Notturna -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità Free Cool./Heat.-> Imposta Velocità 0 se
      Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Free Cooling")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Free-Cooling -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità Iperventilazione -> Imposta Velocità 0
      se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Iperventilazione")) and
      (states('input_boolean.vmc_master_spia_co2_o_voc') == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Iperventilazione -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità 1 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 1")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 1 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità 2 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 2")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 2 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità 3 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 3")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 3 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità 4 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 4")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Vel. 4 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità Notturna se Spia Congelamento Off e Spia
      Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Notturna")) and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Notturna se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità Free Cool./Heat. se Spia Congelamento
      Off e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Free Cooling")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Free-Cooling se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli a Velocità Iperventilazione se Spia Congelamento
      Off e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Iperventilazione")) and
      (states('input_boolean.vmc_master_spia_co2_o_voc') == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: PdR Iperventilazione se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 0 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF Vs PdR
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'on')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 0 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')== 'on')
      and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 1 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 2 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 3 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 4 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Notturno No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta, Presenza di Inquinanti') and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Free Cool./Heat. No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Iperventilazione No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON - Attenzione Verifica anche
      La Spia vmc_master_spia_velocita_freecooling_un_solo_avvio è ON solo se
      Spia Free Heating è ON oppure  Spia Free Cooling è ON
    platform: template
    value_template: >-
      {{ states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')== 'on'
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and
      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'off') ) )) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
      and states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    id: Rip. Vel. 1 No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 2 No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 3 No PdR  se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Vel. 4 No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Notturno No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off'
      and states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta, Presenza di Inquinanti') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') or
      (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off'
      and states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') }}
    id: Rip. Free Cool./Heat. No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: Rip. Iperventilazione No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
      precedentemente Armato ed Attivato -> Velocità 0 se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=='off')
      and ( (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'))
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'off')) ) }}
    id: " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato"
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
      precedentemente Armato ed Attivato -> Velocità 1 se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=='off')
      and ( (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'))
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'on')) ) }}
    id: " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato e Spia Inquinanti ON"
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating ->
      Vel. 0 se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti
      OFF
    platform: template
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: TeVsTi Free-Heating -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling ->
      Vel. 0 se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti
      OFF
    platform: template
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: TeVsTi Free-Cooling -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating se
      Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: TeVsTi Free-Heating e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling se
      Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: TeVsTi Free-Cooling e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    enabled: true
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti OFF
    platform: template
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti') and 
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
      }}
    id: "Rip. Free Heating No TeVsTi "
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti OFF
    platform: template
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti') and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')=='off'
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'}}
    id: "Rip. Free Cooling No TeVsTi "
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti ON
    platform: template
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti') and 
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
      }}
    id: Rip. Free Heating No TeVsTi e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti ON
    platform: template
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti') and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')=='off'
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'}}
    id: Rip. Free Cooling No TeVsTi e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
      precedentemente Armato  -> Vel. 0 se Spia Inquinanti OFF
    platform: template
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Cooling' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' }}
    id: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
      precedentemente Armato
    enabled: true
  - alias: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato  -> Vel. 0 se Spia Inquinanti OFF"
    platform: template
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Heating' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'off' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' }}
    id: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
      precedentemente Armato
    enabled: true
  - alias: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
      precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON
    platform: template
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Cooling' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' }}
    id: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating precedentemente Armato e Spia Inquinanti ON"
    enabled: true
  - alias: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON"
    platform: template
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Heating' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'off' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' }}
    id: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato e Spia Inquinanti ON"
    enabled: true
  - alias: Black-Out Velocità 0 [ON]
    platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 0") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out a Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_0')=="on") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità 0 [OFF, Ripristino]
    id: Black-Out Off Vel. 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 1") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out a Velocità 1
    alias: Black-Out Velocità 1 [ON]
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_1')=="on") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità 1 [OFF, Ripristino]
    id: Black-Out Off Vel. 1
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 2") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out a Velocità 2
    alias: Black-Out Velocità 2 [ON]
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_2')=="on") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità 2 [OFF, Ripristino]
    id: Black-Out Off Vel. 2
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 3") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out a Velocità 3
    alias: Black-Out Velocità 3 [ON]
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_3')=="on") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità 3 [OFF, Ripristino]
    id: Black-Out Off Vel. 3
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 4") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out a Velocità 4
    alias: Black-Out Velocità 4 [ON]
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_4')=="on") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità 4 [OFF, Ripristino]
    id: Black-Out Off Vel. 4
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Notturna") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out Notturna
    alias: Black-Out Velocità Notturna [ON]
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_notturna')=="on") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità Notturna [OFF, Ripristino]
    id: Black-Out Off Notturna
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Iperventilazione") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out Iperventilazione
    alias: Black-Out Velocità Iperventilazione [ON]
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione')=="on")
      and ( (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità Iperventilazione [OFF, Ripristino]
    id: Black-Out Off Iperventilazione
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Free Cooling") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out Free Cool./Heat.
    alias: Black-Out Velocità Free Cool./Heat. [ON]
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - platform: template
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_freecooling')=="on") and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    alias: Black-Out Velocità Free Cool./Heat. [OFF, Ripristino]
    id: Black-Out Off Free Cool./Heat.
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 1° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Lunedì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 1° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Lunedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 2° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Lunedì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 2° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Lunedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 1° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Martedì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 1° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Martedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 2° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Martedì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 2° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 2° Martedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 1° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Mercoledì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 1° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Mercoledì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 2° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Mercoledì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 2° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 2° Mercoledì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 1° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Giovedì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 1° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Giovedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 2° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Giovedì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 2° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 2° Giovedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 1° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Venerdì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 1° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Venerdì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 2° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Venerdì On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 2° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 2° Venerdì Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 1° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Sabato On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 1° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Sabato Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 2° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Sabato On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 2° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 2° Sabato Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 1° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Domenica On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 1° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 1° Domenica Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      All'Interno della 2° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off 
    platform: template
    value_template: >
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}} 
    id: 2° Domenica On
    for:
      hours: 0
      minutes: 0
      seconds: 8
  - alias: >-
      All'Esterno della 2° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off
    platform: template
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: 2° Domenica Off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Calendario , precedentemente
      Armato ed Attivato tra le Fascie del Calendario -> Velocità 0 se Spia
      Inquinanti OFF
    platform: template
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario')=='off')
      and ( (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='on')
      or (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='on') )
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'off')) )}}
    id: Calendario Off tra Fascie
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Calendario , precedentemente
      Armato ed Attivato tra le Fascie del Calendario -> Velocità 1, se Spia
      Inquinanti ON
    platform: template
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario')=='off')
      and ( (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='on')
      or (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='on') )
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'on')) ) }}
    id: Calendario Off tra Fascie e Spia Inquinanti ON
  - platform: template
    value_template: "{{ states('input_text.vmc_master_nome_da_inserire')!=\"\"}}"
    id: Cambio Nome VMC
    alias: Rinomina VMC
  - platform: state
    entity_id:
      - input_text.vmc_master_ip_insert
    id: Riscrivi IP
    alias: Cambio Indirizzo IP della VMC (Riavvio di H.A.)
  - platform: template
    value_template: "{{ states('sensor.vmc_master_alert_monitoraggio_totale')=='Allerta'}}"
    alias: Spia Avvisi On
    id: Spia Avvisi On
  - platform: template
    value_template: >-
      {{ states('sensor.vmc_master_alert_monitoraggio_totale')=='Nessuna
      Allerta' or states('sensor.vmc_master_alert_monitoraggio_totale')=='Non
      disponibile'}}
    alias: Spia Avvisi Off
    id: Spia Avvisi Off
  - platform: template
    value_template: >-
      {{ states('sensor.vmc_master_versione_repository') !=
      states('sensor.vmc_master_versione_corrente') and
      states('input_boolean.vmc_master_popup_versione_corrente_vs_repository')=="off"
      and states('sensor.vmc_master_versione_repository') != "Errore
      Connessione"}}
    alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - ON
    id: Repository Update ON
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - platform: template
    value_template: >-
      {{ states('sensor.vmc_master_versione_repository') ==
      states('sensor.vmc_master_versione_corrente') and
      states('sensor.vmc_master_versione_repository') != "Errore Connessione"}}
    alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - OFF
    id: Repository Update OFF
  - alias: >-
      Attivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati se Spia
      Congelamento Off e Spia Delta Temp Off
    platform: template
    value_template: >-
      {{( ((states('sensor.vmc_master_alert_monitoraggio_co2') == 'Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_voc') == 'Allerta') and
      is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc',
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: inquinanti_co2_voc_on
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: Disattivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati
    platform: template
    value_template: >-
      {{ states('sensor.vmc_master_alert_monitoraggio_co2') != 'Allerta' and
      states('sensor.vmc_master_alert_monitoraggio_voc') != 'Allerta' and
      is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc',
      'on') }}
    id: inquinanti_co2_voc_off
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Spia Velocità 0 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      0')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: spia_velocita_0_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
    enabled: true
  - alias: >-
      Spia Velocità 1 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      1')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') }}
    id: spia_velocita_1_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Spia Velocità 2 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      2')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: spia_velocita_2_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Spia Velocità 3 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      3')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') }}
    id: spia_velocita_3_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Spia Velocità 4 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      4')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') }}
    id: spia_velocita_4_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Spia Velocità Notturna CO₂ e/o VOC se Spia Congelamento Off e Spia Delta
      Temp Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'))
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') }}
    id: spia_velocita_notturna_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Spia Velocità Iperventilazione CO₂ e/o VOC se Spia Congelamento Off e Spia
      Delta Temp Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'))
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') }}
    id: spia_velocita_iperventilazione_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Spia Velocità Free Heating/Cooling CO₂ e/o VOC se Spia Congelamento Off e
      Spia Delta Temp Off 
    platform: template
    value_template: >-
      {{ ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
      Cooling')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') }}
    id: spia_velocita_freecooling_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato -> Tutte le Spie CO2 e/o VOC OFF -> Vel. 0"
    platform: template
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=='off')
      and (
      (states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
      'on') or (states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')))
      )}}
    id: " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato"
  - alias: Congelamento ON
    platform: template
    value_template: "{{ states('sensor.vmc_master_congelamento_verifica_soglia')=='Si'}}"
    id: Congelamento ON
  - alias: >-
      Spia Velocità 0 Congelamento se Spia Congelamento ON e Spia Delta Temp Off
      e e Spia Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free Heating
      Congelamento = Off
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      0') and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and
      (states('input_boolean.vmc_master_spia_velocita_1_congelamento')== 'off'
      and states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_3_congelamento')== 'off'
      and states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
      'off')}}
    id: spia_velocita_0_congelamento
    enabled: true
  - alias: >-
      Spia Velocità 1 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      1') and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) }}
    id: spia_velocita_1_congelamento
    enabled: true
  - alias: >-
      Spia Velocità 2 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      2') and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) }}
    id: spia_velocita_2_congelamento
    enabled: true
  - alias: >-
      Spia Velocità 3 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      3') and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) }}
    id: spia_velocita_3_congelamento
    enabled: true
  - alias: >-
      Spia Velocità 4 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      4') and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) }}
    id: spia_velocita_4_congelamento
    enabled: true
  - alias: >-
      Spia Velocità Iperventilazione Congelamento se Spia Congelamento ON e Spia
      Delta Temp Off 
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione')
      and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18 and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) }}
    id: spia_velocita_iperventilazione_congelamento
    enabled: true
  - alias: >-
      Spia Velocità Notturna Congelamento se Spia Congelamento ON e Spia Delta
      Temp Off 
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna')
      and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18 and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) }}
    id: spia_velocita_notturna_congelamento
    enabled: true
  - alias: >-
      Spia Velocità Free Cooling Congelamento se Spia Congelamento ON e Spia
      Delta Temp Off 
    platform: template
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
      Cooling') and (states('sensor.vmc_master_temp_esterna_status') | float(0)
      <=-18 and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) }}
    id: spia_velocita_Free Cooling_congelamento
    enabled: true
  - alias: Congelamento OFF
    platform: template
    value_template: "{{ states('sensor.vmc_master_congelamento_verifica_soglia')!='Si'}}"
    id: Congelamento OFF
  - alias: >-
      Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON e se Spia
      Inquinanti OFF e se Spia Congelamento Off e Spia Delta Temp Off
    platform: template
    value_template: >-
      {{ (
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
      ) and (
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 1' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 2' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 3' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 4' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Notturna' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Iperventilazione') and states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off'  and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')}}
    id: >-
      Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON - Inquinanti
      OFF
    for:
      hours: 0
      minutes: 0
      seconds: 4
    enabled: true
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating OFF e Spia FreeCooling ON ->
      Imposta Velocità 0 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti OFF
    platform: template
    value_template: >-
      {{ states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Nessuna Allerta' and
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Nessuna Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    id: PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating OFF e Spia FreeCooling ON ->
      Imposta Velocità 1 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti ON
    platform: template
    value_template: >-
      {{ states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: >-
      PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta Velocità 1 se
      Spia Inquinanti ON
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating ON e Spia FreeCooling OFF ->
      Imposta Velocità 0 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti OFF
    platform: template
    value_template: >-
      {{ states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Nessuna Allerta' and
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Nessuna Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta Velocità 0
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating ON e Spia FreeCooling OFF ->
      Imposta Velocità 1 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti ON
    platform: template
    value_template: >-
      {{ states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: >-
      PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta Velocità 1 se
      Spia Inquinanti ON
  - alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 OFF se Spia Congelamento Off e Spia Delta Temp
      Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Heating]
    platform: template
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza
      di Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: PdR Vel. 0 con Spia FreeHeating On -> Imposta Velocità 0
  - alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 OFF se Spia Congelamento Off e Spia Delta Temp
      Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Cooling]
    platform: template
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: PdR Vel. 0 con Spia FreeCooling On -> Imposta Velocità 0
  - platform: template
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza
      di Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp Off
      [Caso Velocità Free Heating]
    id: >-
      PdR Vel. 0 con Spia FreeHeating On e Inquinanti Vel. 1 ON  -> Imposta
      Velocità 1
    enabled: true
  - alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp Off
      [Caso Velocità Free Cooling]
    platform: template
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: >-
      PdR Vel. 0 con Spia FreeCooling On e Inquinanti Vel. 1 ON  -> Imposta
      Velocità 1
condition: []
action:
  - choose:
      - conditions:
          - condition: trigger
            id: Opzioni Telecomando On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_vmc
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
        alias: Trigger Attivazione Finestra Telecomando
      - conditions:
          - condition: trigger
            id: Opzioni Telecomando Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_vmc
        alias: Trigger Disattivazione Finestra Telecomando
      - conditions:
          - condition: trigger
            id: Opzioni Monitoraggio On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_monitoraggio_sensori
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
        alias: Trigger Attivazione Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Monitoraggio Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_offset_sensori
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
        alias: Trigger Disattivazione Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Offset On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_offset_sensori
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
        alias: Trigger Attivazione Sotto Finestra Offset - Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Offset Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_offset_sensori
        alias: Trigger Disattivazione Sotto Finestra Offset - Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Extra Sensori On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: >-
                input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
        alias: >-
          Trigger Attivazione Sotto Finestra Sensori Extra - Finestra
          Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Extra Sensori Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: >-
                input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
        alias: >-
          Trigger Attivazione Sotto Finestra Sensori Extra - Finestra
          Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Programmazione Giornaliera On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_calendario
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
        alias: Trigger Attivazione Programmazione Giornaliera
      - conditions:
          - condition: trigger
            id: Opzioni Sub Programmazione Giornaliera Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_calendario
        alias: Trigger Disattivazione Programmazione Giornaliera
      - conditions:
          - condition: trigger
            id: " Opzioni On"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_offset_sensori
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
        alias: Trigger Attivazione Finestra Opzioni
      - conditions:
          - condition: trigger
            id: Opzioni Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
        alias: Trigger Disattivazione Finestra Opzioni
      - conditions:
          - condition: trigger
            id: Opzioni Sub Lim. Δ P. di Rugiada On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_punto_di_rugiada
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
        alias: >-
          Trigger Attivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di
          Rugiada
      - conditions:
          - condition: trigger
            id: Opzioni Sub Lim. Δ P. di Rugiada Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_punto_di_rugiada
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di
          Rugiada
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Main On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario_main
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_calendario
        alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Main
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Main Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario_main
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
          Main
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
        alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario
        alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Free H/C On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_calendario
        alias: >-
          Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Free
          Heating / Free Cooling
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Free H/C Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
          Free Heating / Free Cooling
      - conditions:
          - condition: trigger
            id:
              - Opzioni Avvisi On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_avvisi
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_avvisi_grafici
        alias: Trigger Attivazione Finestra Avvisi
      - conditions:
          - condition: trigger
            id:
              - Opzioni Avvisi Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
        alias: Trigger Disattivazione Finestra Avvisi
      - conditions:
          - condition: trigger
            id: Opzioni Informazioni On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_lettura_sensori
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
        alias: Trigger Attivazione Finestra Informazioni
      - conditions:
          - condition: trigger
            id: Opzioni Informazioni Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_lettura_sensori
        alias: Trigger Disattivazione Finestra Informazioni
      - conditions:
          - condition: trigger
            id: PdR Vel. 1-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 1 -> Velocità 0, memorizzando
              la Velocità 1
            if:
              - condition: template
                value_template: >-
                  {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                  'off'}}
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_0
                      data: {}
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
            else:
              - service: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                    - >-
                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
        alias: >-
          Condizioni Sfavorevoli a Velocità 1 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Vel. 2-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 2 -> Velocità 0, memorizzando
              la Velocità 2
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_0
                      data: {}
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 2 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Vel. 3-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 3 -> Velocità 0, memorizzando
              la Velocità 3
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_0
                      data: {}
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 3 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 4-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 4 -> Velocità 0, memorizzando
              la Velocità 4
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_0
                      data: {}
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 4 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Notturna -> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità Notturna -> Velocità 0,
              memorizzando la Velocità Notturna
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_0
                      data: {}
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Notturna -> Imposta Velocità 0 se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id:
              - PdR Free-Cooling -> Imposta Velocità 0
              - >-
                PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta
                Velocità 0
              - >-
                PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta
                Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità Free Cool./Heat. -> Velocità 0,
              memorizzando la Velocità Free Cool./Heat.
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_0
                      data: {}
                  until:
                    - alias: Ripeti finchè la Velocità = Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Free Cool./Heat.-> Imposta Velocità
          0 se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Iperventilazione -> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità Iperventilazione -> Velocità 0,
              memorizzando la Velocità Iperventilazione
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_0
                      data: {}
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Iperventilazione -> Imposta Velocità
          0 se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 1 se Spia Inquinanti ON
        sequence:
          - if:
              - condition: template
                value_template: >-
                  {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                  'off' and 
                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                  'off'}}
                enabled: true
            then:
              - choose:
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off'}}
                        alias: SE Spia Free Heating OFF e Spia FreeCooling OFF
                        enabled: true
                    sequence:
                      - repeat:
                          sequence:
                            - service: input_boolean.turn_on
                              data: {}
                              target:
                                entity_id: >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - service: input_boolean.turn_off
                              data: {}
                              target:
                                entity_id:
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - service: shell_command.vmc_master_velocita_1
                              data: {}
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                1'}}
                        enabled: true
                    alias: >-
                      Condizioni Sfavorevoli a Velocità 1 se Spia Inquinanti ON
                      e (Spia Free Heating OFF e Spia FreeCooling OFF) -> Vel. 1
                  - conditions:
                      - alias: Spia Free Heating ON e Spia FreeCooling OFF
                        condition: template
                        value_template: >-
                          {{
                          (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'on') }}
                    sequence:
                      - repeat:
                          sequence:
                            - service: input_boolean.turn_on
                              data: {}
                              target:
                                entity_id: >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - service: input_boolean.turn_off
                              data: {}
                              target:
                                entity_id:
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - service: shell_command.vmc_master_velocita_1
                              data: {}
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                1'}}
                    alias: >-
                      Condizioni Sfavorevoli a Velocità 1 se Spia Inquinanti ON
                      e (Spia Free Heating ON e Spia FreeCooling OFF) -> Vel. 1
                  - conditions:
                      - alias: Spia Free Heating OFF e Spia FreeCooling ON
                        condition: template
                        value_template: >-
                          {{
                          (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'on' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off') }}
                    sequence:
                      - repeat:
                          sequence:
                            - service: input_boolean.turn_on
                              data: {}
                              target:
                                entity_id: >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - service: input_boolean.turn_off
                              data: {}
                              target:
                                entity_id:
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - service: shell_command.vmc_master_velocita_1
                              data: {}
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                1'}}
                    alias: >-
                      Condizioni Sfavorevoli a Velocità 1 se Spia Inquinanti ON
                      e (Spia Free Heating OFF e Spia FreeCooling ON) -> Vel. 1
        alias: >-
          Condizioni Sfavorevoli a Velocità 1 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - alias: Condizioni Sfavorevoli a Velocità 2 se Spia Inquinanti ON
            condition: trigger
            id:
              - PdR Vel. 2 se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità 2 se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_2
                      data: {}
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        2'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 2 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 3 se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità 3 se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_3
                      data: {}
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        3'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 3 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 4 se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità 4 se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: shell_command.vmc_master_velocita_4
                      data: {}
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        4'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 4 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Notturna se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità Notturna se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                    - service: shell_command.vmc_master_notturna
                      data: {}
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Notturna se Spia Congelamento Off e
          Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Free-Cooling se Spia Inquinanti ON
              - >-
                PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta
                Velocità 1 se Spia Inquinanti ON
              - >-
                PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta
                Velocità 1 se Spia Inquinanti ON
            enabled: true
        sequence:
          - choose:
              - conditions:
                  - alias: Verifica Presenze di Allerte Free Cooling
                    condition: template
                    enabled: true
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento in
                      atto)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento in
                      atto, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato)'}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - service: input_boolean.turn_on
                          metadata: {}
                          data: {}
                          target:
                            entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    enabled: true
                alias: Sono presenti Allerte Free Cooling -> Vel. 1
              - conditions:
                  - alias: Verifica Presenze di Allerte Free Heating
                    condition: template
                    enabled: true
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento in
                      atto)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento in
                      atto, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato)'}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: input_boolean.turn_on
                          metadata: {}
                          data: {}
                          target:
                            entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    enabled: true
                alias: Sono presenti Allerte Free Heating -> Vel. 1
              - conditions:
                  - alias: >-
                      Verifica Nessun Avviso su Free Cooling e il Mese
                      Programmato è Free Cooling
                    condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato, Presenza di
                      Inquinanti') and
                      (states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')=='Free
                      Cooling')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Nessun Avviso su Free Cooling e il Mese Programmato è Free
                  Cooling -> Vel. Free Cooling
              - conditions:
                  - alias: >-
                      Verifica Nessun Avviso su Free Heating e il Mese
                      Programmato è Free Heating
                    condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato, Presenza di
                      Inquinanti') and
                      (states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')=='Free
                      Heating')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Nessun Avviso su Free Heating e il Mese Programmato è Free
                  Heating -> Vel. Free Cooling
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling è OFF e il Mese Programmato è Disabilitata
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') and
                      (states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')=='Disabilitata')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          enabled: true
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è OFF e il Mese Programmato è Free Cool./Heat. ovvero
                  Disabilitata  -> Vel. Free Cooling
        alias: >-
          Condizioni Sfavorevoli a Velocità Free Cool./Heat. se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Iperventilazione se Spia Inquinanti ON
        sequence:
          - alias: >-
              Condizioni Sfavorevoli a Velocità Iperventilazione se Spia
              Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - service: input_boolean.turn_on
                      data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                    - service: input_boolean.turn_off
                      data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                    - service: shell_command.vmc_master_iperventilazione
                      data: {}
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Iperventilazione se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: Rip. Vel. 0 No PdR
        sequence:
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                - service: shell_command.vmc_master_velocita_0
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 0 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 1 No PdR
        sequence:
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                - service: shell_command.vmc_master_velocita_1
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    1'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 2 No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_velocita_2
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    2'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 3 No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_velocita_3
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    3'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 4 No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_velocita_4
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    4'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFFF
      - conditions:
          - condition: trigger
            id: Rip. Notturno No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_notturna
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Free Cool./Heat. No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le Spie
                    Free Heating e Free Cooling non vengnono computate] Escluse
                    anche le Spie Inquinanti
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                    until:
                      - alias: >-
                          Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                          Spie Free Heating e Free Cooling non vengnono
                          computate] Esclusa anche Spie Inquinanti
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' }}
                - service: shell_command.vmc_master_freecooling
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id: Rip. Iperventilazione No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_iperventilazione
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 1 No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                    and 
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti ON - Attenzione
          Verifica anche la Spia
          vmc_master_spia_velocita_freecooling_un_solo_avvio se ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 2 No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_velocita_2
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    2'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento
          Off e Spia Delta Temp Off e se  se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 3 No PdR  se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_velocita_3
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    3'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 4 No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_velocita_4
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    4'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Notturno No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_notturna
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Free Cool./Heat. No PdR se Spia Inquinanti ON
        sequence:
          - alias: "Verifica Tipo di Allerte:"
            choose:
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling è OFF
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') }}
                sequence:
                  - repeat:
                      sequence:
                        - alias: >-
                            Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                            Spie Free Heating e Free Cooling non vengnono
                            computate] Escluse anche le Spie Inquinanti
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            until:
                              - alias: >-
                                  Ripeti Finchè Le Spie PdR non Diventano OFF
                                  [N.b. Le Spie Free Heating e Free Cooling non
                                  vengnono computate] Esclusa anche Spie
                                  Inquinanti
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' }}
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è OFF
              - conditions:
                  - condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato, Presenza di
                      Inquinanti')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: >-
                            Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                            Spie Free Heating e Free Cooling non vengnono
                            computate] Escluse anche le Spie Inquinanti
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            until:
                              - alias: >-
                                  Ripeti Finchè Le Spie PdR non Diventano OFF
                                  [N.b. Le Spie Free Heating e Free Cooling non
                                  vengnono computate] Esclusa anche Spie
                                  Inquinanti
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' }}
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: Nessuna Allerta Free Cooling -> Vel. Free Cooling
              - conditions:
                  - condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato, Presenza di
                      Inquinanti')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: >-
                            Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                            Spie Free Heating e Free Cooling non vengnono
                            computate] Escluse anche le Spie Inquinanti
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            until:
                              - alias: >-
                                  Ripeti Finchè Le Spie PdR non Diventano OFF
                                  [N.b. Le Spie Free Heating e Free Cooling non
                                  vengnono computate] Esclusa anche Spie
                                  Inquinanti
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' }}
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: Nessuna Allerta Free Heating -> Vel. Free Cooling
              - conditions:
                  - alias: >-
                      Verifica: Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato, Presenza di Inquinanti) oppure Allerta Free
                      Cooling Programmato (Riscaldamento Arrestato)
                    condition: template
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato)'}}
                sequence:
                  - alias: >-
                      Ripeti Finchè Le Spie PdR Diventano OFF [N.b. Le Spie Free
                      Heating / Cooling non vengono computate] Escluse anche le
                      Spie Inquinanti
                    repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      until:
                        - alias: >-
                            Verifica se Le Spie PdR Diventano OFF [N.b. Le Spie
                            Free Heating / Cooling non vengono computate]
                            Escluse anche le Spie Inquinanti
                          condition: template
                          value_template: >-
                            {{
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                            'off' and

                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                            'off' }}
                alias: >-
                  Presenze Allerte Arresto Free Cooling ->
                  spia_velocita_freecooling_un_solo_avvio=OFF
              - conditions:
                  - alias: >-
                      Verifica: Allerta Free Heating Programmato (Raffrescamento
                      Arrestato, Presenza di Inquinanti) oppure Allerta Free
                      Heating Programmato (Raffrescamento Arrestato)
                    condition: template
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato)'}}
                sequence:
                  - alias: >-
                      Ripeti Finchè Le Spie PdR Diventano OFF [N.b. Le Spie Free
                      Heating / Cooling non vengono computate] Escluse anche le
                      Spie Inquinanti
                    repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      until:
                        - alias: >-
                            Verifica se Le Spie PdR Diventano OFF [N.b. Le Spie
                            Free Heating / Cooling non vengono computate]
                            Escluse anche le Spie Inquinanti
                          condition: template
                          value_template: >-
                            {{
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                            'off' and

                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                            'off' }}
                alias: >-
                  Presenze Allerte Arresto Free Heating ->
                  spia_velocita_freecooling_un_solo_avvio=OFF
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Iperventilazione No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: Ripeti FInchè Le Spie non Diventano OFF
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - alias: Verifica Tutti Le Spie OFF
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - service: shell_command.vmc_master_iperventilazione
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_0
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
          precedentemente Armato ed Attivato -> Velocità 0 se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato e Spia Inquinanti ON"
          - condition: template
            value_template: >-
              {{
              (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
              =='on') and
              states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
              =='off' }}
            alias: Automazione PdR OFF e [almeno una Spia Velocità PdR ON]
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - alias: "Tutte le Spie PdR su OFF "
                          service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                          alias: >-
                            Imposta Velocità 1 a Causa dell'Inquinamento
                            presente
                          enabled: true
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
          precedentemente Armato ed Attivato -> Velocità 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: TeVsTi Free-Heating -> Imposta Velocità 0
        sequence:
          - alias: Lancia il Comando Velocità 0 Finchè la Velocità diventa Velocità 0
            repeat:
              sequence:
                - service: input_boolean.turn_on
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                - service: shell_command.vmc_master_velocita_0
                  data: {}
              until:
                - alias: Controlla se la Velocità è diversa da Velocità 0
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating
          -> Vel. 0 se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - TeVsTi Free-Heating e Spia Inquinanti ON
        sequence:
          - alias: Lancia il Comando Velocità 1 Finchè la Velocità diventa Velocità 1
            repeat:
              sequence:
                - service: input_boolean.turn_on
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                - service: input_boolean.turn_on
                  metadata: {}
                  data: {}
                  target:
                    entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                - service: shell_command.vmc_master_velocita_1
                  data: {}
              until:
                - alias: Controlla se la Velocità è uguale a Velocità 1
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    1'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating
          se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: TeVsTi Free-Cooling -> Imposta Velocità 0
        sequence:
          - alias: Lancia il Comando Velocità 0 Finchè la Velocità diventa Velocità 0
            repeat:
              sequence:
                - service: input_boolean.turn_on
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                - service: shell_command.vmc_master_velocita_0
                  data: {}
              until:
                - alias: Controlla se la Velocità è diversa da Velocità 0
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling
          -> Vel. 0  se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - TeVsTi Free-Cooling e Spia Inquinanti ON
        sequence:
          - alias: Lancia il Comando Velocità 1 Finchè la Velocità diventa Velocità 1
            repeat:
              sequence:
                - service: input_boolean.turn_on
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                - service: input_boolean.turn_on
                  metadata: {}
                  data: {}
                  target:
                    entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                - service: shell_command.vmc_master_velocita_1
                  data: {}
              until:
                - alias: Controlla se la Velocità è uguale a Velocità 1
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    1' and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling
          se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: "Rip. Free Cooling No TeVsTi "
        sequence:
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                - alias: Ripeti FInchè Le Spie Inquinamento non Diventano OFF
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                            - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                    until:
                      - alias: Verifica Tutti Le Spie OFF
                        condition: template
                        value_template: >-
                          {{ states('input_boolean.vmc_master_spia_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'off' }}
                - service: shell_command.vmc_master_freecooling
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id: "Rip. Free Heating No TeVsTi "
        sequence:
          - alias: >-
              Lancia il Comando Velocità 0 Finchè la Velocità diventa Velocità
              FreeCooling
            repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                - alias: Ripeti FInchè Le Spie Inquinamento non Diventano OFF
                  repeat:
                    sequence:
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                            - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                    until:
                      - alias: Verifica Tutti Le Spie OFF
                        condition: template
                        value_template: >-
                          {{ states('input_boolean.vmc_master_spia_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'off' }}
                - service: shell_command.vmc_master_freecooling
                  data: {}
              until:
                - alias: Controlla se la Velocità è diversa da Velocità 0
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se se
          Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - Rip. Free Heating No TeVsTi e Spia Inquinanti ON
        sequence:
          - alias: >-
              Lancia il Comando Velocità Free Heating Finchè la Velocità diventa
              Velocità Free Heating
            repeat:
              sequence:
                - alias: Ripeti Finchè Le Spie seguono le Regole
                  repeat:
                    sequence:
                      - service: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                    until:
                      - condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'on' }}
                - service: shell_command.vmc_master_freecooling
                  data: {}
              until:
                - alias: Controlla se la Velocità è uguale a Velocità Free Heating
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se Spia
          Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Free Cooling No TeVsTi e Spia Inquinanti ON
        sequence:
          - alias: >-
              Lancia il Comando Velocità Free Cooling Finchè la Velocità diventa
              Velocità Free Cooling
            repeat:
              sequence:
                - alias: Ripeti Finchè Le Spie seguono le Regole
                  repeat:
                    sequence:
                      - service: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - service: input_boolean.turn_off
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    until:
                      - condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'on' }}
                - service: shell_command.vmc_master_freecooling
                  data: {}
              until:
                - alias: Controlla se la Velocità è uguale a Velocità Free Cooling
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
          Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - >-
                Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
                precedentemente Armato
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - alias: Imposta Velocità 0
                          service: shell_command.vmc_master_velocita_0
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and 
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                            and
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating
                    enabled: true
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
          precedentemente Armato -> Vel. 0 se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating precedentemente Armato e Spia Inquinanti ON"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: >-
                      Lancia il Comando Velocità 0 Finchè la Velocità diventa
                      Velocità 1
                    repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                          alias: >-
                            Imposta Velocità 1 a Causa dell'Inquinamento
                            presente
                      until:
                        - alias: Controlla se la Velocità è uguale a Velocità 1
                          condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
          precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - >-
                Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
                precedentemente Armato
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - alias: Imposta Velocità 0
                          service: shell_command.vmc_master_velocita_0
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and 
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                            and
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling
                    enabled: true
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
          precedentemente Armato -> Vel. 0 se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato e Spia Inquinanti ON"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: >-
                      Lancia il Comando Velocità 0 Finchè la Velocità diventa
                      Velocità 1
                    repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                          alias: >-
                            Imposta Velocità 1 a Causa dell'Inquinamento
                            presente
                      until:
                        - alias: Controlla se la Velocità è uguale a Velocità 1
                          condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
          precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 0
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 0
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
          - service: shell_command.vmc_master_velocita_0
            data: {}
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 1
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_1
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 1
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
          - service: shell_command.vmc_master_velocita_1
            data: {}
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 2
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_2
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 2
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            enabled: true
          - service: shell_command.vmc_master_velocita_2
            data: {}
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 3
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_3
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 3
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
          - service: shell_command.vmc_master_velocita_3
            data: {}
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 4
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_4
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 4
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
          - service: shell_command.vmc_master_velocita_4
            data: {}
      - conditions:
          - condition: trigger
            id: Black-Out Notturna
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_notturna
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
      - conditions:
          - condition: trigger
            id: Black-Out Off Notturna
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
          - service: shell_command.vmc_master_notturna
            data: {}
      - conditions:
          - condition: trigger
            id: Black-Out Iperventilazione
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_iperventilazione
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
      - conditions:
          - condition: trigger
            id: Black-Out Off Iperventilazione
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
          - service: shell_command.vmc_master_iperventilazione
            data: {}
      - conditions:
          - condition: trigger
            id: Black-Out Free Cool./Heat.
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_freecooling
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
      - conditions:
          - condition: trigger
            id: Black-Out Off Free Cool./Heat.
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
          - service: shell_command.vmc_master_freecooling
            data: {}
      - conditions:
          - condition: trigger
            id: 1° Lunedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Lunedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Lunedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Lunedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Martedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_1
          - service: script.vmc_master_calendario_fascia_1_on
            metadata: {}
            data: {}
      - conditions:
          - condition: trigger
            id: 1° Martedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Martedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Martedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Mercoledì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Mercoledì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Mercoledì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Mercoledì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Giovedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_1
          - service: script.vmc_master_calendario_fascia_1_on
            metadata: {}
            data: {}
      - conditions:
          - condition: trigger
            id: 1° Giovedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Giovedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Giovedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Venerdì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Venerdì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Venerdì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Venerdì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Sabato On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Sabato Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Sabato On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Sabato Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Domenica On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_1
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Domenica Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_1
          - service: script.vmc_master_calendario_fascia_1_o_2_off
            metadata: {}
            data: {}
      - conditions:
          - condition: trigger
            id: 2° Domenica On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Domenica Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_2
          - service: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: Calendario Off tra Fascie
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - service: input_boolean.turn_off
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_calendario_lunedi_1
                        - input_boolean.vmc_master_spia_calendario_lunedi_2
                        - input_boolean.vmc_master_spia_calendario_martedi_1
                        - input_boolean.vmc_master_spia_calendario_martedi_2
                        - input_boolean.vmc_master_spia_calendario_mercoledi_1
                        - input_boolean.vmc_master_spia_calendario_mercoledi_2
                        - input_boolean.vmc_master_spia_calendario_giovedi_1
                        - input_boolean.vmc_master_spia_calendario_giovedi_2
                        - input_boolean.vmc_master_spia_calendario_venerdi_1
                        - input_boolean.vmc_master_spia_calendario_venerdi_2
                        - input_boolean.vmc_master_spia_calendario_sabato_1
                        - input_boolean.vmc_master_spia_calendario_sabato_2
                        - input_boolean.vmc_master_spia_calendario_domenica_1
                        - input_boolean.vmc_master_spia_calendario_domenica_2
                        - input_boolean.vmc_master_spia_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  - repeat:
                      sequence:
                        - service: shell_command.vmc_master_velocita_0
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Calendario ,
          precedentemente Armato ed Attivato tra le Fascie del Calendario ->
          Velocità 0 se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - Calendario Off tra Fascie e Spia Inquinanti ON
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: "Tutte le Spie dei Giorni del Calendario su OFF "
                    service: input_boolean.turn_off
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_calendario_lunedi_1
                        - input_boolean.vmc_master_spia_calendario_lunedi_2
                        - input_boolean.vmc_master_spia_calendario_martedi_1
                        - input_boolean.vmc_master_spia_calendario_martedi_2
                        - input_boolean.vmc_master_spia_calendario_mercoledi_1
                        - input_boolean.vmc_master_spia_calendario_mercoledi_2
                        - input_boolean.vmc_master_spia_calendario_giovedi_1
                        - input_boolean.vmc_master_spia_calendario_giovedi_2
                        - input_boolean.vmc_master_spia_calendario_venerdi_1
                        - input_boolean.vmc_master_spia_calendario_venerdi_2
                        - input_boolean.vmc_master_spia_calendario_sabato_1
                        - input_boolean.vmc_master_spia_calendario_sabato_2
                        - input_boolean.vmc_master_spia_calendario_domenica_1
                        - input_boolean.vmc_master_spia_calendario_domenica_2
                        - input_boolean.vmc_master_spia_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                  - service: input_boolean.turn_on
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - >-
                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                        - input_boolean.vmc_master_spia_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                  - repeat:
                      sequence:
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    alias: Imposta Velocità 1 a Causa dell'Inquinamento presente
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Calendario ,
          precedentemente Armato ed Attivato tra le Fascie del Calendario ->
          Velocità 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Cambio Nome VMC
        sequence:
          - service: shell_command.vmc_master_rimuovi_caratteri_di_ritorno
            data: {}
          - alias: Chiama il Servizio per Cambiare nome alla VMC
            service: shell_command.vmc_master_cambia_nome
            data: {}
          - delay:
              hours: 0
              minutes: 0
              seconds: 4
              milliseconds: 0
          - service: homeassistant.update_entity
            data: {}
            target:
              entity_id:
                - sensor.vmc_master_nome
          - service: input_text.set_value
            data:
              value: ""
            target:
              entity_id: input_text.vmc_master_nome_da_inserire
        alias: Rinomina VMC
      - conditions:
          - condition: trigger
            id:
              - Riscrivi IP
        sequence:
          - alias: Verifica se l'IP è Valido o Meno
            choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{ (states('sensor.vmc_master_verifica_ip_inserito') !=
                      "IP non Valido") }}
                sequence:
                  - service: shell_command.vmc_master_rimuovi_caratteri_di_ritorno
                    data: {}
                  - service: shell_command.vmc_master_aggiorna_indirizzo_ip
                    data: {}
                  - delay:
                      hours: 0
                      minutes: 0
                      seconds: 2
                      milliseconds: 0
                  - service: homeassistant.restart
                    data: {}
                alias: IP Inserito Valido
              - conditions:
                  - condition: template
                    value_template: >-
                      {{ (states('sensor.vmc_master_verifica_ip_inserito') ==
                      "IP non Valido") }}
                sequence:
                  - service: input_text.set_value
                    data:
                      value: ""
                    target:
                      entity_id: input_text.vmc_master_ip_insert
                alias: IP Inserito NON Valido
        alias: Cambio Indirizzo IP della VMC (Riavvio di H.A.)
      - conditions:
          - condition: trigger
            id: Spia Avvisi On
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi_spia
        alias: Spia Avvisi On
      - conditions:
          - condition: trigger
            id: Spia Avvisi Off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi_spia
        alias: Spia Avvisi Off
      - conditions:
          - condition: trigger
            id:
              - Repository Update ON
            enabled: true
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id: input_boolean.vmc_master_popup_versione_corrente_vs_repository
          - service: notify.persistent_notification
            data:
              message: >-
                Una nuova revisione è stata rilasciata
                [Link](https://github.com/DanRobo76/VMC-HELTY-FLOW)
              title: AGGIORNAMENTO SUL REPOSITORY VMC HELTY FLOW
        alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - ON
      - conditions:
          - condition: trigger
            id:
              - Repository Update OFF
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_popup_versione_corrente_vs_repository
        alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - OFF
      - conditions:
          - condition: trigger
            id:
              - inquinanti_co2_voc_on
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_co2_o_voc
          - choose:
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 1 o Spia Inquinanti su
                      Velocità 1
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 1 o Spia Inquinanti su
                  Velocità 1
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 2 o Spia Inquinanti su
                      Velocità 2
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - service: input_boolean.turn_on
                                metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_2
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            2'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 2 o Spia Inquinanti su
                  Velocità 2
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 3 o Spia Inquinanti su
                      Velocità 3
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - service: input_boolean.turn_on
                                metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_3
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            3'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 3 o Spia Inquinanti su
                  Velocità 3
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 4 o Spia Inquinanti su
                      Velocità 4
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - service: input_boolean.turn_on
                                metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_4
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            4'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 4 o Spia Inquinanti su
                  Velocità 4
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Notturna o Spia Inquinanti
                      su Velocità Notturna
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - service: input_boolean.turn_on
                                metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - service: shell_command.vmc_master_notturna
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Notturna o Spia Inquinanti
                  su Velocità Notturna
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Iperventilazione o Spia
                      Inquinanti su Velocità Iperventilazione
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - service: input_boolean.turn_on
                                metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - service: shell_command.vmc_master_iperventilazione
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Iperventilazione o Spia
                  Inquinanti su Velocità Iperventilazione
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Free Heating/Cooling o Spia
                      Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                      Heatin OFF e SPia Free Cooling OFF
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')
                      and (
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') ) }}
                sequence:
                  - repeat:
                      sequence:
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Heating/Cooling o
                  Spia Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                  Heatin OFF e SPia Free Cooling OFF
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Free Heating/Cooling o Spia
                      Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                      Heatin ON oppure SPia Free Cooling ON
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')
                      and (
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on') ) }}
                sequence:
                  - repeat:
                      sequence:
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Heating/Cooling o
                  Spia Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                  Heatin ON oppure SPia Free Cooling ON
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                      (FreeHeating Programmato Off e FreeCooling Programmato
                      Off)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'}}
                sequence:
                  - service: input_boolean.turn_off
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                    enabled: true
                alias: >-
                  Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                  (FreeHeating Programmato Off e FreeCooling Programmato Off)
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                      (FreeHeating Programmato su On o FreeCooling Programmato
                      su On)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on')
                      }}
                sequence:
                  - service: input_boolean.turn_off
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                alias: >-
                  Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                  (FreeHeating Programmato su On o FreeCooling Programmato su
                  On)
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR On  su qualsiasi Velocità
                      e (FreeHeating Programmato su Off e FreeCooling
                      Programmato su Off)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                      != 'Velocità 0' and
                      (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'on') and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
                      == 'off') }}
                sequence:
                  - service: input_boolean.turn_off
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                alias: >-
                  Velocità diversa da 0 e con PdR On  su qualsiasi Velocità e
                  (FreeHeating Programmato su Off e FreeCooling Programmato su
                  Off)
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR On  su qualsiasi Velocità
                      e (FreeHeating Programmato su On o FreeCooling Programmato
                      su On)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                      != 'Velocità 0' and
                      (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'on') and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
                      == 'on') }}
                sequence:
                  - service: input_boolean.turn_off
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                alias: >-
                  Velocità diversa da 0 e con PdR On  su qualsiasi Velocità e
                  (FreeHeating Programmato su On o FreeCooling Programmato su
                  On)
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                      Programmato su Off e FreeCooling Programmato su Off) e
                      Velocità !=Free Cool./Heat.
                    condition: template
                    enabled: true
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!="Free
                      Cool./Heat."}}
                  - condition: template
                    value_template: >-
                      {{(states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'off')}}
                    alias: >-
                      Spia Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free
                      Heating Inquinamento = Off
                    enabled: true
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          enabled: true
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                  Programmato su Off e FreeCooling Programmato su Off) e Spia
                  Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free Heating
                  Inquinamento = Off
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                      Programmato su On o FreeCooling Programmato su On)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on')}}
                  - condition: template
                    value_template: >-
                      {{(states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'off')}}
                    alias: >-
                      Spia Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free
                      Heating Inquinamento = Off
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          metadata: {}
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                  Programmato su On o FreeCooling Programmato su On) e Spia
                  Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free Heating
                  Inquinamento = Off
        alias: >-
          Attivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati se Spia
          Congelamento Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - inquinanti_co2_voc_off
        sequence:
          - service: input_boolean.turn_off
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_co2_o_voc
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                      or
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'}}
                    enabled: true
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id:
                                      - input_boolean.vmc_master_spia_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                - service: shell_command.vmc_master_velocita_0
                                  data: {}
                                - delay:
                                    hours: 0
                                    minutes: 0
                                    seconds: 4
                                    milliseconds: 0
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    0'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id:
                                - input_boolean.vmc_master_spia_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: >-
                  vmc_master_spia_velocita_0_co2_o_voc=on o
                  vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0=on
              - conditions:
                  - alias: >-
                      Verifica che la Spia Inquinamento Velocità 1 è ON e Spia
                      Partenza e Ritorno a Velocità 0 sia OFF e
                      vmc_master_spia_velocita_1_co2_o_voc_pdr=OFF e Spia
                      FreeHeating e Free Cooling siano OFF
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                      and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                  enabled: true
                                - service: shell_command.vmc_master_velocita_1
                                  data: {}
                              until:
                                - condition: template
                                  value_template: "      {{ states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità 1'}}"
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            enabled: true
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 1
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - service: shell_command.vmc_master_velocita_2
                                  data: {}
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    2'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 2
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - service: shell_command.vmc_master_velocita_3
                                  data: {}
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    3'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 3
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - service: shell_command.vmc_master_velocita_4
                                  data: {}
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    4'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 4
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - service: shell_command.vmc_master_notturna
                                  data: {}
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità Notturna
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - service: shell_command.vmc_master_iperventilazione
                                  data: {}
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità Iperventilazione
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                      or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on')}}
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - service: input_boolean.turn_off
                                  data: {}
                                  target:
                                    entity_id:
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - service: shell_command.vmc_master_freecooling
                                  data: {}
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                                    Cooling'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - service: input_boolean.turn_off
                            data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità Free Heating/Cooling
        alias: >-
          Disattivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati se
          se Spia Congelamento Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_0_inquinanti_co2_voc
        sequence:
          - choose:
              - conditions:
                  - condition: and
                    conditions:
                      - alias: Verifica che Tutte le Spie PdR siano su OFF
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                          and 
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                          }}
                      - condition: template
                        value_template: >-
                          {{
                          (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'off')}}
                        alias: Verifica che Tutte le Spie Inquinamento siano su OFF
                      - alias: >-
                          Verifica che non siano attive le Spie Free Heating e
                          Free Cooling e
                          vmc_master_spia_velocita_1_co2_o_voc_pdr OFF e Spia
                          Velocità PdR Free Heating/Cooling OFF
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                          'off' and (
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                          ) }}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica che non siano attive le Spie Free Heating e Free
                  Cooling e vmc_master_spia_velocita_1_co2_o_voc_pdr OFF e Spia
                  Velocità PdR Free Heating/Cooling OFF
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          Verifica a Velocità 0 e Almeno una Spia Inquinamento
                          ON e Spia un solo Avvio (FreeCooling o Heating) OFF
                        condition: template
                        value_template: >-
                          {{(
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'on' ) and
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          0' and
                          (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off')}}
                      - alias: Verifica che Tutte le Spie PdR siano su OFF
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                          and 
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                          }}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica a Velocità 0 e Almeno una Spia Inquinamento ON e Spia
                  un solo Avvio (FreeCooling o Heating) OFF e Tutte le Spie PdR
                  OFF
              - conditions:
                  - alias: >-
                      Verifica Velocità 0 e Almeno una Spia Inquinamento ON e
                      (Spia un solo Avvio FreeCooling o Heating ON)
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'on' ) and
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and
                      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')
                      or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'))}}
                    enabled: true
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica Velocità 0 e Almeno una Spia Inquinamento ON e (Spia
                  un solo Avvio FreeCooling o Heating ON)
              - conditions:
                  - alias: >-
                      Verifica Velocità 0 e Tutte le Spia Inquinamento OFF e
                      (Spia un solo Avvio FreeCooling o Heating ON)
                    condition: template
                    value_template: >-
                      {{(
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'off' ) and
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and
                      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')
                      or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'))
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica Velocità 0 e Tutte le Spia Inquinamento OFF e (Spia
                  un solo Avvio FreeCooling o Heating ON)
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 1 ON e Spia Inquinanti
                      su Velocità 1 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 1 ON e Spia Inquinanti su
                  Velocità 1 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 1 OFF e Spia
                      Inquinanti su Velocità 1 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 1 OFF e Spia Inquinanti su
                  Velocità 1 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 2 ON e Spia Inquinanti
                      su Velocità 2 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 2 ON e Spia Inquinanti su
                  Velocità 2 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 2 OFF e Spia
                      Inquinanti su Velocità 2 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                        - service: shell_command.vmc_master_velocita_2
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            2'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 2 OFF e Spia Inquinanti su
                  Velocità 2 ON -> Velocità 2
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 3 ON e Spia Inquinanti
                      su Velocità 3 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 3 ON e Spia Inquinanti su
                  Velocità 3 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 3 OFF e Spia
                      Inquinanti su Velocità 3 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                        - service: shell_command.vmc_master_velocita_3
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            3'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 3 OFF e Spia Inquinanti su
                  Velocità 3 ON -> Velocità 3
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 4 ON e Spia Inquinanti
                      su Velocità 4 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 4 ON e Spia Inquinanti su
                  Velocità 4 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 4 OFF e Spia
                      Inquinanti su Velocità 4 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                        - service: shell_command.vmc_master_velocita_4
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            4'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 4 OFF e Spia Inquinanti su
                  Velocità 4 ON -> Velocità 4
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Notturna ON e Spia
                      Inquinanti su Velocità Notturna ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Notturna ON e Spia
                  Inquinanti su Velocità Notturna ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Notturna OFF e Spia
                      Inquinanti su Velocità Notturna ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                        - service: shell_command.vmc_master_notturna
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Notturna OFF e Spia
                  Inquinanti su Velocità Notturna ON -> Velocità Notturna
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Iperventilazione ON e
                      Spia Inquinanti su Velocità Iperventilazione ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Iperventilazione ON e Spia
                  Inquinanti su Velocità Iperventilazione ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Iperventilazione OFF e
                      Spia Inquinanti su Velocità IPerventilazione ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - service: shell_command.vmc_master_iperventilazione
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Iperventilazione OFF e
                  Spia Inquinanti su Velocità Iperventilazione ON -> Velocità
                  Iperventilazione
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Free Cooling ON e Spia
                      Inquinanti su Velocità Free Cooling ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Cooling ON e Spia
                  Inquinanti su Velocità Free Cooling ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Free Cooling OFF e
                      Spia Inquinanti su Velocità Free Cooling ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Cooling OFF e Spia
                  Inquinanti su Velocità Free Cooling ON -> Velocità Free
                  Cooling
        alias: >-
          Spia Velocità 0 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_1_inquinanti_co2_voc
        sequence:
          - alias: 4 Casistiche
            choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on'}}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            }}
                  - service: shell_command.vmc_master_velocita_1
                    metadata: {}
                    data: {}
                alias: vmc_master_spia_velocita_1_co2_o_voc_pdr ON
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling/Heating è OFF e Spia FreeCooling PdR ON
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'off') and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      )}}
                sequence:
                  - service: input_boolean.turn_on
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                    enabled: true
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          enabled: true
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'}}
                  - service: shell_command.vmc_master_freecooling
                    metadata: {}
                    data: {}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling/Heating è OFF e Spia FreeCooling PdR ON
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è ON oppure la Spia1°
                      Avvio Free Cooling è ON e
                      vmc_master_spia_velocita_1_co2_o_voc_pdr OFF
                    condition: template
                    value_template: >-
                      {{
                      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on')) and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'off'}}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                  - service: shell_command.vmc_master_velocita_1
                    metadata: {}
                    data: {}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è ON oppure la Spia1° Avvio
                  Free Cooling è ON e vmc_master_spia_velocita_1_co2_o_voc_pdr
                  OFF
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling/Heating è OFF e Spia FreeCooling PdR OFF e
                      vmc_master_spia_velocita_1_co2_o_voc_pdr' OFF
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'off') and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off')}}
                sequence:
                  - service: input_boolean.turn_on
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                    enabled: true
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                        - service: shell_command.vmc_master_velocita_1
                          metadata: {}
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            }}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling/Heating è OFF e Spia FreeCooling PdR OFF e
                  vmc_master_spia_velocita_1_co2_o_voc_pdr' OFF
        alias: >-
          Spia Velocità 1 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_2_inquinanti_co2_voc
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_co2_o_voc
                - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità 2 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_3_inquinanti_co2_voc
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità 3 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_4_inquinanti_co2_voc
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità 4 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_notturna_inquinanti_co2_voc
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità Notturna CO₂ e/o VOC se Spia Congelamento Off e Spia
          Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_iperventilazione_inquinanti_co2_voc
        sequence:
          - service: input_boolean.turn_on
            data: {}
            target:
              entity_id:
                - >-
                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
          - repeat:
              sequence:
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità iperventilazione CO₂ e/o VOC se Spia Congelamento Off e
          Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_freecooling_inquinanti_co2_voc
        sequence:
          - alias: Spie 1° Avvio Free Heating e 1° Avvio Free Cooling sono OFF
            choose:
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling è OFF
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off'}}
                sequence:
                  - service: input_boolean.turn_on
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                    enabled: true
                  - repeat:
                      sequence:
                        - repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                enabled: true
                            until:
                              - condition: template
                                value_template: >-
                                  {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è OFF
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off')}}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                  - service: shell_command.vmc_master_velocita_1
                    metadata: {}
                    data: {}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è ON
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on') }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                    enabled: true
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                    enabled: true
                  - service: shell_command.vmc_master_velocita_1
                    metadata: {}
                    data: {}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è ON oppure la Spia1° Avvio
                  Free Cooling è OFF
        alias: >-
          Spia Velocità Free Heating/Cooling CO₂ e/o VOC se Spia Congelamento
          Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: >-
                      Lancia il Comando Velocità 0 Finchè la Velocità diventa
                      Velocità 0
                    repeat:
                      sequence:
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - service: shell_command.vmc_master_velocita_0
                          data: {}
                      until:
                        - alias: Controlla se la Velocità è diversa da Velocità 0
                          condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato -> Tutte le Spie CO2 e/o VOC OFF -> Vel. 0 "
      - conditions:
          - condition: or
            conditions:
              - condition: trigger
                id:
                  - Congelamento ON
              - condition: trigger
                id:
                  - spia_velocita_0_congelamento
              - condition: trigger
                id:
                  - spia_velocita_1_congelamento
              - condition: trigger
                id:
                  - spia_velocita_2_congelamento
              - condition: trigger
                id:
                  - spia_velocita_3_congelamento
              - condition: trigger
                id:
                  - spia_velocita_4_congelamento
              - condition: trigger
                id:
                  - spia_velocita_iperventilazione_congelamento
              - condition: trigger
                id:
                  - spia_velocita_notturna_congelamento
              - condition: trigger
                id:
                  - spia_velocita_Free Cooling_congelamento
        sequence:
          - service: input_boolean.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: >-
                input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
            alias: Attivazione Spia Congelamento ≤ -18 [°C] Temp. Esterna
          - alias: >-
              Attivazione Velocità Spia Congelamento in Funzione della Tipologia
              di Velocità
            choose:
              - conditions:
                  - condition: or
                    conditions:
                      - condition: trigger
                        id:
                          - spia_velocita_0_congelamento
                        alias: Velocità 0
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          0'}}
                sequence:
                  - alias: >-
                      Verifica se mettere la Spia Congelamento Velocità 0 su ON
                      o su OFF in funzione della Velocità Precedentemente
                      impostata
                    if:
                      - condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                          'off'}}
                        alias: Tutte le Spie Congelamento sono Off
                    then:
                      - service: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_velocita_0_congelamento
                    else:
                      - service: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_congelamento
                        enabled: true
                alias: Velocità 0
              - conditions:
                  - alias: Velocità 1
                    condition: trigger
                    id:
                      - spia_velocita_1_congelamento
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_congelamento
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                alias: Velocità 1
              - conditions:
                  - alias: Velocità 2
                    condition: trigger
                    id:
                      - spia_velocita_2_congelamento
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_2_congelamento
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                alias: Velocità 2
              - conditions:
                  - alias: Velocità 3
                    condition: trigger
                    id:
                      - spia_velocita_3_congelamento
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_3_congelamento
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                alias: Velocità 3
              - conditions:
                  - alias: Velocità 4
                    condition: trigger
                    id:
                      - spia_velocita_4_congelamento
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_4_congelamento
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                alias: Velocità 4
              - conditions:
                  - alias: Velocità Iperventilazione
                    condition: trigger
                    id:
                      - spia_velocita_iperventilazione_congelamento
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                alias: Velocità Iperventilazione
              - conditions:
                  - alias: Velocità Notturna
                    condition: trigger
                    id:
                      - spia_velocita_notturna_congelamento
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_notturna_congelamento
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                alias: Velocità Notturna
              - conditions:
                  - alias: Velocità Free Cooling/Free Heating
                    condition: trigger
                    id:
                      - spia_velocita_Free Cooling_congelamento
                sequence:
                  - service: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                alias: Velocità FreeCooling/FreeHeating
          - repeat:
              sequence:
                - service: shell_command.vmc_master_velocita_0
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: Congelamento ON
      - conditions:
          - condition: trigger
            id:
              - Congelamento OFF
        sequence:
          - alias: Ripristino Velocità
            choose:
              - conditions:
                  - alias: Se Spia Velocità 0 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_0
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Spia Velocità 0 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 1 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: Spia Velocità 1 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 2 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_2
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            2'}}
                alias: Spia Velocità 2 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 3 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_3
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            3'}}
                alias: Spia Velocità 3 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 4 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_velocita_4
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            4'}}
                alias: Spia Velocità 4 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità Iperventilazione per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_iperventilazione
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                alias: Spia Velocità Iperventilazione per Congelamento
              - conditions:
                  - alias: Se Spia Velocità Notturna per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_notturna
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                alias: Spia Velocità Notturna per Congelamento
              - conditions:
                  - alias: >-
                      Se Spia Velocità FreeCooling/FreeHeating per Congelamento
                      ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - service: input_boolean.turn_off
                                data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - service: shell_command.vmc_master_freecooling
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: Spia Velocità FreeCooling/FreeHeating per Congelamento
        alias: Congelamento OFF
      - conditions:
          - condition: trigger
            id:
              - >-
                Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON -
                Inquinanti OFF
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'}}
                    alias: >-
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      OFF e
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                      ON
                sequence:
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  OFF e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  ON
              - conditions:
                  - alias: >-
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      ON e
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                      OFF
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                sequence:
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  OFF
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto!= "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          == "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          OFF e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'}}
                      - alias: >-
                          Inquinante Vel. 1 ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'}}
                sequence:
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  OFF e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  ON con PdR OFF e vmc_master_spia_velocita_1_co2_o_voc=ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio='on'
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto!= "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          == "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          OFF
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                      - alias: >-
                          Inquinante Vel. 1 ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'}}
                sequence:
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  OFF con PdR OFF e vmc_master_spia_velocita_1_co2_o_voc=ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio='on''
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto!= "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          != "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                        alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          OFF
                sequence:
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  OFF con PdR OFF
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto== "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          == "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          OFF e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'}}
                sequence:
                  - service: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  OFF e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  ON con PdR ON
        alias: >-
          Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON e se Spia
          Inquinanti OFF e se Spia Congelamento Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 0 con Spia FreeHeating On -> Imposta Velocità 0
        sequence:
          - repeat:
              sequence:
                - service: input_boolean.turn_on
                  metadata: {}
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                - service: shell_command.vmc_master_velocita_0
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON se
          Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
          oppure OFF [Caso Velocità Free Heating]
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 0 con Spia FreeCooling On -> Imposta Velocità 0
        sequence:
          - repeat:
              sequence:
                - service: input_boolean.turn_on
                  metadata: {}
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                - service: input_boolean.turn_off
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                - service: shell_command.vmc_master_velocita_0
                  data: {}
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON se
          Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
          oppure OFF [Caso Velocità Free Cooling]
      - conditions:
          - condition: trigger
            id:
              - >-
                PdR Vel. 0 con Spia FreeHeating On e Inquinanti Vel. 1 ON  ->
                Imposta Velocità 1
        sequence:
          - choose:
              - conditions:
                  - alias: VERIFICA SPIA ATTIVAZIONE FREE HEATING OFF
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE HEATING OFF
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                      }}
                    alias: VERIFICA SPIA ATTIVAZIONE FREE HEATING ON
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE HEATING ON
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
          Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp
          Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Heating]
      - conditions:
          - condition: trigger
            id:
              - >-
                PdR Vel. 0 con Spia FreeCooling On e Inquinanti Vel. 1 ON  ->
                Imposta Velocità 1
        sequence:
          - choose:
              - conditions:
                  - alias: VERIFICA SPIA ATTIVAZIONE FREE COOLING ON
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE COOLING ON
              - conditions:
                  - alias: VERIFICA SPIA ATTIVAZIONE FREE COOLING OFF
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - service: input_boolean.turn_on
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - service: input_boolean.turn_off
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - service: shell_command.vmc_master_velocita_1
                          data: {}
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE COOLING OFF
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
          Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp
          Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Cooling]
mode: restart
