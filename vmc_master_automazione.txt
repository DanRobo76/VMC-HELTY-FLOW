###########################################################################################################################################################################################################################
#                                                                                                                                                                                                                         #
#                                                          AUTOMAZIONE VMC HELTY FLOW PLUS RELEASE [VER. 6.0.0]                                                                                                           #
#                                                                                                                                                                                                                         #
# SVILUPPATO DA ING. DANILO ROBOTTI, ALLE PRIME ARMI CON HOME ASSISTANT :)                                                                                                                                                #
#                                                                                                                                                                                                                         #
# LICENZA D'USO – USO PERSONALE NON COMMERCIALE                                                                                                                                                                           #
#                                                                                                                                                                                                                         #
# COPYRIGHT © ING. DANILO ROBOTTI                                                                                                                                                                                         #
#                                                                                                                                                                                                                         #
# TUTTI I DIRITTI RISERVATI.                                                                                                                                                                                              #
#                                                                                                                                                                                                                         #
# QUESTA LICENZA SI APPLICA A TUTTE LE VERSIONI DEL PRESENTE SOFTWARE CHE INCLUDE I SEGUENTI FILES:                                                                                                                       #
#   - VMC_CLONA.YAML                                                                                                                                                                                                      #
#   - VMC_CLONA_SCHEDA_MANUALE_INTERFACCIA.TXT                                                                                                                                                                            #
#   - VMC_MASTER.YAML                                                                                                                                                                                                     #
#   - VMC_MASTER_AUTOMAZIONE.TXT                                                                                                                                                                                          #
#   - VMC_MASTER_SCHEDA_MANUALE_INTERFACCIA.TXT                                                                                                                                                                           #
#   - VMC_MASTER_SCRIPT_CAMBIO_IP.SH                                                                                                                                                                                      #
#   - VMC_MASTER_SCRIPT_CAMBIO_NOME.SH                                                                                                                                                                                    #
#   - VMC_SCRIPT_CLONA.SH                                                                                                                                                                                                 #
# A PARTIRE DALLA PRIMA VERSIONE PUBBLICATA E SUCCESSIVE                                                                                                                                                                  #
#                                                                                                                                                                                                                         #
# È CONCESSO:                                                                                                                                                                                                             #
#  - L'UTILIZZO DEL SOFTWARE ESCLUSIVAMENTE PER FINI PERSONALI E NON COMMERCIALI                                                                                                                                          #
#  - LA DISTRIBUZIONE LIBERA, PURCHÉ VENGA MANTENUTO IL PRESENTE TESTO DI LICENZA E SIA RISPETTATO IL DIVIETO D'USO COMMERCIALE                                                                                           #
#                                                                                                                                                                                                                         #
# QUALSIASI USO NON AUTORIZZATO AD USO COMMERCIALE COSTITUISCE VIOLAZIONE DEL DIRITTO D'AUTORE E POTRÀ ESSERE PERSEGUITO LEGALMENTE                                                                                       #
#                                                                                                                                                                                                                         #
# PER RICHIESTE DI LICENZA COMMERCIALE O USI PARTICOLARI, CONTATTARE L’AUTORE: danilo.robotti@gmail.com                                                                                                                   #
#                                                                                                                                                                                                                         #
# VERSIONE LICENZA: 1.0                                                                                                                                                                                                   #
# DATA: 30 APRILE 2025                                                                                                                                                                                                    #
#                                                                                                                                                                                                                         #
# Esonero di Responsabilità                                                                                                                                                                                               #
# In nessun caso lo sviluppatore sarà responsabile di danneggiamenti diretti, indiretti o conseguenti, correlati a difetti del presente software                                                                          #
# L’usufruitore ha l’onere e la responsabilità della scelta, dell’installazione, dell’uso e della gestione del software al fine del raggiungimento del risultato prefissatosi                                             #
#                                                                                                                                                                                                                         #
###########################################################################################################################################################################################################################
alias: Automazione VMC Master
description: >-
  Automazione VMC Master Release v.6.0.0:

  - Invia Comandi alla VMC leggendone i valori Contenuti;

  - Avvisa l'utente tramite notifica sul Dispositivo Mobile selezionato tra i
  disponibili nel sistema di Home Assistant (H.A.), in caso di Avvio, Arresto,
  Errori o cambio filtro della VMC;

  - Permette di selezionare le entità di Lettura Anidride Carbonica disponibili
  nel sistema di Home Assistant (H.A.) oltre allo stesso integrato nella VMC;

  - Permette di selezionare le entità di Temperatura e Umidità disponibili nel
  sistema di Home Assistant (H.A.), includendo anche le entità provenienti da
  fonti Meteo, per ottenere una maggiore precisione e affidabilità rispetto ai
  sensori di Temperatura e Umidità integrati nella VMC;

  - Permette lo spegnimento Automatico, in funzione della Temperatura Esterna se
  ≤ -18 [°C] e successiva ripresa;

  - Permette l'accensione e lo spegnimento Automatico, in funzione degli
  inquinanti (CO₂ e VOC);

  - Permette l'accensione e lo spegnimento Automatico, in funzione dei Parametri
  Ambientali (Lettura del Punto di Rugiada Esterno ed Interno)

  - Permette l'accensione e lo spegnimento Automatico, in funzione dell'Umidità
  Interna Settata [ad Esclusione nel Range del Calendario];

  - Permette l'accensione e lo spegnimento Automatico, in funzione delle 2 fasce
  orarie programmabili per ogni giorno della settimana;

  - Permette l'accensione e lo spegnimento Automatico, in funzione delle 2 fasce
  mensili programmabili per la Velocità impostata su Free Heating / Free
  Cooling;

  - Ripristina la Velocità precedente in caso di Black-Out, se la VMC ha una
  linea dedicata e/o se installato un relè domotico [ad Esclusione nel Range del
  Calendario];

  - Avvisa in caso di Aggiornamento del Package;

  - Rinomina la VMC;

  - Permette di Cambiare l'IP.
triggers:
  - alias: Trigger Attivazione Finestra Avvisi Grafici
    entity_id:
      - input_boolean.vmc_master_opzioni_avvisi_grafici
    from: "off"
    to: "on"
    id: Opzioni Avvisi Grafici On
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 0
    trigger: state
  - alias: Trigger Disattivazione Finestra Avvisi Grafici
    entity_id:
      - input_boolean.vmc_master_opzioni_avvisi_grafici
    id: Opzioni Avvisi Grafici Off
    from: "on"
    to: "off"
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_vmc
    from: "off"
    to: "on"
    id: Opzioni Telecomando On
    alias: Trigger Attivazione Finestra Telecomando
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_vmc
    id: Opzioni Telecomando Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Telecomando
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_monitoraggio_sensori
    to: "on"
    id: Opzioni Monitoraggio On
    alias: Trigger Attivazione Finestra Monitoraggio
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_monitoraggio_sensori
    id: Opzioni Monitoraggio Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Monitoraggio
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
    from: "off"
    to: "on"
    id: Opzioni Sub Offset On
    alias: Trigger Attivazione Sotto Finestra Offset - Finestra Monitoraggio
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
    from: "on"
    to: "off"
    id: Opzioni Sub Offset Off
    alias: Trigger Disattivazione Sotto Finestra Offset - Finestra Monitoraggio
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
    from: "off"
    to: "on"
    id: Opzioni Sub Extra Sensori On
    alias: Trigger Attivazione Sotto Finestra Sensori Extra - Finestra Monitoraggio
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
    from: "on"
    to: "off"
    id: Opzioni Sub Extra Sensori Off
    alias: >-
      Trigger Disattivazione Sotto Finestra Sensori Extra - Finestra
      Monitoraggio
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_calendario
    from: "off"
    to: "on"
    id: Opzioni Sub Programmazione Giornaliera On
    alias: Trigger Attivazione Programmazione Giornaliera
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_interruttore_calendario
    from: "on"
    to: "off"
    id: Opzioni Sub Programmazione Giornaliera Off
    alias: Trigger Disattivazione Programmazione Giornaliera
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_offset_sensori
    from: "off"
    to: "on"
    id: " Opzioni On"
    alias: Trigger Attivazione Finestra Opzioni
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_offset_sensori
    id: Opzioni Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Opzioni
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_punto_di_rugiada
    alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di Rugiada
    id: Opzioni Sub Lim. Δ P. di Rugiada On
    from: "off"
    to: "on"
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_punto_di_rugiada
    alias: >-
      Trigger Disattivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di
      Rugiada
    from: "on"
    to: "off"
    id: Opzioni Sub Lim. Δ P. di Rugiada Off
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_calendario_main
    alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Main
    id: Opzioni Sub Calendario Main On
    from: "off"
    to: "on"
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_calendario_main
    alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario Main
    from: "on"
    to: "off"
    id: Opzioni Sub Calendario Main Off
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_calendario
    alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario
    id: Opzioni Sub Calendario On
    from: "off"
    to: "on"
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_calendario
    alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
    from: "on"
    to: "off"
    id: Opzioni Sub Calendario Off
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
    alias: >-
      Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Free
      Heating / Free Cooling
    id: Opzioni Sub Calendario Free H/C On
    from: "off"
    to: "on"
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
    alias: >-
      Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario Free
      Heating / Free Cooling
    from: "on"
    to: "off"
    id: Opzioni Sub Calendario Free H/C Off
    enabled: true
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_avvisi
    from: "off"
    to: "on"
    id: Opzioni Avvisi On
    alias: Trigger Attivazione Finestra Avvisi
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_avvisi
    id: Opzioni Avvisi Off
    from: "on"
    to: "off"
    alias: Trigger Disattivazione Finestra Avvisi
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_lettura_sensori
    from: "off"
    to: "on"
    id: Opzioni Informazioni On
    alias: Trigger Attivazione Finestra Informazioni
    trigger: state
  - entity_id:
      - input_boolean.vmc_master_opzioni_lettura_sensori
    id: Opzioni Informazioni Off
    from: "on"
    to: "off"
    for:
      hours: 0
      minutes: 0
      seconds: 0
    alias: Trigger Disattivazione Finestra Informazioni
    trigger: state
  - alias: >-
      Condizioni Sfavorevoli a Velocità 1 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 1")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 1-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 2 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 2")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 2-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 3 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 3")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 3-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 4 -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 4")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 4-> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità Notturna -> Imposta Velocità 0 se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Notturna")) and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Notturna -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità Free Cool./Heat.-> Imposta Velocità 0 se
      Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Free Cooling")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Free-Cooling -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità Iperventilazione -> Imposta Velocità 0
      se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Iperventilazione")) and
      (states('input_boolean.vmc_master_spia_co2_o_voc') == 'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Iperventilazione -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 1 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 1")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 1 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 2 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 2")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 2 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 3 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 3")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 3 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 4 se Spia Congelamento Off e Spia Delta
      Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto') ==
      "Se ne sconsiglia l'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Velocità 4")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Vel. 4 se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità Notturna se Spia Congelamento Off e Spia
      Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Notturna")) and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Notturna se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità Free Cool./Heat. se Spia Congelamento
      Off e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Free Cooling")) and (states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Free-Cooling se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità Iperventilazione se Spia Congelamento
      Off e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      ((states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
      == "Iperventilazione")) and
      (states('input_boolean.vmc_master_spia_co2_o_voc') == 'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: PdR Iperventilazione se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 0 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF Vs PdR
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'on')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 0 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')== 'on')
      and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 1 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 2 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 3 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 4 No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Notturno No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta, Presenza di Inquinanti') and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Free Cool./Heat. No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Iperventilazione No PdR
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON - Attenzione Verifica anche
      La Spia vmc_master_spia_velocita_freecooling_un_solo_avvio è ON solo se
      Spia Free Heating è ON oppure  Spia Free Cooling è ON
    value_template: >-
      {{ states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')== 'on'
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and
      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'off') ) )) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
      and states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 1 No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 2 No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 3 No PdR  se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento Off
      e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')== 'on')
      and (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
      'off') and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Vel. 4 No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Notturno No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{ (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off'
      and states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling')
      == 'Nessuna Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta, Presenza di Inquinanti' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Nessuna Allerta, Presenza di Inquinanti') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') or
      (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se ne
      sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off'
      and states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Free Cool./Heat. No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se Spia
      Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{( ((states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')!="Se
      ne sconsiglia l\'impiego") and
      (states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
      'on') and
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')== 'off')
      and (states('input_boolean.vmc_master_spia_co2_o_voc')=='on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Iperventilazione No PdR se Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating ->
      Vel. 0 se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti
      OFF
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: TeVsTi Free-Heating -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling ->
      Vel. 0 se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti
      OFF
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'off')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: TeVsTi Free-Cooling -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating se
      Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: TeVsTi Free-Heating e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling se
      Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
    value_template: >-
      {{(
      ((states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)") and (states('input_boolean.vmc_master_spia_co2_o_voc') ==
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: TeVsTi Free-Cooling e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 4
    enabled: true
    trigger: template
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti OFF
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti') and 
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off' 
      and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: "Rip. Free Heating No TeVsTi "
    for:
      hours: 0
      minutes: 0
      seconds: 10
    trigger: template
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti OFF
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti') and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')=='off'
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
      and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: "Rip. Free Cooling No TeVsTi "
    for:
      hours: 0
      minutes: 0
      seconds: 10
    trigger: template
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti ON
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Heating Programmato, Presenza di Inquinanti') and 
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
      and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Free Heating No TeVsTi e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 10
    trigger: template
  - alias: >-
      Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
      Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
      Inquinanti ON
    value_template: >-
      {{
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')==
      'Nessuna Allerta Free Cooling Programmato, Presenza di Inquinanti') and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')=='off'
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
      and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: Rip. Free Cooling No TeVsTi e Spia Inquinanti ON
    for:
      hours: 0
      minutes: 0
      seconds: 10
    trigger: template
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
      precedentemente Armato ed Attivato -> Velocità 0 se Spia Inquinanti OFF
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=='off')
      and ( (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'))
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'off')) ) and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato"
    trigger: template
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
      precedentemente Armato ed Attivato -> Velocità 1 se Spia Inquinanti ON
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')=='off')
      and ( (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'))
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'on')) ) and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato e Spia Inquinanti ON"
    trigger: template
  - alias: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
      precedentemente Armato  -> Vel. 0 se Spia Inquinanti OFF
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Cooling' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
      precedentemente Armato
    enabled: true
    trigger: template
  - alias: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato  -> Vel. 0 se Spia Inquinanti OFF"
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Heating' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'off' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
      precedentemente Armato
    enabled: true
    trigger: template
  - alias: >-
      Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
      precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Cooling' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'on' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating precedentemente Armato e Spia Inquinanti ON"
    enabled: true
    trigger: template
  - alias: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON"
    value_template: >-
      {{ (
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Disabilitata' or
      states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')==
      'Free Heating' ) and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
      'off' and states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato e Spia Inquinanti ON"
    enabled: true
    trigger: template
  - alias: >-
      Black-Out Velocità 0 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON] 
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 0") and (states('input_boolean.vmc_master_spia_velocita_1') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')) }}
    id: Black-Out a Velocità 0
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità 0 [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_0')=="on") and
      (states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out Off Vel. 0
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità 1 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON] e [SPIE INQUINANTI OFF] e [SPIE FREECOOLING e FREEHEAING
      OFF]
    value_template: >-
      {{states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line" and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 1" and   states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off'
      and   states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off' and   states('input_boolean.vmc_master_spia_calendario_lunedi_1') ==
      'off' and   states('input_boolean.vmc_master_spia_calendario_lunedi_2') ==
      'off' and   states('input_boolean.vmc_master_spia_calendario_martedi_1')
      == 'off' and  
      states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off'
      and   states('input_boolean.vmc_master_spia_calendario_mercoledi_1') ==
      'off' and   states('input_boolean.vmc_master_spia_calendario_mercoledi_2')
      == 'off' and  
      states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off'
      and   states('input_boolean.vmc_master_spia_calendario_giovedi_2') ==
      'off' and  states('input_boolean.vmc_master_spia_calendario_venerdi_1') ==
      'off' and  states('input_boolean.vmc_master_spia_calendario_venerdi_2') ==
      'off' and  states('input_boolean.vmc_master_spia_calendario_sabato_1') ==
      'off' and states('input_boolean.vmc_master_spia_calendario_sabato_2') ==
      'off' and  states('input_boolean.vmc_master_spia_calendario_domenica_1')
      == 'off' and 
      states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off' and
      states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')
      == 'off' and 
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off'
      and  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off'
      and 
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
      == 'off' and 
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
      == 'off' }}
    id: Black-Out a Velocità 1
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità 1 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON] e [SPIE INQUINANTI ON] e [SPIE FREECOOLING ON o
      FREEHEAING ON]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 1") and (states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      and states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on' and (
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
      or
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
      )}}
    id: >-
      Black-Out a Velocità 1 caso [SPIE INQUINANTI ON] e [SPIE FREECOOLING ON o
      FREEHEAING ON]
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità 1 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON] e [SPIE INQUINANTI ON] e [SPIE FREECOOLING OFF e
      FREEHEATING OFF]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 1") and (states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      and  states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off') 
      }}
    id: >-
      Black-Out a Velocità 1 caso [SPIE INQUINANTI ON] e [SPIE FREECOOLING OFF e
      FREEHEAING OFF]
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità 1 [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_1')=="on") and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out Off Vel. 1
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità 2 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 2") and (states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out a Velocità 2
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità 2 [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_2')=="on") and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Off Vel. 2
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità 3 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 3") and (states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out a Velocità 3
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità 3 [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_3')=="on") and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      )}}
    id: Black-Out Off Vel. 3
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità 4 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Velocità 4") and (states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out a Velocità 4
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità 4 [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_4')=="on") and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Off Vel. 4
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità Notturna [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
      CALENDARIO E' ON]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Notturna") and (states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Notturna
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità Notturna [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_notturna')=="on") and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Off Notturna
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità Iperventilazione [ON] - [RILEVAZIONE DISATTIVATA SE
      SPIA GIORNO CALENDARIO E' ON]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Iperventilazione") and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Iperventilazione
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità Iperventilazione [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione')=="on")
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off') and (
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off') and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Off Iperventilazione
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      Black-Out Velocità Free Cool./Heat. [ON] - [RILEVAZIONE DISATTIVATA SE
      SPIA GIORNO CALENDARIO E' ON]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "OFF-Line") and
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato') ==
      "Free Cooling") and (states('input_boolean.vmc_master_spia_velocita_0') ==
      'off' and states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
      and states('input_boolean.vmc_master_spia_velocita_notturna') == 'off')
      and ( (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Free Cool./Heat.
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: Black-Out Velocità Free Cool./Heat. [OFF, Ripristino]
    value_template: >-
      {{ (states('sensor.vmc_master_status_ip_interfaccia') == "ON-Line") and
      (states('input_boolean.vmc_master_spia_velocita_freecooling')=="on") and
      (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
      and states('input_boolean.vmc_master_spia_velocita_notturna') == 'off')
      and ( (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='off')
      and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='off')
      and (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='off')
      ) }}
    id: Black-Out Off Free Cool./Heat.
    trigger: template
    for:
      hours: 0
      minutes: 0
      seconds: 16
  - alias: >-
      All'Interno della 1° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Lunedì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 1° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Lunedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 2° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Lunedì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 2° Fascia Lunedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Lunedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Lunedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_lunedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Lunedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 1° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Martedì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 1° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Martedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 2° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Martedì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 2° Fascia Martedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Martedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Martedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_martedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_martedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Martedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 1° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' }}
    id: 1° Mercoledì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 1° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' ) and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Mercoledì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 2° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}} 
    id: 2° Mercoledì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 2° Fascia Mercoledì se Spia Congelamento Off e Spia
      Delta Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Mercoledi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Mercoledi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_mercoledi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Mercoledì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 1° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Giovedì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 1° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Giovedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 2° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}} 
    id: 2° Giovedì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 2° Fascia Giovedì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Giovedi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Giovedi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_giovedi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Giovedì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 1° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Venerdì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 1° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Venerdì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 2° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}} 
    id: 2° Venerdì On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 2° Fascia Venerdì se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Venerdi") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Venerdi") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_venerdi_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Venerdì Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 1° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Sabato On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 1° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Sabato Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 2° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}} 
    id: 2° Sabato On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 2° Fascia Sabato se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Sabato") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Sabato") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_sabato_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_sabato_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Sabato Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 1° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario')
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario')==
      "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Domenica On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 1° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario') 
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario') ==
      "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='on')) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 1° Domenica Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Interno della 2° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off 
    value_template: >
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')==
      "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica_2'),
      '%H:%M:%S').strftime('%H:%M')))==true) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") ) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}} 
    id: 2° Domenica On
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      All'Esterno della 2° Fascia Domenica se Spia Congelamento Off e Spia Delta
      Temp Off
    value_template: >-
      {{(
      ((((states('sensor.vmc_master_status_accensione_vmc_tramite_calendario_2')
      == "Domenica") and
      (states('sensor.vmc_master_status_spegnimento_vmc_tramite_calendario_2')
      == "Domenica") and (now().strftime('%H:%M') >=
      strptime(states('input_datetime.vmc_master_accensione_domenica_2'),
      '%H:%M:%S').strftime('%H:%M') and now().strftime('%H:%M') <
      strptime(states('input_datetime.vmc_master_spegnimento_domenica_2'),
      '%H:%M:%S').strftime('%H:%M')))==false) and
      (states('sensor.vmc_master_status_ip_interfaccia')=="ON-Line") and
      (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='on') ) )
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: 2° Domenica Off
    for:
      hours: 0
      minutes: 0
      seconds: 3
    trigger: template
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Calendario , precedentemente
      Armato ed Attivato tra le Fascie del Calendario -> Velocità 0 se Spia
      Inquinanti OFF
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario')=='off')
      and ( (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='on')
      or (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='on') )
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'off')) ) and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Calendario Off tra Fascie
    trigger: template
  - alias: >-
      Disattivazione: VMC ON/OFF, in Funzione del Calendario , precedentemente
      Armato ed Attivato tra le Fascie del Calendario -> Velocità 1, se Spia
      Inquinanti ON
    value_template: >-
      {{(
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario')=='off')
      and ( (states('input_boolean.vmc_master_spia_calendario_lunedi_1')=='on')
      or (states('input_boolean.vmc_master_spia_calendario_lunedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_martedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_mercoledi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_giovedi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_venerdi_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_sabato_2')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_1')=='on') or
      (states('input_boolean.vmc_master_spia_calendario_domenica_2')=='on') )
      and (states('input_boolean.vmc_master_spia_co2_o_voc') == 'on')) )  and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Calendario Off tra Fascie e Spia Inquinanti ON
    trigger: template
  - alias: Rinomina VMC
    value_template: >-
      {{ states('input_text.vmc_master_nome_da_inserire')!="" and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Cambio Nome VMC
    trigger: template
  - entity_id:
      - input_text.vmc_master_ip_insert
    id: Riscrivi IP
    alias: Cambio Indirizzo IP della VMC (Riavvio di H.A.)
    trigger: state
  - alias: Spia Avvisi On
    value_template: >-
      {{ states('sensor.vmc_master_alert_monitoraggio_totale')=='Allerta' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Spia Avvisi On
    trigger: template
  - alias: Spia Avvisi Off
    value_template: >-
      {{ states('sensor.vmc_master_alert_monitoraggio_totale')=='Nessuna
      Allerta' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Spia Avvisi Off
    trigger: template
  - alias: >-
      Spia Velocità 0 Congelamento se Spia Congelamento ON e Spia Delta Temp Off
      e e Spia Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free Heating
      Congelamento = Off
    value_template: >-
      {{ (
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      0') and (states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and
      (states('input_boolean.vmc_master_spia_velocita_1_congelamento')== 'off'
      and states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_3_congelamento')== 'off'
      and states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
      'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
      'off')  and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_0_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 8
    trigger: template
  - alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - ON
    value_template: >-
      {{ (states('sensor.vmc_master_versione_repository') !=
      states('sensor.vmc_master_versione_corrente') and
      states('input_boolean.vmc_master_popup_versione_corrente_vs_repository')=="off"
      and states('sensor.vmc_master_versione_repository') != "Errore
      Connessione") and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Repository Update ON
    for:
      hours: 0
      minutes: 0
      seconds: 5
    trigger: template
  - alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - OFF
    value_template: >-
      {{ (states('sensor.vmc_master_versione_repository') ==
      states('sensor.vmc_master_versione_corrente') and
      states('sensor.vmc_master_versione_repository') != "Errore Connessione")
      and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Repository Update OFF
    trigger: template
  - alias: >-
      Attivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati se Spia
      Congelamento Off e Spia Delta Temp Off
    value_template: >-
      {{( ( ((states('sensor.vmc_master_alert_monitoraggio_co2') == 'Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_voc') == 'Allerta') and
      is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc',
      'on')) ) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: inquinanti_co2_voc_on
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: Disattivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati
    value_template: >-
      {{ states('sensor.vmc_master_alert_monitoraggio_co2') != 'Allerta' and
      states('sensor.vmc_master_alert_monitoraggio_voc') != 'Allerta' and
      is_state('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc',
      'on') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'on'
      ) and (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))
      }}
    id: inquinanti_co2_voc_off
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità 0 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    value_template: >-
      {{ ( ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      0')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'))  and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_0_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 12
    enabled: true
    trigger: template
  - alias: >-
      Spia Velocità 1 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    value_template: >-
      {{ ( ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      1')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_1_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 8
    trigger: template
  - alias: >-
      Spia Velocità 2 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    value_template: >-
      {{ ( ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      2')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') ) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_2_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità 3 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    value_template: >-
      {{ ( ((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      3')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_3_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità 4 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
      Off 
    value_template: >-
      {{ (((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      4')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off'))  and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_4_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità Notturna CO₂ e/o VOC se Spia Congelamento Off e Spia Delta
      Temp Off 
    value_template: >-
      {{ (((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'))
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_notturna_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità Iperventilazione CO₂ e/o VOC se Spia Congelamento Off e Spia
      Delta Temp Off 
    value_template: >-
      {{ (((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'))
      and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_iperventilazione_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità Free Heating/Cooling CO₂ e/o VOC se Spia Congelamento Off e
      Spia Delta Temp Off 
    value_template: >-
      {{ (((states('input_boolean.vmc_master_spia_co2_o_voc')=='on' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
      Cooling')) and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile'}}
    id: spia_velocita_freecooling_inquinanti_co2_voc
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato -> Tutte le Spie CO2 e/o VOC OFF -> Vel. 0"
    value_template: >-
      {{( (
      ((states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc')=='off')
      and (
      (states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
      'on') or (states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
      'on') or
      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on') or
      (states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')))
      )) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato"
    trigger: template
  - alias: Congelamento ON
    value_template: >-
      {{ states('sensor.vmc_master_congelamento_verifica_soglia')=='Si' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Congelamento ON
    for:
      hours: 0
      minutes: 0
      seconds: 2
    trigger: template
  - alias: >-
      Spia Velocità 1 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      1' and ( states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      or states('sensor.vmc_master_temp_esterna_status_senza_offset') | float(0)
      <=-18) and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_1_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità 2 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      2' and ( states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      or states('sensor.vmc_master_temp_esterna_status_senza_offset') | float(0)
      <=-18) and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_2_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità 3 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      3' and ( states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      or states('sensor.vmc_master_temp_esterna_status_senza_offset') | float(0)
      <=-18) and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_3_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità 4 Congelamento se Spia Congelamento ON e Spia Delta Temp
      Off 
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      4' and ( states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18
      or states('sensor.vmc_master_temp_esterna_status_senza_offset') | float(0)
      <=-18) and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_4_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità Iperventilazione Congelamento se Spia Congelamento ON e Spia
      Delta Temp Off 
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'
      and ( states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18 or
      states('sensor.vmc_master_temp_esterna_status_senza_offset') | float(0)
      <=-18) and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_iperventilazione_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità Notturna Congelamento se Spia Congelamento ON e Spia Delta
      Temp Off 
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'
      and ( states('sensor.vmc_master_temp_esterna_status') | float(0) <=-18 or
      states('sensor.vmc_master_temp_esterna_status_senza_offset') | float(0)
      <=-18) and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_notturna_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Spia Velocità Free Cooling Congelamento se Spia Congelamento ON e Spia
      Delta Temp Off 
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
      Cooling' and ( states('sensor.vmc_master_temp_esterna_status') | float(0)
      <=-18 or states('sensor.vmc_master_temp_esterna_status_senza_offset') |
      float(0) <=-18) and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: spia_velocita_Free Cooling_congelamento
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: Congelamento OFF
    value_template: >-
      {{ states('sensor.vmc_master_congelamento_verifica_soglia')!='Si' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and   
      (states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'on'
      or
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'on' or
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'on')}}
    id: Congelamento OFF
    for:
      hours: 0
      minutes: 0
      seconds: 2
    trigger: template
  - alias: >-
      Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON e se Spia
      Inquinanti OFF e se Spia Congelamento Off e Spia Delta Temp Off
    value_template: >-
      {{ ((
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')
      or
      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
      ) and (
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 1' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 2' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 3' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 4' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Notturna' or
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Iperventilazione') and states('input_boolean.vmc_master_spia_co2_o_voc')
      == 'off'  and
      (states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off')) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: >-
      Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON - Inquinanti
      OFF
    for:
      hours: 0
      minutes: 0
      seconds: 4
    enabled: true
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp Off
      [Caso Velocità Free Cooling]
    value_template: >-
      {{
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: >-
      PdR Vel. 0 con Spia FreeCooling On e Inquinanti Vel. 1 ON  -> Imposta
      Velocità 1
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating OFF e Spia FreeCooling ON ->
      Imposta Velocità 0 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti OFF
    value_template: >-
      {{ (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Nessuna Allerta' and
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Nessuna Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta Velocità 0
    for:
      hours: 0
      minutes: 0
      seconds: 4
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating OFF e Spia FreeCooling ON ->
      Imposta Velocità 1 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti ON
    value_template: >-
      {{ (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: >-
      PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta Velocità 1 se
      Spia Inquinanti ON
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating ON e Spia FreeCooling OFF ->
      Imposta Velocità 0 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti OFF
    value_template: >-
      {{ (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Nessuna Allerta' and
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Nessuna Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta Velocità 0
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli con Spia Free Heating ON e Spia FreeCooling OFF ->
      Imposta Velocità 1 se Spia Congelamento Off e Spia Delta Temp Off e se
      Inquinanti ON
    value_template: >-
      {{ (states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')=="Se
      ne sconsiglia l\'impiego" and
      states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') ==
      'on' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
      and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
      and
      (states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)'
      or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento Arrestato, Presenza di
      Inquinanti)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Allerta
      Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')=='Non
      Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento,
      Presenza di Inquinanti)') and
      (states('sensor.vmc_master_alert_monitoraggio_voc')=='Allerta' or
      states('sensor.vmc_master_alert_monitoraggio_co2')=='Allerta') and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off' ) and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: >-
      PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta Velocità 1 se
      Spia Inquinanti ON
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 OFF se Spia Congelamento Off e Spia Delta Temp
      Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Heating]
    value_template: >-
      {{
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza
      di Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: PdR Vel. 0 con Spia FreeHeating On -> Imposta Velocità 0
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 OFF se Spia Congelamento Off e Spia Delta Temp
      Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Cooling]
    value_template: >-
      {{
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Cooling Programmato (Riscaldamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Cooling Programmato (Allerta
      Riscaldamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'off' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: PdR Vel. 0 con Spia FreeCooling On -> Imposta Velocità 0
    trigger: template
  - alias: >-
      Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
      Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp Off
      [Caso Velocità Free Heating]
    value_template: >-
      {{
      (states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')==
      'Velocità 0' and
      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
      'on' and (
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == 'Allerta Free Heating Programmato (Raffrescamento in atto)' or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di
      Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza
      di Inquinanti)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento)" or
      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
      == "Non Avviare in Velocità Free Heating Programmato (Allerta
      Raffrescamento, Presenza di Inquinanti)" ) and
      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')== 'on' and
      states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
      'off' and
      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')==
      'off') and states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line'
      and (states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
      states('input_boolean.vmc_master_spia_velocita_iperventilazione') ==
      'off') and
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!='Non
      disponibile' and (is_state('input_boolean.vmc_master_spia_velocita_0',
      'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    id: >-
      PdR Vel. 0 con Spia FreeHeating On e Inquinanti Vel. 1 ON  -> Imposta
      Velocità 1
    enabled: true
    trigger: template
  - trigger: homeassistant
    event: start
    id: VMC Master Elenco Entità Temperatura e Umidità installate in H.A.
    alias: >-
      Al Riavvio di Home Assistant Verifica se è impostata una Entità
      Temperatura, Umidità, Anidride Carbonica e Mobile installata in H.A.,
      diversamente avvisa
  - alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Sensori Opzionati
    entity_id:
      - input_boolean.vmc_master_opzioni_scelta_sensori
    id: Opzioni Sub Sensori Opzionati On
    from: "off"
    to: "on"
    enabled: true
    trigger: state
  - alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Sensori Opzionati
    entity_id:
      - input_boolean.vmc_master_opzioni_scelta_sensori
    from: "on"
    to: "off"
    id: Opzioni Sub Sensori Opzionati Off
    enabled: true
    trigger: state
  - alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Elementi Chimici
    entity_id:
      - input_boolean.vmc_master_opzioni_elementi_chimici
    id: Opzioni Sub Elementi Chimici On
    from: "off"
    to: "on"
    enabled: true
    trigger: state
  - alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Elementi Chimici
    entity_id:
      - input_boolean.vmc_master_opzioni_elementi_chimici
    from: "on"
    to: "off"
    id: Opzioni Sub Elementi Chimici Off
    enabled: true
    trigger: state
  - alias: >-
      Quando Seleziona Entità Temperatura Esterna installata in H.A. cambia
      stato o qualsiasi attributo
    entity_id:
      - input_select.vmc_master_selected_temp_external_entity
    id: VMC Master Save Selected Temperatura Esterna Entity
    enabled: true
    trigger: state
  - alias: >-
      Quando Seleziona Entità Temperatura Interna installata in H.A. cambia
      stato o qualsiasi attributo
    entity_id:
      - input_select.vmc_master_selected_temp_internal_entity
    id: VMC Master Save Selected Temperatura Interna Entity
    enabled: true
    trigger: state
  - alias: >-
      Quando Seleziona Entità Umidità Esterna installata in H.A. cambia stato o
      qualsiasi attributo
    entity_id:
      - input_select.vmc_master_selected_humidity_external_entity
    id: VMC Master Save Selected Umidità Esterna Entity
    enabled: true
    trigger: state
  - alias: >-
      Quando Seleziona Entità Umidità Interna installata in H.A. cambia stato o
      qualsiasi attributo
    entity_id:
      - input_select.vmc_master_selected_humidity_internal_entity
    id: VMC Master Save Selected Umidità Interna Entity
    enabled: true
    trigger: state
  - alias: >-
      Quando Seleziona Entità Anidride Carbonica Interna installata in H.A.
      cambia stato o qualsiasi attributo
    entity_id:
      - input_select.vmc_master_selected_co2_internal_entity
    id: VMC Master Save Selected CO2 Interna Entity
    enabled: true
    trigger: state
  - alias: >-
      Quando Seleziona Dispositivo per Invio SMS installato in H.A. cambia stato
      o qualsiasi attributo
    entity_id:
      - input_select.vmc_master_selected_notification_device
    id: VMC Master Save Selected Dispositivo Interna Entity
    enabled: true
    trigger: state
  - alias: >-
      Entità Temperatura Esterna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [Interfaccia]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_temperatura_esterna_selezionata')=='-100' and
      states('input_boolean.vmc_master_notifica_status_vmc')=='on' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Temperatura Esterna Errore [Interfaccia]
  - alias: >-
      Entità Temperatura Interna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [Interfaccia]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_temperatura_interna_selezionata')=='-100' and
      states('input_boolean.vmc_master_notifica_status_vmc')=='on' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Temperatura Interna Errore [Interfaccia]
  - alias: >-
      Entità Umidità Esterna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [Interfaccia]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_umidita_esterna_selezionata')=='-100' and
      states('input_boolean.vmc_master_notifica_status_vmc')=='on' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Umidità Esterna Errore [Interfaccia]
  - alias: >-
      Entità Umidità Interna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [Interfaccia]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_umidita_interna_selezionata')=='-100' and
      states('input_boolean.vmc_master_notifica_status_vmc')=='on' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Umidità Interna Errore [Interfaccia]
  - alias: >-
      Entità CO₂ Interna installata in H.A. cambia in ['unknown', 'unavailable',
      '-100', 'Non disponibile'] [Interfaccia]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_co2_interna_selezionata')=='-100' and
      states('input_boolean.vmc_master_notifica_status_vmc')=='on' and
      states('sensor.vmc_master_status_ip_interfaccia')=='ON-Line' and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità CO2 Interna Errore [Interfaccia]
  - alias: >-
      Verifica ogni Giorno alle 08:00 del Mattino se il Filtro  deve essere
      cambiato [Interfaccia]
    trigger: time
    at: "08:00:00"
    id: Avviso Cambio Filtro
  - alias: >-
      Verifica ogni Giorno alle 08:00 del Mattino se il Filtro  deve essere
      cambiato [Mobile]
    trigger: time
    at: "08:00:00"
    id: Avviso Cambio Filtro [Mobile]
  - alias: VMC Velocità 0 da Notificare [MOBILE]
    trigger: template
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
      0' and states('input_boolean.vmc_master_notifica_status_vmc')=='on' and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: VMC Velocità 0 da Notificare
  - alias: VMC Velocità in Funzione da Notificare [MOBILE]
    trigger: template
    value_template: >-
      {{
      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!='Velocità
      0' and states('input_boolean.vmc_master_notifica_status_vmc')=='on' and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: VMC Velocità in Funzione da Notificare
  - alias: >-
      Entità Temperatura Esterna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [MOBILE]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_temp_esterna_status') in ["sconosciuto",
      "unknown", "", none, "unavailable", "Non disponibile","-100"] and
      is_state('input_boolean.vmc_master_notifica_status_vmc', 'on') and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Temperatura Esterno Errore [Mobile]
  - alias: >-
      Entità Temperatura Interna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [MOBILE]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_temp_interna_status') in ["sconosciuto",
      "unknown", "", none, "unavailable", "Non disponibile","-100"] and
      is_state('input_boolean.vmc_master_notifica_status_vmc', 'on') and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Temperatura Interna Errore [Mobile]
  - alias: >-
      Entità Umidità Esterna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [MOBILE]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_umidita_esterna_status') in ["sconosciuto",
      "unknown", "", none, "unavailable", "Non disponibile","-100"] and
      is_state('input_boolean.vmc_master_notifica_status_vmc', 'on') and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Umidità Esterna Errore [Mobile]
  - alias: >-
      Entità Umidità Interna installata in H.A. cambia in ['unknown',
      'unavailable', '-100', 'Non disponibile'] [MOBILE]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_umidita_interna_status') in ["sconosciuto",
      "unknown", "", none, "unavailable", "Non disponibile","-100"] and
      is_state('input_boolean.vmc_master_notifica_status_vmc', 'on') and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità Umidità Interna Errore [Mobile]
  - alias: >-
      Entità CO₂ Interna installata in H.A. cambia in ['unknown', 'unavailable',
      '-100', 'Non disponibile'] [MOBILE]
    trigger: template
    value_template: >-
      {{ states('sensor.vmc_master_co2_status') in ["sconosciuto", "unknown",
      "", none, "unavailable", "Non disponibile","-100"] and
      is_state('input_boolean.vmc_master_notifica_status_vmc', 'on') and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: Entità CO2 Interna Errore [Mobile]
  - alias: >-
      Pannello Avvisi con Problemi ['unknown', 'unavailable', '', 'sconosciuto',
      'Non disponibile', none]
    trigger: template
    value_template: >-
      {{states('sensor.vmc_master_spia_pannello_alert_monitoraggio_totale') in
      ['unknown', 'unavailable', '', 'sconosciuto', 'Non disponibile', none] and
      (is_state('input_boolean.vmc_master_spia_velocita_0', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_1', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_2', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_3', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_4', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_notturna', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_freecooling', 'off') and
        is_state('input_boolean.vmc_master_spia_velocita_iperventilazione', 'off'))}}
    id: pannello_avvisi_problema
  - alias: >-
      Spia Umidità ON [SOLO SE LA VELOCITA' 0 E NON CI SONO ALTRE ALLERTE E
      FUORI DAL CALENDARIO] -> Velocità Impostata
    trigger: template
    value_template: |-
      {{ 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
        (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        )
      }}
    id: spia_umidita_on
    for:
      hours: 0
      minutes: 0
      seconds: 24
  - alias: >-
      Spia Umidità OFF  [SOLO SE NON CI SONO ALTRE ALLERTE E FUORI DAL
      CALENDARIO]
    trigger: template
    value_template: |-
      {{ 
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') != 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: spia_umidita_off
    for:
      hours: 0
      minutes: 0
      seconds: 28
  - trigger: state
    entity_id:
      - input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita
    from: "on"
    to: "off"
    id: " Disattivazione Umidità Limite, precedentemente Armato ed Attivato"
    alias: >-
      Quando VMC ON/OFF, in Funzione dell'Umidità Interna cambia da Acceso/a a
      Spento/a [SOLO SE NON CI SONO ALTRE ALLERTE E FUORI DAL CALENDARIO] ->
      Velocità 0 
  - alias: Umidità ON Vel. 0 [Spia Umidità ON]
    trigger: template
    value_template: |
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Velocità 0' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    for:
      hours: 0
      minutes: 0
      seconds: 4
    enabled: true
    id: umidita_velocita_0
  - alias: Umidità ON a Vel. 1 [Spia Umidità ON]
    trigger: template
    value_template: |
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Velocità 1' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: umidita_velocita_1
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: Umidità ON a Vel. 2 [Spia Umidità ON]
    trigger: template
    value_template: |-
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Velocità 2' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: umidita_velocita_2
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: Umidità ON a Vel. 3 [Spia Umidità ON]
    trigger: template
    value_template: |-
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Velocità 3' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: umidita_velocita_3
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: Umidità ON a Vel. 4 [Spia Umidità ON]
    trigger: template
    value_template: |
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Velocità 4' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: umidita_velocita_4
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: Umidità ON a Vel. Notturna [Spia Umidità ON]
    trigger: template
    value_template: |-
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Notturna' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: umidita_velocita_notturna
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: Umidità ON a Vel. Iperventilazione [Spia Umidità ON]
    trigger: template
    value_template: |-
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Iperventilazione' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: umidita_velocita_iperventilazione
    for:
      hours: 0
      minutes: 0
      seconds: 4
  - alias: Umidità ON a Vel. Free Cooling [Spia Umidità ON]
    trigger: template
    value_template: |-
      {{ 
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')== 'Free Cooling' and
        states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita') == 'on' and
        states('sensor.vmc_master_alert_monitoraggio_umidita') == 'Allerta' and 
        states('input_boolean.vmc_master_umidita_verifica_soglia_valore_spia') == 'on' and
        states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
       (
          states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

          states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
        ) and

        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
        states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

        (
          states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
          states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
        ) and

        (
          states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
          states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
        ) }}
    id: umidita_velocita_free_cooling
    for:
      hours: 0
      minutes: 0
      seconds: 4
conditions: []
actions:
  - choose:
      - conditions:
          - condition: trigger
            id: Opzioni Telecomando On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_vmc
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: Trigger Attivazione Finestra Telecomando
      - conditions:
          - condition: trigger
            id: Opzioni Telecomando Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_vmc
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Finestra Telecomando
      - conditions:
          - condition: trigger
            id: Opzioni Monitoraggio On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_monitoraggio_sensori
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            enabled: true
            action: input_boolean.turn_off
        alias: Trigger Attivazione Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Monitoraggio Off
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
            enabled: true
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Offset On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_offset_sensori
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
            action: input_boolean.turn_off
        alias: Trigger Attivazione Sotto Finestra Offset - Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Offset Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_offset_sensori
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Sotto Finestra Offset - Finestra Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Extra Sensori On
        sequence:
          - data: {}
            target:
              entity_id: >-
                input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
            action: input_boolean.turn_off
        alias: >-
          Trigger Attivazione Sotto Finestra Sensori Extra - Finestra
          Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Extra Sensori Off
        sequence:
          - data: {}
            target:
              entity_id: >-
                input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
            action: input_boolean.turn_off
        alias: >-
          Trigger Attivazione Sotto Finestra Sensori Extra - Finestra
          Monitoraggio
      - conditions:
          - condition: trigger
            id: Opzioni Sub Programmazione Giornaliera On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_calendario
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: Trigger Attivazione Programmazione Giornaliera
      - conditions:
          - condition: trigger
            id: Opzioni Sub Programmazione Giornaliera Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_interruttore_calendario
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Programmazione Giornaliera
      - conditions:
          - condition: trigger
            id: " Opzioni On"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_offset_sensori
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            enabled: true
            action: input_boolean.turn_off
        alias: Trigger Attivazione Finestra Opzioni
      - conditions:
          - condition: trigger
            id: Opzioni Off
            enabled: true
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            enabled: true
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Finestra Opzioni
      - conditions:
          - condition: trigger
            id: Opzioni Sub Lim. Δ P. di Rugiada On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_punto_di_rugiada
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: >-
          Trigger Attivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di
          Rugiada
      - conditions:
          - condition: trigger
            id: Opzioni Sub Lim. Δ P. di Rugiada Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_punto_di_rugiada
            action: input_boolean.turn_off
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Lim. Δ P. di
          Rugiada
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Main On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario_main
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Main
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Main Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario_main
            action: input_boolean.turn_off
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
          Main
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_calendario
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Free H/C On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: >-
          Trigger Attivazione Sotto Finestra Opzioni - Finestra Calendario Free
          Heating / Free Cooling
      - conditions:
          - condition: trigger
            id: Opzioni Sub Calendario Free H/C Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
            action: input_boolean.turn_off
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Calendario
          Free Heating / Free Cooling
      - conditions:
          - condition: trigger
            id:
              - Opzioni Avvisi On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_avvisi
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_lettura_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: Trigger Attivazione Finestra Avvisi
      - conditions:
          - condition: trigger
            id:
              - Opzioni Avvisi Off
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Finestra Avvisi
      - conditions:
          - condition: trigger
            id: Opzioni Informazioni On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_lettura_sensori
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_avvisi
                - input_boolean.vmc_master_opzioni_avvisi_grafici
                - input_boolean.vmc_master_opzioni_offset_sensori
                - input_boolean.vmc_master_opzioni_vmc
                - input_boolean.vmc_master_opzioni_monitoraggio_sensori
                - input_boolean.vmc_master_opzioni_interruttore_calendario
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - >-
                  input_boolean.vmc_master_opzioni_interruttore_monitoraggio_sensori_extra
                - input_boolean.vmc_master_opzioni_interruttore_offset_sensori
                - input_boolean.vmc_master_opzioni_scelta_sensori
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: Trigger Attivazione Finestra Informazioni
      - conditions:
          - condition: trigger
            id: Opzioni Informazioni Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_lettura_sensori
            action: input_boolean.turn_off
        alias: Trigger Disattivazione Finestra Informazioni
      - conditions:
          - condition: trigger
            id: PdR Vel. 1-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 1 -> Velocità 0, memorizzando
              la Velocità 1
            if:
              - condition: template
                value_template: >-
                  {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                  'off'}}
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_0
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
            else:
              - metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                    - >-
                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                action: input_boolean.turn_off
        alias: >-
          Condizioni Sfavorevoli a Velocità 1 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Vel. 2-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 2 -> Velocità 0, memorizzando
              la Velocità 2
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_0
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 2 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Vel. 3-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 3 -> Velocità 0, memorizzando
              la Velocità 3
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_0
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 3 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 4-> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità 4 -> Velocità 0, memorizzando
              la Velocità 4
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_0
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 4 -> Imposta Velocità 0 se Spia
          Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Notturna -> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità Notturna -> Velocità 0,
              memorizzando la Velocità Notturna
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_0
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Notturna -> Imposta Velocità 0 se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id:
              - PdR Free-Cooling -> Imposta Velocità 0
              - >-
                PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta
                Velocità 0
              - >-
                PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta
                Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità Free Cool./Heat. -> Velocità 0,
              memorizzando la Velocità Free Cool./Heat.
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                          - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_0
                  until:
                    - alias: Ripeti finchè la Velocità = Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Free Cool./Heat.-> Imposta Velocità
          0 se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id: PdR Iperventilazione -> Imposta Velocità 0
        sequence:
          - alias: >-
              Condizioni Sfavorevoli su Velocità Iperventilazione -> Velocità 0,
              memorizzando la Velocità Iperventilazione
            if: []
            then:
              - alias: >-
                  Lancia il Comando Velocità 0 Finchè la Velocità diventa
                  Velocità 0
                repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_0
                  until:
                    - alias: Controlla se la Velocità è diversa da Velocità 0
                      condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Iperventilazione -> Imposta Velocità
          0 se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 1 se Spia Inquinanti ON
        sequence:
          - if:
              - condition: template
                value_template: >-
                  {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                  'off' and 
                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                  'off'}}
                enabled: true
            then:
              - choose:
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off'}}
                        alias: SE Spia Free Heating OFF e Spia FreeCooling OFF
                        enabled: true
                    sequence:
                      - repeat:
                          sequence:
                            - data: {}
                              target:
                                entity_id: >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              action: input_boolean.turn_on
                            - data: {}
                              target:
                                entity_id:
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              action: input_boolean.turn_off
                            - data: {}
                              action: shell_command.vmc_master_velocita_1
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                1'}}
                        enabled: true
                    alias: >-
                      Condizioni Sfavorevoli a Velocità 1 se Spia Inquinanti ON
                      e (Spia Free Heating OFF e Spia FreeCooling OFF) -> Vel. 1
                  - conditions:
                      - alias: Spia Free Heating ON e Spia FreeCooling OFF
                        condition: template
                        value_template: >-
                          {{
                          (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'on') }}
                    sequence:
                      - repeat:
                          sequence:
                            - data: {}
                              target:
                                entity_id: >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              action: input_boolean.turn_on
                            - data: {}
                              target:
                                entity_id:
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              action: input_boolean.turn_off
                            - data: {}
                              action: shell_command.vmc_master_velocita_1
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                1'}}
                    alias: >-
                      Condizioni Sfavorevoli a Velocità 1 se Spia Inquinanti ON
                      e (Spia Free Heating ON e Spia FreeCooling OFF) -> Vel. 1
                  - conditions:
                      - alias: Spia Free Heating OFF e Spia FreeCooling ON
                        condition: template
                        value_template: >-
                          {{
                          (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'on' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off') }}
                    sequence:
                      - repeat:
                          sequence:
                            - data: {}
                              target:
                                entity_id: >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              action: input_boolean.turn_on
                            - data: {}
                              target:
                                entity_id:
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                  - >-
                                    input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              action: input_boolean.turn_off
                            - data: {}
                              action: shell_command.vmc_master_velocita_1
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                1'}}
                    alias: >-
                      Condizioni Sfavorevoli a Velocità 1 se Spia Inquinanti ON
                      e (Spia Free Heating OFF e Spia FreeCooling ON) -> Vel. 1
        alias: >-
          Condizioni Sfavorevoli a Velocità 1 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - alias: Condizioni Sfavorevoli a Velocità 2 se Spia Inquinanti ON
            condition: trigger
            id:
              - PdR Vel. 2 se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità 2 se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_2
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        2'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 2 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 3 se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità 3 se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_3
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        3'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 3 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 4 se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità 4 se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_velocita_4
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                        4'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 4 se Spia Congelamento Off e Spia
          Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Notturna se Spia Inquinanti ON
        sequence:
          - alias: Condizioni Sfavorevoli a Velocità Notturna se Spia Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_notturna
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Notturna se Spia Congelamento Off e
          Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Free-Cooling se Spia Inquinanti ON
              - >-
                PdR Spia Free Heating OFF e Spia FreeCooling ON -> Imposta
                Velocità 1 se Spia Inquinanti ON
              - >-
                PdR Spia Free Heating ON e Spia FreeCooling OFF -> Imposta
                Velocità 1 se Spia Inquinanti ON
            enabled: true
        sequence:
          - choose:
              - conditions:
                  - alias: Verifica Presenze di Allerte Free Cooling
                    condition: template
                    enabled: true
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento in
                      atto)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento in
                      atto, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato)'}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          action: input_boolean.turn_on
                        - metadata: {}
                          data: {}
                          target:
                            entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    enabled: true
                alias: Sono presenti Allerte Free Cooling -> Vel. 1
              - conditions:
                  - alias: Verifica Presenze di Allerte Free Heating
                    condition: template
                    enabled: true
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento in
                      atto)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento in
                      atto, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato)'}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_on
                        - metadata: {}
                          data: {}
                          target:
                            entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          action: input_boolean.turn_off
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    enabled: true
                alias: Sono presenti Allerte Free Heating -> Vel. 1
              - conditions:
                  - alias: >-
                      Verifica Nessun Avviso su Free Cooling e il Mese
                      Programmato è Free Cooling
                    condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato, Presenza di
                      Inquinanti') and
                      (states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')=='Free
                      Cooling')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Nessun Avviso su Free Cooling e il Mese Programmato è Free
                  Cooling -> Vel. Free Cooling
              - conditions:
                  - alias: >-
                      Verifica Nessun Avviso su Free Heating e il Mese
                      Programmato è Free Heating
                    condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato, Presenza di
                      Inquinanti') and
                      (states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')=='Free
                      Heating')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Nessun Avviso su Free Heating e il Mese Programmato è Free
                  Heating -> Vel. Free Cooling
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling è OFF e il Mese Programmato è Disabilitata
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') and
                      (states('sensor.vmc_master_status_mese_corrente_freeheating_o_freecooling')=='Disabilitata')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          enabled: true
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è OFF e il Mese Programmato è Free Cool./Heat. ovvero
                  Disabilitata  -> Vel. Free Cooling
        alias: >-
          Condizioni Sfavorevoli a Velocità Free Cool./Heat. se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - PdR Iperventilazione se Spia Inquinanti ON
        sequence:
          - alias: >-
              Condizioni Sfavorevoli a Velocità Iperventilazione se Spia
              Inquinanti ON
            if: []
            then:
              - repeat:
                  sequence:
                    - data: {}
                      target:
                        entity_id: >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      action: input_boolean.turn_on
                    - data: {}
                      target:
                        entity_id:
                          - >-
                            input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          - >-
                            input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      action: input_boolean.turn_off
                    - data: {}
                      action: shell_command.vmc_master_iperventilazione
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità Iperventilazione se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: Rip. Vel. 0 No PdR
        sequence:
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                  action: input_boolean.turn_off
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_0
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 0 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 1 No PdR
        sequence:
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_1
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    1'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 2 No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_velocita_2
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    2'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 3 No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_velocita_3
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    3'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Vel. 4 No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_velocita_4
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    4'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti OFFF
      - conditions:
          - condition: trigger
            id: Rip. Notturno No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_notturna
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id: Rip. Free Cool./Heat. No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le Spie
                    Free Heating e Free Cooling non vengnono computate] Escluse
                    anche le Spie Inquinanti
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                          Spie Free Heating e Free Cooling non vengnono
                          computate] Esclusa anche Spie Inquinanti
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_freecooling
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id: Rip. Iperventilazione No PdR
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_iperventilazione
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 1 No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                      - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                  action: input_boolean.turn_off
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                    and 
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 1 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti ON - Attenzione
          Verifica anche la Spia
          vmc_master_spia_velocita_freecooling_un_solo_avvio se ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 2 No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_velocita_2
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    2'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 2 se Spia Congelamento
          Off e Spia Delta Temp Off e se  se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 3 No PdR  se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_velocita_3
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    3'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 3 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Vel. 4 No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_velocita_4
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    4'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità 4 se Spia Congelamento
          Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Notturno No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: >-
                    Ripeti Finchè Le Spie PdR Diventano OFF e le Spie Primo
                    Avvio Free Heating / Free Cooling Diventano OFF [Esclusa
                    Spie Inquinanti]
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: >-
                          Verifica che Le Spie PdR Diventano OFF e le Spie Primo
                          Avvio Free Heating / Free Cooling Diventano OFF
                          [Esclusa Spie Inquinanti]
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_notturna
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Notturna se Spia
          Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Free Cool./Heat. No PdR se Spia Inquinanti ON
        sequence:
          - alias: "Verifica Tipo di Allerte:"
            choose:
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling è OFF
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') }}
                sequence:
                  - repeat:
                      sequence:
                        - alias: >-
                            Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                            Spie Free Heating e Free Cooling non vengnono
                            computate] Escluse anche le Spie Inquinanti
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                action: input_boolean.turn_off
                            until:
                              - alias: >-
                                  Ripeti Finchè Le Spie PdR non Diventano OFF
                                  [N.b. Le Spie Free Heating e Free Cooling non
                                  vengnono computate] Esclusa anche Spie
                                  Inquinanti
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è OFF
              - conditions:
                  - condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Cooling Programmato, Presenza di
                      Inquinanti')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: >-
                            Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                            Spie Free Heating e Free Cooling non vengnono
                            computate] Escluse anche le Spie Inquinanti
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                action: input_boolean.turn_off
                            until:
                              - alias: >-
                                  Ripeti Finchè Le Spie PdR non Diventano OFF
                                  [N.b. Le Spie Free Heating e Free Cooling non
                                  vengnono computate] Esclusa anche Spie
                                  Inquinanti
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: Nessuna Allerta Free Cooling -> Vel. Free Cooling
              - conditions:
                  - condition: template
                    value_template: >-
                      {{(states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Nessuna Allerta Free Heating Programmato, Presenza di
                      Inquinanti')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: >-
                            Ripeti Finchè Le Spie PdR non Diventano OFF [N.b. Le
                            Spie Free Heating e Free Cooling non vengnono
                            computate] Escluse anche le Spie Inquinanti
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                action: input_boolean.turn_off
                            until:
                              - alias: >-
                                  Ripeti Finchè Le Spie PdR non Diventano OFF
                                  [N.b. Le Spie Free Heating e Free Cooling non
                                  vengnono computate] Esclusa anche Spie
                                  Inquinanti
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: Nessuna Allerta Free Heating -> Vel. Free Cooling
              - conditions:
                  - alias: >-
                      Verifica: Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato, Presenza di Inquinanti) oppure Allerta Free
                      Cooling Programmato (Riscaldamento Arrestato)
                    condition: template
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Cooling Programmato (Riscaldamento
                      Arrestato)'}}
                sequence:
                  - alias: >-
                      Ripeti Finchè Le Spie PdR Diventano OFF [N.b. Le Spie Free
                      Heating / Cooling non vengono computate] Escluse anche le
                      Spie Inquinanti
                    repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          action: input_boolean.turn_off
                      until:
                        - alias: >-
                            Verifica se Le Spie PdR Diventano OFF [N.b. Le Spie
                            Free Heating / Cooling non vengono computate]
                            Escluse anche le Spie Inquinanti
                          condition: template
                          value_template: >-
                            {{
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                            'off' and

                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                            'off' }}
                alias: >-
                  Presenze Allerte Arresto Free Cooling ->
                  spia_velocita_freecooling_un_solo_avvio=OFF
              - conditions:
                  - alias: >-
                      Verifica: Allerta Free Heating Programmato (Raffrescamento
                      Arrestato, Presenza di Inquinanti) oppure Allerta Free
                      Heating Programmato (Raffrescamento Arrestato)
                    condition: template
                    value_template: >-
                      {{states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato, Presenza di Inquinanti)' or
                      states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi')
                      == 'Allerta Free Heating Programmato (Raffrescamento
                      Arrestato)'}}
                sequence:
                  - alias: >-
                      Ripeti Finchè Le Spie PdR Diventano OFF [N.b. Le Spie Free
                      Heating / Cooling non vengono computate] Escluse anche le
                      Spie Inquinanti
                    repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                          action: input_boolean.turn_off
                      until:
                        - alias: >-
                            Verifica se Le Spie PdR Diventano OFF [N.b. Le Spie
                            Free Heating / Cooling non vengono computate]
                            Escluse anche le Spie Inquinanti
                          condition: template
                          value_template: >-
                            {{
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                            'off' and

                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                            'off' and 

                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                            'off' }}
                alias: >-
                  Presenze Allerte Arresto Free Heating ->
                  spia_velocita_freecooling_un_solo_avvio=OFF
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Free Cool./Heat. se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Iperventilazione No PdR se Spia Inquinanti ON
        sequence:
          - repeat:
              sequence:
                - alias: Ripeti FInchè Le Spie non Diventano OFF
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - alias: Verifica Tutti Le Spie OFF
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and 

                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_iperventilazione
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
        alias: >-
          Condizioni Favorevoli Ripristinate su Velocità Iperventilazione se
          Spia Congelamento Off e Spia Delta Temp Off e se se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
          precedentemente Armato ed Attivato -> Velocità 0 se Spia Inquinanti
          OFF
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione Lim. Δ P. di Rugiada, precedentemente Armato ed Attivato e Spia Inquinanti ON"
          - condition: template
            value_template: >-
              {{
              (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
              =='on' or
              states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
              =='on') and
              states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
              =='off' }}
            alias: Automazione PdR OFF e [almeno una Spia Velocità PdR ON]
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - alias: "Tutte le Spie PdR su OFF "
                          data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          action: input_boolean.turn_off
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          alias: >-
                            Imposta Velocità 1 a Causa dell'Inquinamento
                            presente
                          enabled: true
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Lim. Δ P. di Rugiada,
          precedentemente Armato ed Attivato -> Velocità 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: TeVsTi Free-Heating -> Imposta Velocità 0
        sequence:
          - alias: Lancia il Comando Velocità 0 Finchè la Velocità diventa Velocità 0
            repeat:
              sequence:
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_on
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_0
              until:
                - alias: Controlla se la Velocità è diversa da Velocità 0
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating
          -> Vel. 0 se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - TeVsTi Free-Heating e Spia Inquinanti ON
        sequence:
          - alias: Lancia il Comando Velocità 1 Finchè la Velocità diventa Velocità 1
            repeat:
              sequence:
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_on
                - metadata: {}
                  data: {}
                  target:
                    entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                  action: input_boolean.turn_on
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  action: input_boolean.turn_off
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_1
              until:
                - alias: Controlla se la Velocità è uguale a Velocità 1
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    1'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Heating
          se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: TeVsTi Free-Cooling -> Imposta Velocità 0
        sequence:
          - alias: Lancia il Comando Velocità 0 Finchè la Velocità diventa Velocità 0
            repeat:
              sequence:
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  action: input_boolean.turn_on
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_0
              until:
                - alias: Controlla se la Velocità è diversa da Velocità 0
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling
          -> Vel. 0  se Spia Congelamento Off e Spia Delta Temp Off e se se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - TeVsTi Free-Cooling e Spia Inquinanti ON
        sequence:
          - alias: Lancia il Comando Velocità 1 Finchè la Velocità diventa Velocità 1
            repeat:
              sequence:
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  action: input_boolean.turn_on
                - metadata: {}
                  data: {}
                  target:
                    entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                  action: input_boolean.turn_on
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_1
              until:
                - alias: Controlla se la Velocità è uguale a Velocità 1
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    1' and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'}}
        alias: >-
          Condizioni Sfavorevoli Temp. Ext Vs Temp. Int. a Velocità Free Cooling
          se Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: "Rip. Free Cooling No TeVsTi "
        sequence:
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
                - alias: Ripeti FInchè Le Spie Inquinamento non Diventano OFF
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                            - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        action: input_boolean.turn_off
                    until:
                      - alias: Verifica Tutti Le Spie OFF
                        condition: template
                        value_template: >-
                          {{ states('input_boolean.vmc_master_spia_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_freecooling
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
          Inquinanti OFF
      - conditions:
          - condition: trigger
            id: "Rip. Free Heating No TeVsTi "
        sequence:
          - alias: >-
              Lancia il Comando Velocità 0 Finchè la Velocità diventa Velocità
              FreeCooling
            repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  action: input_boolean.turn_off
                - alias: Ripeti FInchè Le Spie Inquinamento non Diventano OFF
                  repeat:
                    sequence:
                      - data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                            - >-
                              input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                            - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                            - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        action: input_boolean.turn_off
                    until:
                      - alias: Verifica Tutti Le Spie OFF
                        condition: template
                        value_template: >-
                          {{ states('input_boolean.vmc_master_spia_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'off' }}
                - data: {}
                  action: shell_command.vmc_master_freecooling
              until:
                - alias: Controlla se la Velocità è diversa da Velocità 0
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se se
          Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - Rip. Free Heating No TeVsTi e Spia Inquinanti ON
        sequence:
          - alias: >-
              Lancia il Comando Velocità Free Heating Finchè la Velocità diventa
              Velocità Free Heating
            repeat:
              sequence:
                - alias: Ripeti Finchè Le Spie seguono le Regole
                  repeat:
                    sequence:
                      - metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        action: input_boolean.turn_on
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        action: input_boolean.turn_off
                    until:
                      - condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'on' }}
                - data: {}
                  action: shell_command.vmc_master_freecooling
              until:
                - alias: Controlla se la Velocità è uguale a Velocità Free Heating
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Heating se Spia Congelamento Off e Spia Delta Temp Off e se Spia
          Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Rip. Free Cooling No TeVsTi e Spia Inquinanti ON
        sequence:
          - alias: >-
              Lancia il Comando Velocità Free Cooling Finchè la Velocità diventa
              Velocità Free Cooling
            repeat:
              sequence:
                - alias: Ripeti Finchè Le Spie seguono le Regole
                  repeat:
                    sequence:
                      - metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        action: input_boolean.turn_on
                      - data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                            - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            - >-
                              input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        action: input_boolean.turn_off
                    until:
                      - condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'on' }}
                - data: {}
                  action: shell_command.vmc_master_freecooling
              until:
                - alias: Controlla se la Velocità è uguale a Velocità Free Cooling
                  condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                    Cooling'}}
        alias: >-
          Condizioni Favorevoli Temp. Ext Vs Temp. Int. Ripristinate su Velocità
          Free Cooling se Spia Congelamento Off e Spia Delta Temp Off e se Spia
          Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - >-
                Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
                precedentemente Armato
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - alias: Imposta Velocità 0
                          data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and 
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                            and
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating
                    enabled: true
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
          precedentemente Armato -> Vel. 0 se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating precedentemente Armato e Spia Inquinanti ON"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: >-
                      Lancia il Comando Velocità 0 Finchè la Velocità diventa
                      Velocità 1
                    repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          alias: >-
                            Imposta Velocità 1 a Causa dell'Inquinamento
                            presente
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - alias: Controlla se la Velocità è uguale a Velocità 1
                          condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freeheating
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Heating
          precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - >-
                Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
                precedentemente Armato
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - alias: Imposta Velocità 0
                          data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and 
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                            and
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling
                    enabled: true
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
          precedentemente Armato -> Vel. 0 se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling precedentemente Armato e Spia Inquinanti ON"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: >-
                      Lancia il Comando Velocità 0 Finchè la Velocità diventa
                      Velocità 1
                    repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          alias: >-
                            Imposta Velocità 1 a Causa dell'Inquinamento
                            presente
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - alias: Controlla se la Velocità è uguale a Velocità 1
                          condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_freecooling
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione VMC ON/OFF, in Funzione della Vel. Free Cooling
          precedentemente Armato  -> Vel. 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 0
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_off
        alias: >-
          Black-Out Velocità 0 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
          CALENDARIO E' ON] 
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 0
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'}}
                sequence:
                  - data: {}
                    action: shell_command.vmc_master_velocita_0
                alias: PdR Velocità 0 ON
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'}}
                sequence:
                  - data: {}
                    action: shell_command.vmc_master_velocita_1
                alias: PdR Velocità 1 ON
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'}}
                sequence:
                  - action: shell_command.vmc_master_velocita_2
                    data: {}
                alias: PdR Velocità 2 ON
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'}}
                sequence:
                  - action: shell_command.vmc_master_velocita_3
                    data: {}
                alias: PdR Velocità 3 ON
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'}}
                sequence:
                  - action: shell_command.vmc_master_velocita_4
                    data: {}
                alias: PdR Velocità 4 ON
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'}}
                sequence:
                  - action: shell_command.vmc_master_notturna
                    data: {}
                alias: PdR Velocità Notturna
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'}}
                sequence:
                  - action: shell_command.vmc_master_freecooling
                    data: {}
                alias: PdR Velocità Free Cooling/ Heating
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'}}
                sequence:
                  - action: shell_command.vmc_master_iperventilazione
                    data: {}
                alias: PdR Velocità Iperventilazione
              - conditions:
                  - condition: template
                    value_template: >-
                      {{ ( ( states('input_boolean.vmc_master_spia_co2_o_voc')==
                      'on'and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on') or (
                      states('input_boolean.vmc_master_spia_co2_o_voc')==
                      'on'and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on' ) ) }} 
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0
                  - data: {}
                    action: shell_command.vmc_master_velocita_1
                alias: Inquinanti ON, Partenza Vel.0 -> Vel. 1
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
            action: input_boolean.turn_off
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 1
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_1
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_off
        alias: >-
          Black-Out Velocità 1 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
          CALENDARIO E' ON] e [SPIE INQUINANTI OFF] e [SPIE FREECOOLING e
          FREEHEAING OFF]
      - conditions:
          - condition: trigger
            id:
              - >-
                Black-Out a Velocità 1 caso [SPIE INQUINANTI ON] e [SPIE
                FREECOOLING ON o FREEHEAING ON]
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            action: input_boolean.turn_off
        alias: >-
          Black-Out Velocità 1 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
          CALENDARIO E' ON] e [SPIE INQUINANTI ON] e [SPIE FREECOOLING ON o
          FREEHEAING ON]
      - conditions:
          - condition: trigger
            id:
              - >-
                Black-Out a Velocità 1 caso [SPIE INQUINANTI ON] e [SPIE
                FREECOOLING OFF e FREEHEAING OFF]
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{ ( ( states('input_boolean.vmc_master_spia_co2_o_voc')==
                      'on'and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on') or (
                      states('input_boolean.vmc_master_spia_co2_o_voc')==
                      'on'and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on' ) ) }} 
                sequence:
                  - data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0
                    action: input_boolean.turn_on
                  - data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_1
                        - input_boolean.vmc_master_spia_velocita_2
                        - input_boolean.vmc_master_spia_velocita_3
                        - input_boolean.vmc_master_spia_velocita_4
                        - input_boolean.vmc_master_spia_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione
                        - input_boolean.vmc_master_spia_velocita_freecooling
                    action: input_boolean.turn_off
                alias: Inquinanti ON, Partenza Vel.0 -> Vel. 1
              - conditions:
                  - condition: template
                    value_template: >-
                      {{ not( (
                      states('input_boolean.vmc_master_spia_co2_o_voc')==
                      'on'and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on') or (
                      states('input_boolean.vmc_master_spia_co2_o_voc')==
                      'on'and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on' ) ) }} 
                sequence:
                  - data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_1
                    action: input_boolean.turn_on
                  - data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0
                        - input_boolean.vmc_master_spia_velocita_2
                        - input_boolean.vmc_master_spia_velocita_3
                        - input_boolean.vmc_master_spia_velocita_4
                        - input_boolean.vmc_master_spia_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione
                        - input_boolean.vmc_master_spia_velocita_freecooling
                    action: input_boolean.turn_off
                alias: "Diverso da: Inquinanti ON, Partenza Vel.0 -> Vel. 1"
        alias: >-
          Black-Out Velocità 1 [ON] - [RILEVAZIONE DISATTIVATA SE SPIA GIORNO
          CALENDARIO E' ON] e [SPIE INQUINANTI ON] e [SPIE FREECOOLING OFF e
          FREEHEAING OFF]
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 1
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
            action: input_boolean.turn_off
          - data: {}
            action: shell_command.vmc_master_velocita_1
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 2
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_2
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_off
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 2
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            enabled: true
            action: input_boolean.turn_off
          - data: {}
            action: shell_command.vmc_master_velocita_2
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 3
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_3
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_off
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 3
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
            action: input_boolean.turn_off
          - data: {}
            action: shell_command.vmc_master_velocita_3
      - conditions:
          - condition: trigger
            id: Black-Out a Velocità 4
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_4
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_off
      - conditions:
          - condition: trigger
            id: Black-Out Off Vel. 4
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
            action: input_boolean.turn_off
          - data: {}
            action: shell_command.vmc_master_velocita_4
      - conditions:
          - condition: trigger
            id: Black-Out Notturna
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_notturna
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_iperventilazione
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_off
      - conditions:
          - condition: trigger
            id: Black-Out Off Notturna
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
            action: input_boolean.turn_off
          - data: {}
            action: shell_command.vmc_master_notturna
      - conditions:
          - condition: trigger
            id: Black-Out Iperventilazione
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_off
      - conditions:
          - condition: trigger
            id: Black-Out Off Iperventilazione
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
            action: input_boolean.turn_off
          - data: {}
            action: shell_command.vmc_master_iperventilazione
      - conditions:
          - condition: trigger
            id: Black-Out Free Cool./Heat.
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_freecooling
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            action: input_boolean.turn_off
      - conditions:
          - condition: trigger
            id: Black-Out Off Free Cool./Heat.
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_0
                - input_boolean.vmc_master_spia_velocita_1
                - input_boolean.vmc_master_spia_velocita_2
                - input_boolean.vmc_master_spia_velocita_3
                - input_boolean.vmc_master_spia_velocita_4
                - input_boolean.vmc_master_spia_velocita_notturna
                - input_boolean.vmc_master_spia_velocita_freecooling
                - input_boolean.vmc_master_spia_velocita_iperventilazione
            enabled: true
            action: input_boolean.turn_off
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_co2_o_voc')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                      and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')
                      }}
                sequence:
                  - data: {}
                    action: shell_command.vmc_master_freecooling
                alias: >-
                  [SPIE INQUINANTI OFF] e [SPIE FREECOOLING OFF e FREEHEAING
                  OFF]
              - conditions:
                  - alias: >-
                      [SPIE INQUINANTI ON] e [SPIE FREECOOLING OFF e FREEHEAING
                      OFF]
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')}}
                sequence:
                  - data: {}
                    action: shell_command.vmc_master_freecooling
                alias: "[SPIE INQUINANTI ON] e [SPIE FREECOOLING OFF e FREEHEAING OFF]"
              - conditions:
                  - alias: >-
                      ([SPIE INQUINANTI OFF] e [SPIE FREECOOLING ON o FREEHEAING
                      ON]) 
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_co2_o_voc')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                      and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
                      )  }}
                sequence:
                  - action: shell_command.vmc_master_freecooling
                    metadata: {}
                    data: {}
              - conditions:
                  - alias: >-
                      ([SPIE INQUINANTI ON] e [SPIE FREECOOLING ON o FREEHEAING
                      ON])
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                      and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on')
                      )}}
                sequence:
                  - action: shell_command.vmc_master_velocita_1
                    metadata: {}
                    data: {}
      - conditions:
          - condition: trigger
            id: 1° Lunedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_1
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Lunedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_1
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Lunedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_2
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Lunedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_lunedi_2
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Martedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_1
            action: input_boolean.turn_on
          - metadata: {}
            data: {}
            action: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Martedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_1
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Martedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_2
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Martedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_martedi_2
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Mercoledì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_1
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Mercoledì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_1
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Mercoledì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_2
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Mercoledì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_mercoledi_2
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Giovedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_1
            action: input_boolean.turn_on
          - metadata: {}
            data: {}
            action: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Giovedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_1
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Giovedì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_2
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Giovedì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_giovedi_2
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Venerdì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_1
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Venerdì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_1
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Venerdì On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_2
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Venerdì Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_venerdi_2
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Sabato On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_1
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Sabato Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_1
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Sabato On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_2
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Sabato Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_sabato_2
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 1° Domenica On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_1
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_1_on
      - conditions:
          - condition: trigger
            id: 1° Domenica Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_1
            action: input_boolean.turn_off
          - metadata: {}
            data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: 2° Domenica On
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_2
            action: input_boolean.turn_on
          - data: {}
            action: script.vmc_master_calendario_fascia_2_on
      - conditions:
          - condition: trigger
            id: 2° Domenica Off
          - condition: state
            entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
            state: "on"
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_calendario_domenica_2
            action: input_boolean.turn_off
          - data: {}
            action: script.vmc_master_calendario_fascia_1_o_2_off
      - conditions:
          - condition: trigger
            id: Calendario Off tra Fascie
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_calendario_lunedi_1
                        - input_boolean.vmc_master_spia_calendario_lunedi_2
                        - input_boolean.vmc_master_spia_calendario_martedi_1
                        - input_boolean.vmc_master_spia_calendario_martedi_2
                        - input_boolean.vmc_master_spia_calendario_mercoledi_1
                        - input_boolean.vmc_master_spia_calendario_mercoledi_2
                        - input_boolean.vmc_master_spia_calendario_giovedi_1
                        - input_boolean.vmc_master_spia_calendario_giovedi_2
                        - input_boolean.vmc_master_spia_calendario_venerdi_1
                        - input_boolean.vmc_master_spia_calendario_venerdi_2
                        - input_boolean.vmc_master_spia_calendario_sabato_1
                        - input_boolean.vmc_master_spia_calendario_sabato_2
                        - input_boolean.vmc_master_spia_calendario_domenica_1
                        - input_boolean.vmc_master_spia_calendario_domenica_2
                        - input_boolean.vmc_master_spia_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Calendario ,
          precedentemente Armato ed Attivato tra le Fascie del Calendario ->
          Velocità 0 se Spia Inquinanti OFF
      - conditions:
          - condition: trigger
            id:
              - Calendario Off tra Fascie e Spia Inquinanti ON
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: "Tutte le Spie dei Giorni del Calendario su OFF "
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_calendario_lunedi_1
                        - input_boolean.vmc_master_spia_calendario_lunedi_2
                        - input_boolean.vmc_master_spia_calendario_martedi_1
                        - input_boolean.vmc_master_spia_calendario_martedi_2
                        - input_boolean.vmc_master_spia_calendario_mercoledi_1
                        - input_boolean.vmc_master_spia_calendario_mercoledi_2
                        - input_boolean.vmc_master_spia_calendario_giovedi_1
                        - input_boolean.vmc_master_spia_calendario_giovedi_2
                        - input_boolean.vmc_master_spia_calendario_venerdi_1
                        - input_boolean.vmc_master_spia_calendario_venerdi_2
                        - input_boolean.vmc_master_spia_calendario_sabato_1
                        - input_boolean.vmc_master_spia_calendario_sabato_2
                        - input_boolean.vmc_master_spia_calendario_domenica_1
                        - input_boolean.vmc_master_spia_calendario_domenica_2
                        - input_boolean.vmc_master_spia_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                    action: input_boolean.turn_off
                  - data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                        - >-
                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                        - input_boolean.vmc_master_spia_co2_o_voc
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    alias: Imposta Velocità 1 a Causa dell'Inquinamento presente
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_calendario
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: >-
          Disattivazione: VMC ON/OFF, in Funzione del Calendario ,
          precedentemente Armato ed Attivato tra le Fascie del Calendario ->
          Velocità 1 se Spia Inquinanti ON
      - conditions:
          - condition: trigger
            id:
              - Cambio Nome VMC
        sequence:
          - data: {}
            action: shell_command.vmc_master_rimuovi_caratteri_di_ritorno
          - alias: Chiama il Servizio per Cambiare nome alla VMC
            data: {}
            action: shell_command.vmc_master_cambia_nome
          - delay:
              hours: 0
              minutes: 0
              seconds: 4
              milliseconds: 0
          - data: {}
            target:
              entity_id:
                - sensor.vmc_master_nome
            action: homeassistant.update_entity
          - data:
              value: ""
            target:
              entity_id: input_text.vmc_master_nome_da_inserire
            action: input_text.set_value
        alias: Rinomina VMC
      - conditions:
          - condition: trigger
            id:
              - Riscrivi IP
        sequence:
          - alias: Verifica se l'IP è Valido o Meno
            choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{ (states('sensor.vmc_master_verifica_ip_inserito') !=
                      "IP non Valido") }}
                sequence:
                  - data: {}
                    action: shell_command.vmc_master_rimuovi_caratteri_di_ritorno
                  - data: {}
                    action: shell_command.vmc_master_aggiorna_indirizzo_ip
                  - delay:
                      hours: 0
                      minutes: 0
                      seconds: 2
                      milliseconds: 0
                  - data: {}
                    action: homeassistant.restart
                alias: IP Inserito Valido
              - conditions:
                  - condition: template
                    value_template: >-
                      {{ (states('sensor.vmc_master_verifica_ip_inserito') ==
                      "IP non Valido") }}
                sequence:
                  - data:
                      value: ""
                    target:
                      entity_id: input_text.vmc_master_ip_insert
                    action: input_text.set_value
                alias: IP Inserito NON Valido
        alias: Cambio Indirizzo IP della VMC (Riavvio di H.A.)
      - conditions:
          - condition: trigger
            id: Spia Avvisi On
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi_spia
            action: input_boolean.turn_on
        alias: Spia Avvisi On
      - conditions:
          - condition: trigger
            id: Spia Avvisi Off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_opzioni_accendi_spegni_avvisi_spia
            action: input_boolean.turn_off
        alias: Spia Avvisi Off
      - conditions:
          - condition: trigger
            id:
              - Repository Update ON
            enabled: true
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_popup_versione_corrente_vs_repository
            action: input_boolean.turn_on
          - data:
              message: >-
                Una nuova revisione è stata rilasciata
                [Link](https://github.com/DanRobo76/VMC-HELTY-FLOW)
              title: AGGIORNAMENTO SUL REPOSITORY VMC HELTY FLOW
            action: notify.persistent_notification
        alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - ON
      - conditions:
          - condition: trigger
            id:
              - Repository Update OFF
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_popup_versione_corrente_vs_repository
            action: input_boolean.turn_off
        alias: Verifica Aggiornamenti Repository VMC-HELTY-FLOW - OFF
      - conditions:
          - condition: trigger
            id:
              - inquinanti_co2_voc_on
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_co2_o_voc
            action: input_boolean.turn_on
          - choose:
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 1 o Spia Inquinanti su
                      Velocità 1
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 1 o Spia Inquinanti su
                  Velocità 1
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 2 o Spia Inquinanti su
                      Velocità 2
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                action: input_boolean.turn_on
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_2
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            2'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 2 o Spia Inquinanti su
                  Velocità 2
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 3 o Spia Inquinanti su
                      Velocità 3
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                action: input_boolean.turn_on
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_3
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            3'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 3 o Spia Inquinanti su
                  Velocità 3
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità 4 o Spia Inquinanti su
                      Velocità 4
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                action: input_boolean.turn_on
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_4
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            4'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 4 o Spia Inquinanti su
                  Velocità 4
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Notturna o Spia Inquinanti
                      su Velocità Notturna
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                action: input_boolean.turn_on
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_notturna
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Notturna o Spia Inquinanti
                  su Velocità Notturna
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Iperventilazione o Spia
                      Inquinanti su Velocità Iperventilazione
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti FInchè Le Spie rispettano Le Regole
                          repeat:
                            sequence:
                              - metadata: {}
                                data: {}
                                target:
                                  entity_id:
                                    - input_boolean.vmc_master_spia_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                action: input_boolean.turn_on
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')==
                                  'on' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_iperventilazione
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Iperventilazione o Spia
                  Inquinanti su Velocità Iperventilazione
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Free Heating/Cooling o Spia
                      Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                      Heatin OFF e SPia Free Cooling OFF
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')
                      and (
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') ) }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Heating/Cooling o
                  Spia Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                  Heatin OFF e SPia Free Cooling OFF
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR su Velocità Free Heating/Cooling o Spia
                      Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                      Heatin ON oppure SPia Free Cooling ON
                    condition: template
                    value_template: >-
                      {{ (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')
                      and (
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on') ) }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Heating/Cooling o
                  Spia Inquinanti su Velocità Free Heating/Cooling e SPIA Free
                  Heatin ON oppure SPia Free Cooling ON
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                      (FreeHeating Programmato Off e FreeCooling Programmato
                      Off)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'}}
                sequence:
                  - data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                    enabled: true
                    action: input_boolean.turn_off
                alias: >-
                  Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                  (FreeHeating Programmato Off e FreeCooling Programmato Off)
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                      (FreeHeating Programmato su On o FreeCooling Programmato
                      su On)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')!='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on')
                      }}
                sequence:
                  - data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                    action: input_boolean.turn_off
                alias: >-
                  Velocità diversa da 0 e con PdR Off su tutte le Velocità e
                  (FreeHeating Programmato su On o FreeCooling Programmato su
                  On)
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR On  su qualsiasi Velocità
                      e (FreeHeating Programmato su Off e FreeCooling
                      Programmato su Off)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                      != 'Velocità 0' and
                      (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'on') and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
                      == 'off') }}
                sequence:
                  - data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                    action: input_boolean.turn_off
                alias: >-
                  Velocità diversa da 0 e con PdR On  su qualsiasi Velocità e
                  (FreeHeating Programmato su Off e FreeCooling Programmato su
                  Off)
              - conditions:
                  - alias: >-
                      Velocità diversa da 0 e con PdR On  su qualsiasi Velocità
                      e (FreeHeating Programmato su On o FreeCooling Programmato
                      su On)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                      != 'Velocità 0' and
                      (states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'on') and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')
                      == 'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')
                      == 'on') }}
                sequence:
                  - data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                    action: input_boolean.turn_off
                alias: >-
                  Velocità diversa da 0 e con PdR On  su qualsiasi Velocità e
                  (FreeHeating Programmato su On o FreeCooling Programmato su
                  On)
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                      Programmato su Off e FreeCooling Programmato su Off) e
                      Velocità !=Free Cool./Heat.
                    condition: template
                    enabled: true
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')!="Free
                      Cool./Heat."}}
                  - condition: template
                    value_template: >-
                      {{(states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'off')}}
                    alias: >-
                      Spia Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free
                      Heating Inquinamento = Off
                    enabled: true
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          enabled: true
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                  Programmato su Off e FreeCooling Programmato su Off) e Spia
                  Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free Heating
                  Inquinamento = Off
              - conditions:
                  - alias: >-
                      Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                      Programmato su On o FreeCooling Programmato su On)
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and 
                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')
                      == 'off'  and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')
                      =='off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')
                      == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')
                      == 'off' and
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                      or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on')}}
                  - condition: template
                    value_template: >-
                      {{(states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'off')}}
                    alias: >-
                      Spia Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free
                      Heating Inquinamento = Off
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - metadata: {}
                          data: {}
                          target:
                            entity_id: >-
                              input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Velocità 0 con PdR Off su tutte le Velocità e (FreeHeating
                  Programmato su On o FreeCooling Programmato su On) e Spia
                  Velocità 1, 2, 3, 4, Notturna, Iperventilazione, Free Heating
                  Inquinamento = Off
        alias: >-
          Attivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati se Spia
          Congelamento Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - inquinanti_co2_voc_off
        sequence:
          - data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_co2_o_voc
            action: input_boolean.turn_off
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                      or
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'}}
                    enabled: true
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id:
                                      - input_boolean.vmc_master_spia_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_velocita_0
                                - delay:
                                    hours: 0
                                    minutes: 0
                                    seconds: 4
                                    milliseconds: 0
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    0'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - input_boolean.vmc_master_spia_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: >-
                  vmc_master_spia_velocita_0_co2_o_voc=on o
                  vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0=on
              - conditions:
                  - alias: >-
                      Verifica che la Spia Inquinamento Velocità 1 è ON e Spia
                      Partenza e Ritorno a Velocità 0 sia OFF e
                      vmc_master_spia_velocita_1_co2_o_voc_pdr=OFF e Spia
                      FreeHeating e Free Cooling siano OFF
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                      and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                  enabled: true
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_velocita_1
                              until:
                                - condition: template
                                  value_template: "      {{ states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità 1'}}"
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            enabled: true
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 1
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_velocita_2
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    2'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 2
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_velocita_3
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    3'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 3
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_velocita_4
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                                    4'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità 4
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_notturna
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità Notturna
              - conditions:
                  - condition: template
                    value_template: " {{states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'}}"
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id: >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_iperventilazione
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità Iperventilazione
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                      or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on')}}
                sequence:
                  - choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'off' and
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                              }}
                            alias: se Spia Congelamento Off e Spia Delta Temp Off
                        sequence:
                          - repeat:
                              sequence:
                                - data: {}
                                  target:
                                    entity_id:
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                      - >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                  action: input_boolean.turn_off
                                - data: {}
                                  action: shell_command.vmc_master_freecooling
                              until:
                                - condition: template
                                  value_template: >-
                                    {{
                                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                                    Cooling'}}
                        alias: se Spia Congelamento Off e Spia Delta Temp Off
                      - conditions:
                          - alias: se Spia Congelamento ON o Spia Delta Temp ON
                            condition: template
                            value_template: >-
                              {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                              'on' or
                              states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                              }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                            action: input_boolean.turn_off
                        alias: se Spia Congelamento ON o Spia Delta Temp ON
                alias: Ritorno a Velocità Free Heating/Cooling
        alias: >-
          Disattivazione Automatica VMC per Inquinanti CO2 e/o VOC Rilevati se
          se Spia Congelamento Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_0_inquinanti_co2_voc
        sequence:
          - choose:
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          Verifica a Velocità 0 e Almeno una Spia Inquinamento
                          ON e Spia un solo Avvio (FreeCooling o Heating) OFF
                        condition: template
                        value_template: >-
                          {{(
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'on' or
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'on' ) and
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          0' and
                          (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                          'off')}}
                      - alias: Verifica che Tutte le Spie PdR siano su OFF
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                          and 
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                          }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica a Velocità 0 e Almeno una Spia Inquinamento ON e Spia
                  un solo Avvio (FreeCooling o Heating) OFF e Tutte le Spie PdR
                  OFF
              - conditions:
                  - condition: and
                    conditions:
                      - alias: Verifica che Tutte le Spie PdR siano su OFF
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                          and 
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                          }}
                      - condition: template
                        value_template: >-
                          {{
                          (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                          'off')}}
                        alias: Verifica che Tutte le Spie Inquinamento siano su OFF
                      - alias: >-
                          Verifica che non siano attive le Spie Free Heating e
                          Free Cooling e
                          vmc_master_spia_velocita_1_co2_o_voc_pdr OFF e Spia
                          Velocità PdR Free Heating/Cooling OFF
                        condition: template
                        value_template: >-
                          {{
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                          'off' and (
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                          ) }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica che non siano attive le Spie Free Heating e Free
                  Cooling e vmc_master_spia_velocita_1_co2_o_voc_pdr OFF e Spia
                  Velocità PdR Free Heating/Cooling OFF
              - conditions:
                  - alias: >-
                      Verifica Velocità 0 e Almeno una Spia Inquinamento ON e
                      (Spia un solo Avvio FreeCooling o Heating ON)
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'on' or
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'on' ) and
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and
                      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')
                      or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'))}}
                    enabled: true
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica Velocità 0 e Almeno una Spia Inquinamento ON e (Spia
                  un solo Avvio FreeCooling o Heating ON)
              - conditions:
                  - alias: >-
                      Verifica Velocità 0 e Tutte le Spia Inquinamento OFF e
                      (Spia un solo Avvio FreeCooling o Heating ON)
                    condition: template
                    value_template: >-
                      {{(
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')==
                      'off' ) and
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and
                      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off')
                      or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'))
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Verifica Velocità 0 e Tutte le Spia Inquinamento OFF e (Spia
                  un solo Avvio FreeCooling o Heating ON)
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 1 ON e Spia Inquinanti
                      su Velocità 1 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 1 ON e Spia Inquinanti su
                  Velocità 1 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 1 OFF e Spia
                      Inquinanti su Velocità 1 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 1 OFF e Spia Inquinanti su
                  Velocità 1 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 2 ON e Spia Inquinanti
                      su Velocità 2 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 2 ON e Spia Inquinanti su
                  Velocità 2 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 2 OFF e Spia
                      Inquinanti su Velocità 2 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_velocita_2
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            2'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 2 OFF e Spia Inquinanti su
                  Velocità 2 ON -> Velocità 2
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 3 ON e Spia Inquinanti
                      su Velocità 3 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 3 ON e Spia Inquinanti su
                  Velocità 3 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 3 OFF e Spia
                      Inquinanti su Velocità 3 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_velocita_3
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            3'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 3 OFF e Spia Inquinanti su
                  Velocità 3 ON -> Velocità 3
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 4 ON e Spia Inquinanti
                      su Velocità 4 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 4 ON e Spia Inquinanti su
                  Velocità 4 ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità 4 OFF e Spia
                      Inquinanti su Velocità 4 ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_velocita_4
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            4'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità 4 OFF e Spia Inquinanti su
                  Velocità 4 ON -> Velocità 4
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Notturna ON e Spia
                      Inquinanti su Velocità Notturna ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Notturna ON e Spia
                  Inquinanti su Velocità Notturna ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Notturna OFF e Spia
                      Inquinanti su Velocità Notturna ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_notturna
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Notturna OFF e Spia
                  Inquinanti su Velocità Notturna ON -> Velocità Notturna
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Iperventilazione ON e
                      Spia Inquinanti su Velocità Iperventilazione ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Iperventilazione ON e Spia
                  Inquinanti su Velocità Iperventilazione ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Iperventilazione OFF e
                      Spia Inquinanti su Velocità IPerventilazione ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_iperventilazione
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Iperventilazione OFF e
                  Spia Inquinanti su Velocità Iperventilazione ON -> Velocità
                  Iperventilazione
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Free Cooling ON e Spia
                      Inquinanti su Velocità Free Cooling ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Cooling ON e Spia
                  Inquinanti su Velocità Free Cooling ON -> Velocità 1
              - conditions:
                  - alias: >-
                      Caso Velocità 0 con PdR su Velocità Free Cooling OFF e
                      Spia Inquinanti su Velocità Free Cooling ON
                    condition: template
                    value_template: >-
                      {{
                      states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                      0' and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on')}}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                    enabled: true
                alias: >-
                  Caso Velocità 0 con PdR su Velocità Free Cooling OFF e Spia
                  Inquinanti su Velocità Free Cooling ON -> Velocità Free
                  Cooling
        alias: >-
          Spia Velocità 0 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_1_inquinanti_co2_voc
        sequence:
          - alias: 4 Casistiche
            choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'on'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                        - >-
                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                          action: input_boolean.turn_off
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            }}
                  - metadata: {}
                    data: {}
                    action: shell_command.vmc_master_velocita_1
                alias: vmc_master_spia_velocita_1_co2_o_voc_pdr ON
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling/Heating è OFF e Spia FreeCooling PdR ON
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'off') and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                      )}}
                sequence:
                  - data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                    enabled: true
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                          enabled: true
                          action: input_boolean.turn_off
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'}}
                  - metadata: {}
                    data: {}
                    action: shell_command.vmc_master_freecooling
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling/Heating è OFF e Spia FreeCooling PdR ON
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è ON oppure la Spia1°
                      Avvio Free Cooling è ON e
                      vmc_master_spia_velocita_1_co2_o_voc_pdr OFF
                    condition: template
                    value_template: >-
                      {{
                      ((states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off') or
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on')) and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'off'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_off
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                  - metadata: {}
                    data: {}
                    action: shell_command.vmc_master_velocita_1
                alias: >-
                  Se la Spia 1° Avvio Free Heating è ON oppure la Spia1° Avvio
                  Free Cooling è ON e vmc_master_spia_velocita_1_co2_o_voc_pdr
                  OFF
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling/Heating è OFF e Spia FreeCooling PdR OFF e
                      vmc_master_spia_velocita_1_co2_o_voc_pdr' OFF
                    condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')==
                      'off') and (
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='off')}}
                sequence:
                  - data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                    enabled: true
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          enabled: true
                          action: input_boolean.turn_off
                        - metadata: {}
                          data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            }}
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling/Heating è OFF e Spia FreeCooling PdR OFF e
                  vmc_master_spia_velocita_1_co2_o_voc_pdr' OFF
        alias: >-
          Spia Velocità 1 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_2_inquinanti_co2_voc
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_co2_o_voc
                - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
            action: input_boolean.turn_on
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità 2 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_3_inquinanti_co2_voc
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
            action: input_boolean.turn_on
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità 3 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_4_inquinanti_co2_voc
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
            action: input_boolean.turn_on
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità 4 CO₂ e/o VOC se Spia Congelamento Off e Spia Delta Temp
          Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_notturna_inquinanti_co2_voc
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
            action: input_boolean.turn_on
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità Notturna CO₂ e/o VOC se Spia Congelamento Off e Spia
          Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_iperventilazione_inquinanti_co2_voc
        sequence:
          - data: {}
            target:
              entity_id:
                - >-
                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                - input_boolean.vmc_master_spia_co2_o_voc
            action: input_boolean.turn_on
          - repeat:
              sequence:
                - data: {}
                  target:
                    entity_id:
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                      - >-
                        input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                      - input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                      - input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      - >-
                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
              until:
                - condition: template
                  value_template: >-
                    {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                    and
                    states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
        alias: >-
          Spia Velocità iperventilazione CO₂ e/o VOC se Spia Congelamento Off e
          Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - spia_velocita_freecooling_inquinanti_co2_voc
        sequence:
          - alias: Spie 1° Avvio Free Heating e 1° Avvio Free Cooling sono OFF
            choose:
              - conditions:
                  - alias: >-
                      Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio
                      Free Cooling è OFF
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off'}}
                sequence:
                  - data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                    enabled: true
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                    - >-
                                      input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                enabled: true
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >-
                                  {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                                  and
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: >-
                  Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è OFF
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'on' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'off')}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_off
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                  - metadata: {}
                    data: {}
                    action: shell_command.vmc_master_velocita_1
                alias: >-
                  Se la Spia 1° Avvio Free Heating è OFF e la Spia1° Avvio Free
                  Cooling è ON
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      (states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')==
                      'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')==
                      'on') }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                    enabled: true
                    action: input_boolean.turn_on
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                          action: input_boolean.turn_off
                      until:
                        - condition: template
                          value_template: >-
                            {{states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='off'
                            and
                            states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='off'}}
                    enabled: true
                  - metadata: {}
                    data: {}
                    action: shell_command.vmc_master_velocita_1
                alias: >-
                  Se la Spia 1° Avvio Free Heating è ON oppure la Spia1° Avvio
                  Free Cooling è OFF
        alias: >-
          Spia Velocità Free Heating/Cooling CO₂ e/o VOC se Spia Congelamento
          Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato"
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'off' and
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='off'
                      }}
                    alias: se Spia Congelamento Off e Spia Delta Temp Off
                sequence:
                  - alias: >-
                      Lancia il Comando Velocità 0 Finchè la Velocità diventa
                      Velocità 0
                    repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - alias: Controlla se la Velocità è diversa da Velocità 0
                          condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: se Spia Congelamento Off e Spia Delta Temp Off
              - conditions:
                  - alias: se Spia Congelamento ON o Spia Delta Temp ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                      'on' or
                      states('input_boolean.vmc_master_delta_temp_verifica_soglia_valore_spia')=='on'
                      }}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_co2_e_voc
                    action: input_boolean.turn_on
                alias: se Spia Congelamento ON o Spia Delta Temp ON
        alias: " Disattivazione VMC per Inquinanti CO2 e/o VOC, precedentemente Armato ed Attivato -> Tutte le Spie CO2 e/o VOC OFF -> Vel. 0 "
      - conditions:
          - condition: or
            conditions:
              - condition: trigger
                id:
                  - Congelamento ON
              - condition: trigger
                id:
                  - spia_velocita_0_congelamento
              - condition: trigger
                id:
                  - spia_velocita_1_congelamento
              - condition: trigger
                id:
                  - spia_velocita_2_congelamento
              - condition: trigger
                id:
                  - spia_velocita_3_congelamento
              - condition: trigger
                id:
                  - spia_velocita_4_congelamento
              - condition: trigger
                id:
                  - spia_velocita_iperventilazione_congelamento
              - condition: trigger
                id:
                  - spia_velocita_notturna_congelamento
              - condition: trigger
                id:
                  - spia_velocita_Free Cooling_congelamento
        sequence:
          - metadata: {}
            data: {}
            target:
              entity_id: >-
                input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
            alias: Attivazione Spia Congelamento ≤ -18 [°C] Temp. Esterna
            action: input_boolean.turn_on
          - alias: >-
              Attivazione Velocità Spia Congelamento in Funzione della Tipologia
              di Velocità
            choose:
              - conditions:
                  - condition: or
                    conditions:
                      - condition: trigger
                        id:
                          - spia_velocita_0_congelamento
                        alias: Velocità 0
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          0'}}
                        enabled: true
                sequence:
                  - alias: >-
                      Verifica se mettere la Spia Congelamento Velocità 0 su ON
                      o su OFF in funzione della Velocità Precedentemente
                      impostata
                    if:
                      - condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                          'off' and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                          'off'}}
                        alias: Tutte le Spie Congelamento sono Off
                    then:
                      - metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_velocita_0_congelamento
                        action: input_boolean.turn_on
                    else:
                      - metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - >-
                              input_boolean.vmc_master_spia_velocita_0_congelamento
                        enabled: true
                        action: input_boolean.turn_off
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità 0
              - conditions:
                  - condition: or
                    conditions:
                      - alias: Velocità 1
                        condition: trigger
                        id:
                          - spia_velocita_1_congelamento
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          1'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_1_congelamento
                    action: input_boolean.turn_on
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                    action: input_boolean.turn_off
                  - alias: Verifica Status Spia Free Cooling / Free Heating
                    choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                              and
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                              }}
                        sequence:
                          - alias: Verifica Status Spie Inquinanti e Spie PdR
                            choose:
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - alias: Verifica Spia Richiamo Inquinanti
                                    choose:
                                      - conditions:
                                          - condition: state
                                            entity_id: >-
                                              input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                            state: "off"
                                        sequence:
                                          - data: {}
                                            target:
                                              entity_id:
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                                - >-
                                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                            alias: Spie Inquinanti OFF
                                            action: input_boolean.turn_off
                                          - data: {}
                                            target:
                                              entity_id:
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                            alias: Spie PdR OFF
                                            action: input_boolean.turn_off
                                          - metadata: {}
                                            data: {}
                                            target:
                                              entity_id: >-
                                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                            action: input_boolean.turn_on
                                          - metadata: {}
                                            data: {}
                                            target:
                                              entity_id: >-
                                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                            action: input_boolean.turn_off
                                        alias: Verifica Spia Richiamo Inquinanti OFF
                                      - conditions:
                                          - condition: state
                                            entity_id: >-
                                              input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                            state: "on"
                                        sequence:
                                          - data: {}
                                            target:
                                              entity_id:
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                                - >-
                                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                            alias: Spie Inquinanti OFF
                                            action: input_boolean.turn_off
                                          - data: {}
                                            target:
                                              entity_id:
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                            alias: Spie PdR OFF
                                            action: input_boolean.turn_off
                                          - metadata: {}
                                            data: {}
                                            target:
                                              entity_id:
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                                - >-
                                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                                - >-
                                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                            action: input_boolean.turn_on
                                          - metadata: {}
                                            data: {}
                                            target:
                                              entity_id: >-
                                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                            action: input_boolean.turn_off
                                        alias: Verifica Spia Richiamo Inquinanti ON
                                alias: Spie Inquinanti ON Pdr OFF
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    action: input_boolean.turn_on
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti ON Pdr ON
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                alias: Spie Inquinanti OFF Pdr OFF
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti OFF Pdr ON
                        alias: Spia Free Heating OFF e Spia Free Colling OFF
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                              or
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                              }}
                        sequence:
                          - alias: Verifica Status Spie Inquinanti e Spie PdR
                            choose:
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    action: input_boolean.turn_on
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    action: input_boolean.turn_off
                                alias: Spie Inquinanti ON Pdr OFF
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    action: input_boolean.turn_on
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti ON Pdr ON
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                alias: Spie Inquinanti OFF Pdr OFF
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti OFF Pdr ON
                        alias: Spia Free Heating ON o Spia Free Colling ON
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità 1
              - conditions:
                  - condition: or
                    conditions:
                      - alias: Velocità 2
                        condition: trigger
                        id:
                          - spia_velocita_2_congelamento
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          2'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_2_congelamento
                    action: input_boolean.turn_on
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                    action: input_boolean.turn_off
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                  - alias: Verifica Status Spie Inquinanti e Spie PdR
                    choose:
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti ON Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti ON Pdr OFF
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti OFF Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti OFF Pdr OFF
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità 2
              - conditions:
                  - condition: or
                    conditions:
                      - alias: Velocità 3
                        condition: trigger
                        id:
                          - spia_velocita_3_congelamento
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          3'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_3_congelamento
                    action: input_boolean.turn_on
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                    action: input_boolean.turn_off
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                  - alias: Verifica Status Spie Inquinanti e Spie PdR
                    choose:
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti ON Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti ON Pdr OFF
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti OFF Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti OFF Pdr OFF
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità 3
              - conditions:
                  - condition: or
                    conditions:
                      - alias: Velocità 4
                        condition: trigger
                        id:
                          - spia_velocita_4_congelamento
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                          4'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_velocita_4_congelamento
                    action: input_boolean.turn_on
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                    action: input_boolean.turn_off
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                  - alias: Verifica Status Spie Inquinanti e Spie PdR
                    choose:
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti ON Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti ON Pdr OFF
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti OFF Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti OFF Pdr OFF
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità 4
              - conditions:
                  - condition: or
                    conditions:
                      - alias: Velocità Iperventilazione
                        condition: trigger
                        id:
                          - spia_velocita_iperventilazione_congelamento
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                    action: input_boolean.turn_on
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                    action: input_boolean.turn_off
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                  - alias: Verifica Status Spie Inquinanti e Spie PdR
                    choose:
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti ON Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti ON Pdr OFF
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti OFF Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti OFF Pdr OFF
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità Iperventilazione
              - conditions:
                  - condition: or
                    conditions:
                      - alias: Velocità Notturna
                        condition: trigger
                        id:
                          - spia_velocita_notturna_congelamento
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_notturna_congelamento
                    action: input_boolean.turn_on
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                    action: input_boolean.turn_off
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                  - alias: Verifica Status Spie Inquinanti e Spie PdR
                    choose:
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti ON Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti ON Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                            action: input_boolean.turn_on
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti ON Pdr OFF
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr ON
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR ON
                                condition: template
                                value_template: >-
                                  {{
                                  states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                          - metadata: {}
                            data: {}
                            target:
                              entity_id: >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                            action: input_boolean.turn_on
                        alias: Spie Inquinanti OFF Pdr ON
                      - conditions:
                          - alias: Verifica se Inquinanti OFF Pdr OFF
                            condition: and
                            conditions:
                              - alias: Spie Inquinanti OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                  }}
                              - alias: Spie PdR OFF
                                condition: template
                                value_template: >-
                                  {{
                                  not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                  or
                                  states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                  }}
                        sequence:
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                - >-
                                  input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                            alias: Spie Inquinanti OFF
                            action: input_boolean.turn_off
                          - data: {}
                            target:
                              entity_id:
                                - >-
                                  input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                - >-
                                  input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                            alias: Spie PdR OFF
                            action: input_boolean.turn_off
                        alias: Spie Inquinanti OFF Pdr OFF
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità Notturna
              - conditions:
                  - condition: or
                    conditions:
                      - alias: Velocità Free Cooling/Free Heating
                        condition: trigger
                        id:
                          - spia_velocita_Free Cooling_congelamento
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                          Cooling'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id: >-
                        input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                    action: input_boolean.turn_on
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_velocita_0_congelamento
                        - input_boolean.vmc_master_spia_velocita_1_congelamento
                        - input_boolean.vmc_master_spia_velocita_2_congelamento
                        - input_boolean.vmc_master_spia_velocita_3_congelamento
                        - input_boolean.vmc_master_spia_velocita_4_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                        - >-
                          input_boolean.vmc_master_spia_velocita_notturna_congelamento
                    action: input_boolean.turn_off
                  - alias: Verifica Status Spia Free Cooling / Free Heating
                    choose:
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                              and
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                              }}
                        sequence:
                          - alias: Verifica Status Spie Inquinanti e Spie PdR
                            choose:
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    action: input_boolean.turn_on
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti ON Pdr ON
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    action: input_boolean.turn_on
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    action: input_boolean.turn_off
                                alias: Spie Inquinanti ON Pdr OFF
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti OFF Pdr ON
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                alias: Spie Inquinanti OFF Pdr OFF
                        alias: Spia Free Heating OFF e Spia Free Colling OFF
                      - conditions:
                          - condition: template
                            value_template: >-
                              {{
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                              or
                              states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                              }}
                        sequence:
                          - alias: Verifica Status Spie Inquinanti e Spie PdR
                            choose:
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    action: input_boolean.turn_on
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    action: input_boolean.turn_off
                                alias: Spie Inquinanti ON Pdr OFF
                              - conditions:
                                  - alias: Verifica se Inquinanti ON Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on'
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                    action: input_boolean.turn_on
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti ON Pdr ON
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr OFF
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on')
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                alias: Spie Inquinanti OFF Pdr OFF
                              - conditions:
                                  - alias: Verifica se Inquinanti OFF Pdr ON
                                    condition: and
                                    conditions:
                                      - alias: Spie Inquinanti OFF
                                        condition: template
                                        value_template: >-
                                          {{
                                          not(states('input_boolean.vmc_master_spia_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr')=='on')
                                          }}
                                      - alias: Spie PdR ON
                                        condition: template
                                        value_template: >-
                                          {{
                                          states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio')=='on'
                                          or
                                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'
                                          }}
                                sequence:
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                                        - >-
                                          input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                                    alias: Spie Inquinanti OFF
                                    action: input_boolean.turn_off
                                  - data: {}
                                    target:
                                      entity_id:
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                                        - >-
                                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio
                                    alias: Spie PdR OFF
                                    action: input_boolean.turn_off
                                  - metadata: {}
                                    data: {}
                                    target:
                                      entity_id: >-
                                        input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                                    action: input_boolean.turn_on
                                alias: Spie Inquinanti OFF Pdr ON
                        alias: Spia Free Heating ON o Spia Free Colling ON
                  - repeat:
                      sequence:
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Velocità FreeCooling/FreeHeating
        alias: Congelamento ON
      - conditions:
          - condition: trigger
            id:
              - Congelamento OFF
        sequence:
          - alias: Ripristino Velocità
            choose:
              - conditions:
                  - alias: Se Spia Velocità 0 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            0'}}
                alias: Spia Velocità 0 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 1 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: Spia Velocità 1 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 2 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_2
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            2'}}
                alias: Spia Velocità 2 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 3 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_3
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            3'}}
                alias: Spia Velocità 3 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità 4 per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_velocita_4
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            4'}}
                alias: Spia Velocità 4 per Congelamento
              - conditions:
                  - alias: Se Spia Velocità Iperventilazione per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_iperventilazione
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Iperventilazione'}}
                alias: Spia Velocità Iperventilazione per Congelamento
              - conditions:
                  - alias: Se Spia Velocità Notturna per Congelamento ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_notturna
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Notturna'}}
                alias: Spia Velocità Notturna per Congelamento
              - conditions:
                  - alias: >-
                      Se Spia Velocità FreeCooling/FreeHeating per Congelamento
                      ON
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                      'on'}}
                sequence:
                  - repeat:
                      sequence:
                        - alias: Ripeti Finchè Tutte le Spie Congelamento sono OFF
                          repeat:
                            sequence:
                              - data: {}
                                target:
                                  entity_id:
                                    - >-
                                      input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_0_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_1_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_2_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_3_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_4_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_notturna_congelamento
                                    - >-
                                      input_boolean.vmc_master_spia_velocita_freecooling_congelamento
                                action: input_boolean.turn_off
                            until:
                              - condition: template
                                value_template: >
                                  {{
                                  states('input_boolean.vmc_master_congelamento_verifica_soglia_valore_spia')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_0_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_1_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_2_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_3_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_4_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_notturna_congelamento')==
                                  'off' and 

                                  states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento')==
                                  'off' }}
                        - data: {}
                          action: shell_command.vmc_master_freecooling
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Free
                            Cooling'}}
                alias: Spia Velocità FreeCooling/FreeHeating per Congelamento
        alias: Congelamento OFF
      - conditions:
          - condition: trigger
            id:
              - >-
                Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON -
                Inquinanti OFF
        sequence:
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'}}
                    alias: >-
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      OFF e
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                      ON
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  OFF e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  ON
              - conditions:
                  - alias: >-
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                      ON e
                      vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                      OFF
                    condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  OFF
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto!= "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          == "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          OFF e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'}}
                      - alias: >-
                          Inquinante Vel. 1 ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  OFF e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  ON con PdR OFF e vmc_master_spia_velocita_1_co2_o_voc=ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio='on'
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto!= "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          == "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          OFF
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                      - alias: >-
                          Inquinante Vel. 1 ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio')=='on'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  OFF con PdR OFF e vmc_master_spia_velocita_1_co2_o_voc=ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio='on''
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto!= "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          != "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'}}
                        alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          ON e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          OFF
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  ON e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  OFF con PdR OFF
              - conditions:
                  - condition: and
                    conditions:
                      - alias: >-
                          vmc_master_punto_di_rugiada_verifica_confronto== "Se
                          ne sconsiglia l'impiego" e
                          vmc_master_opzioni_accendi_spegni_vmc_vs_pdr') == 'on'
                        condition: template
                        value_template: >-
                          {{states('sensor.vmc_master_punto_di_rugiada_verifica_confronto')
                          == "Se ne sconsiglia l'impiego" and
                          states('input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_pdr')
                          == 'on'}}
                      - alias: >-
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                          OFF e
                          vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                          ON
                        condition: template
                        value_template: >-
                          {{states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                          and
                          states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'}}
                sequence:
                  - metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                        - >-
                          input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                    action: input_boolean.turn_off
                alias: >-
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  OFF e
                  vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  ON con PdR ON
        alias: >-
          Cambio Velocità quanto Spia FreeHeating o FreeCooling è ON e se Spia
          Inquinanti OFF e se Spia Congelamento Off e Spia Delta Temp Off
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 0 con Spia FreeHeating On -> Imposta Velocità 0
        sequence:
          - repeat:
              sequence:
                - metadata: {}
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_on
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_0
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON se
          Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
          oppure OFF [Caso Velocità Free Heating]
      - conditions:
          - condition: trigger
            id:
              - PdR Vel. 0 con Spia FreeCooling On -> Imposta Velocità 0
        sequence:
          - repeat:
              sequence:
                - metadata: {}
                  data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling
                  action: input_boolean.turn_on
                - data: {}
                  target:
                    entity_id: >-
                      input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating
                  action: input_boolean.turn_off
                - data: {}
                  action: shell_command.vmc_master_velocita_0
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                    0'}}
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON se
          Spia Congelamento Off e Spia Delta Temp Off e se Spia Inquinanti ON
          oppure OFF [Caso Velocità Free Cooling]
      - conditions:
          - condition: trigger
            id:
              - >-
                PdR Vel. 0 con Spia FreeHeating On e Inquinanti Vel. 1 ON  ->
                Imposta Velocità 1
        sequence:
          - choose:
              - conditions:
                  - alias: VERIFICA SPIA ATTIVAZIONE FREE HEATING OFF
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='off'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE HEATING OFF
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating')=='on'
                      }}
                    alias: VERIFICA SPIA ATTIVAZIONE FREE HEATING ON
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE HEATING ON
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
          Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp
          Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Heating]
      - conditions:
          - condition: trigger
            id:
              - >-
                PdR Vel. 0 con Spia FreeCooling On e Inquinanti Vel. 1 ON  ->
                Imposta Velocità 1
        sequence:
          - choose:
              - conditions:
                  - alias: VERIFICA SPIA ATTIVAZIONE FREE COOLING ON
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='on'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE COOLING ON
              - conditions:
                  - alias: VERIFICA SPIA ATTIVAZIONE FREE COOLING OFF
                    condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling')=='off'
                      }}
                sequence:
                  - repeat:
                      sequence:
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr
                              - >-
                                input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0
                              - input_boolean.vmc_master_spia_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_co2_o_voc
                          action: input_boolean.turn_on
                        - data: {}
                          target:
                            entity_id:
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc
                              - >-
                                input_boolean.vmc_master_spia_velocita_0_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_1_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_2_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_3_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_4_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio
                              - >-
                                input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio
                          action: input_boolean.turn_off
                        - data: {}
                          action: shell_command.vmc_master_velocita_1
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')=='Velocità
                            1'}}
                alias: SPIA ATTIVAZIONE FREE COOLING OFF
        alias: >-
          Condizioni Sfavorevoli a Velocità 0 con Spia FreeCooling PdR ON e Spia
          Inquinamento Velocita' 1 ON se Spia Congelamento Off e Spia Delta Temp
          Off e se Spia Inquinanti ON oppure OFF [Caso Velocità Free Cooling]
      - conditions:
          - condition: trigger
            id:
              - >-
                VMC Master Elenco Entità Temperatura e Umidità installate in
                H.A.
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id:
                - script.vmc_master_aggiorna_elenco_entita_temperatura_esterna
                - script.vmc_master_aggiorna_elenco_entita_temperatura_interna
                - script.vmc_master_aggiorna_elenco_entita_umidita_esterna
                - script.vmc_master_aggiorna_elenco_entita_umidita_interna
                - script.vmc_master_aggiorna_elenco_entita_co2_interna
                - script.vmc_master_aggiorna_elenco_entita_notifica_dispositivo
        alias: >-
          Al Riavvio di Home Assistant Verifica se è impostata una Entità
          Temperatura, Umidità, Anidride Carbonica e Mobile installata in H.A.,
          tramite script
      - conditions:
          - condition: trigger
            id:
              - " Opzioni On"
              - VMC Master Save Selected Temperatura Esterna Entity
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_aggiorna_elenco_entita_temperatura_esterna
        alias: >-
          Quando Seleziona Entità Temperatura Esterna installata in H.A. cambia
          stato o qualsiasi attributo
      - conditions:
          - condition: trigger
            id:
              - VMC Master Save Selected Temperatura Interna Entity
              - " Opzioni On"
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_aggiorna_elenco_entita_temperatura_interna
        alias: >-
          Quando Seleziona Entità Temperatura Interna installata in H.A. cambia
          stato o qualsiasi attributo
      - conditions:
          - condition: trigger
            id:
              - " Opzioni On"
              - VMC Master Save Selected Umidità Esterna Entity
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_aggiorna_elenco_entita_umidita_esterna
        alias: >-
          Quando Seleziona Entità Umidità Esterna installata in H.A. cambia
          stato o qualsiasi attributo
      - conditions:
          - condition: trigger
            id:
              - " Opzioni On"
              - VMC Master Save Selected Umidità Interna Entity
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_aggiorna_elenco_entita_umidita_interna
        alias: >-
          Quando Seleziona Entità Umidità Interna installata in H.A. cambia
          stato o qualsiasi attributo
      - conditions:
          - condition: trigger
            id:
              - " Opzioni On"
              - VMC Master Save Selected CO2 Interna Entity
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_aggiorna_elenco_entita_co2_interna
        alias: >-
          Quando Seleziona Entità Anidride Carbonica Interna installata in H.A.
          cambia stato o qualsiasi attributo
      - conditions:
          - condition: trigger
            id:
              - " Opzioni On"
              - VMC Master Save Selected Dispositivo Interna Entity
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_aggiorna_elenco_entita_notifica_dispositivo
        alias: >-
          Quando Seleziona Dispositivo per Invio SMS installato in H.A. cambia
          stato o qualsiasi attributo
      - conditions:
          - condition: trigger
            id:
              - Opzioni Sub Sensori Opzionati On
        sequence:
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_scelta_sensori
            action: input_boolean.turn_on
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_elementi_chimici
            action: input_boolean.turn_off
        alias: >-
          Trigger Attivazione Sotto Finestra Opzioni - Finestra Sensori
          Opzionati
      - conditions:
          - condition: trigger
            id:
              - Opzioni Sub Sensori Opzionati Off
        sequence:
          - data: {}
            action: input_boolean.turn_off
            target:
              entity_id: input_boolean.vmc_master_opzioni_scelta_sensori
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Sensori
          Opzionati
      - conditions:
          - condition: trigger
            id:
              - Opzioni Sub Elementi Chimici On
        sequence:
          - data: {}
            action: input_boolean.turn_on
            target:
              entity_id: input_boolean.vmc_master_opzioni_elementi_chimici
          - data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_opzioni_calendario_main
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_calendario
                - input_boolean.vmc_master_opzioni_free_heating_o_free_cooling
                - input_boolean.vmc_master_opzioni_punto_di_rugiada
                - input_boolean.vmc_master_opzioni_scelta_sensori
            action: input_boolean.turn_off
        alias: Trigger Attivazione Sotto Finestra Opzioni - Finestra Elementi Chimici
      - conditions:
          - condition: trigger
            id:
              - Opzioni Sub Elementi Chimici Off
        sequence:
          - data: {}
            action: input_boolean.turn_off
            target:
              entity_id: input_boolean.vmc_master_opzioni_elementi_chimici
        alias: >-
          Trigger Disattivazione Sotto Finestra Opzioni - Finestra Elementi
          Chimici
      - conditions:
          - condition: trigger
            id:
              - Entità Temperatura Esterna Errore [Interfaccia]
        sequence:
          - action: persistent_notification.create
            metadata: {}
            data:
              title: VMC "{{ states('sensor.vmc_master_nome_status') }}"
              message: >-
                Non Disponibile: {{
                states('input_text.vmc_master_last_temp_external_entity') }}

                Impiegato per il rilevamento: {{
                state_attr('sensor.vmc_master_temp_esterna_status',
                'friendly_name') }}

                Data {{ now().strftime('%d-%m-%Y') }} Ora
                {{now().strftime('%H:%M:%S') }}
            enabled: true
        alias: >-
          Entità Temperatura Esterna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Interfaccia]
      - conditions:
          - condition: trigger
            id:
              - Entità Temperatura Interna Errore [Interfaccia]
        sequence:
          - action: persistent_notification.create
            metadata: {}
            data:
              title: VMC "{{ states('sensor.vmc_master_nome_status') }}"
              message: >-
                Non Disponibile: {{
                states('input_text.vmc_master_last_temp_internal_entity') }}

                Impiegato per il rilevamento: {{
                state_attr('sensor.vmc_master_temp_interna_status',
                'friendly_name') }}

                Data {{ now().strftime('%d-%m-%Y') }} Ora
                {{now().strftime('%H:%M:%S') }}
            enabled: true
        alias: >-
          Entità Temperatura Interna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Interfaccia]
      - conditions:
          - condition: trigger
            id:
              - Entità Umidità Esterna Errore [Interfaccia]
        sequence:
          - action: persistent_notification.create
            metadata: {}
            data:
              title: VMC "{{ states('sensor.vmc_master_nome_status') }}"
              message: >-
                Non Disponibile: {{
                states('input_text.vmc_master_last_humidity_external_entity') }}

                Impiegato per il rilevamento: {{
                state_attr('sensor.vmc_master_umidita_esterna_status',
                'friendly_name') }}

                Data {{ now().strftime('%d-%m-%Y') }} Ora
                {{now().strftime('%H:%M:%S') }}
            enabled: true
        alias: >-
          Entità Umidità Esterna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Interfaccia]
      - conditions:
          - condition: trigger
            id:
              - Entità Umidità Interna Errore [Interfaccia]
        sequence:
          - action: persistent_notification.create
            metadata: {}
            data:
              title: VMC "{{ states('sensor.vmc_master_nome_status') }}"
              message: >-
                Non Disponibile: {{
                states('input_text.vmc_master_last_humidity_internal_entity') }}

                Impiegato per il rilevamento: {{
                state_attr('sensor.vmc_master_umidita_interna_status',
                'friendly_name') }}

                Data {{ now().strftime('%d-%m-%Y') }} Ora
                {{now().strftime('%H:%M:%S') }}
            enabled: true
        alias: >-
          Entità Umidità Interna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Interfaccia]
      - conditions:
          - condition: trigger
            id:
              - Entità CO2 Interna Errore [Interfaccia]
        sequence:
          - action: persistent_notification.create
            metadata: {}
            data:
              title: VMC "{{ states('sensor.vmc_master_nome_status') }}"
              message: >-
                Non Disponibile: {{
                states('input_text.vmc_master_last_co2_internal_entity') }}

                Impiegato per il rilevamento: {{
                state_attr('sensor.vmc_master_co2_status', 'friendly_name') }}

                Data {{ now().strftime('%d-%m-%Y') }} Ora
                {{now().strftime('%H:%M:%S') }}
            enabled: true
        alias: >-
          Entità CO₂ Interna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Interfaccia]
      - conditions:
          - condition: trigger
            id:
              - Avviso Cambio Filtro
          - condition: template
            value_template: >-
              {{ (
              states('sensor.vmc_master_status_led_pannello_lettura_codice_interpretato')=='Verificare
              Filtro' and states('vmc_master_status_ip_interfaccia')=='ON-Line')
              }}
            alias: Verifica se il Filtro deve essere cambiato
        sequence:
          - action: persistent_notification.create
            metadata: {}
            data:
              title: VMC "{{ states('sensor.vmc_master_nome_status') }}"
              message: >-
                Avviso ogni 24 ore: Verificare Filtro, data {{
                now().strftime('%d-%m-%Y') }}, ore {{ now().strftime('%H:%M:%S')
                }}
        alias: >-
          Verifica ogni Giorno alle 08:00 del Mattino se il Filtro deve essere
          cambiato [Interfaccia]
      - conditions:
          - condition: and
            conditions:
              - condition: trigger
                id:
                  - Avviso Cambio Filtro [Mobile]
              - alias: Verifica se il Filtro deve essere cambiato
                condition: template
                value_template: >-
                  {{
                  states('sensor.vmc_master_status_led_pannello_lettura_codice_interpretato')=='Verificare
                  Filtro' and
                  states('input_boolean.vmc_master_notifica_status_vmc')=='on'}}
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_cambio_filtro
        alias: >-
          Verifica ogni Giorno alle 08:00 del Mattino se il Filtro deve essere
          cambiato [MOBILE]
      - conditions:
          - condition: trigger
            id:
              - VMC Velocità 0 da Notificare
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_velocita_0
        alias: VMC Velocità 0 da Notificare [MOBILE]
      - conditions:
          - condition: trigger
            id:
              - VMC Velocità in Funzione da Notificare
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_velocita_diversa_da_0
        alias: VMC Velocità in Funzione da Notificare [MOBILE]
      - conditions:
          - condition: trigger
            id:
              - Entità Temperatura Esterno Errore [Mobile]
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_errore_temp_esterna
        alias: >-
          Entità Temperatura Esterna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Mobile]
      - conditions:
          - condition: trigger
            id:
              - Entità Temperatura Interna Errore [Mobile]
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_errore_temp_interna
        alias: >-
          Entità Temperatura Interna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Mobile]
      - conditions:
          - condition: trigger
            id:
              - Entità Umidità Esterna Errore [Mobile]
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_errore_umidita_esterna
        alias: >-
          Entità Umidità Esterna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Mobile]
      - conditions:
          - condition: trigger
            id:
              - Entità Umidità Interna Errore [Mobile]
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_errore_umidita_interna
        alias: >-
          Entità Umidità Interna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Mobile]
      - conditions:
          - condition: trigger
            id:
              - Entità CO2 Interna Errore [Mobile]
        sequence:
          - action: script.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: script.vmc_master_notifica_errore_co2_interna
        alias: >-
          Entità CO₂ Interna installata in H.A. cambia in ['unknown',
          'unavailable', '-100', 'Non disponibile'] [Mobile]
      - conditions:
          - condition: trigger
            id:
              - pannello_avvisi_problema
        sequence:
          - data: {}
            action: script.vmc_master_upgrade_sensors
      - conditions:
          - condition: trigger
            id:
              - spia_umidita_on
        sequence:
          - action: input_boolean.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: input_boolean.vmc_master_umidita_verifica_soglia_valore_spia
          - if:
              - condition: template
                value_template: >-
                  {{
                  states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                  == 'Velocità 0'}}
            then:
              - choose:
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Velocità 0' }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_0
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 0' }}
                    alias: Velocità 0
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Velocità 1' }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_1
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 1' }}
                    alias: Velocità 1
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Velocità 2' }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_2
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 2' }}
                    alias: Velocità 2
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Velocità 3' }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_3
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 3' }}
                    alias: Velocità 3
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Velocità 4' }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_4
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 4' }}
                    alias: Velocità 4
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Notturna' }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_notturna
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Notturna' }}
                    alias: Velocità Notturna
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Free Cool./Heat.' and
                            not (
                              states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                                "Allerta Free Heating Programmato (Raffrescamento in atto)",
                                "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                                "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                                "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                                "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                                "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                                "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                                "Allerta Raffrescamento in atto",
                                "Allerta Riscaldamento in atto",
                                "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                                "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
                              ]
                            )
                          }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_freecooling
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Free Cooling' }}
                    alias: Velocità Free Cooling senza Allerte
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Free Cool./Heat.' and
                             (
                              states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                                "Allerta Free Heating Programmato (Raffrescamento in atto)",
                                "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                                "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                                "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                                "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                                "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                                "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                                "Allerta Raffrescamento in atto",
                                "Allerta Riscaldamento in atto",
                                "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                                "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                                "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                                "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
                              ]
                            )
                          }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_1
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 1' }}
                    alias: Velocità Free Cooling con Allerte -> Velocità 1
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{ states('input_select.vmc_master_speed_umidita') ==
                          'Iperventilazione' }}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_iperventilazione
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Iperventilazione' }}
                    alias: Velocità Iperventilazione
            else:
              - choose:
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                          == 'Velocità 1'}}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_1
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_0
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_1
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 1' }}
                    alias: Velocità 1
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                          == 'Velocità 2'}}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_2
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_0
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_2
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 2' }}
                    alias: Velocità 2
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                          == 'Velocità 3'}}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_3
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_0
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_3
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 3' }}
                    alias: Velocità 3
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                          == 'Velocità 4'}}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: input_boolean.vmc_master_spia_umidita_velocita_4
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_0
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_velocita_4
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Velocità 4' }}
                    alias: Velocità 4
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                          == 'Notturna'}}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_umidita_velocita_notturna
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_0
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_notturna
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Notturna' }}
                    alias: Velocità Notturna
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                          == 'Free Cooling'}}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_0
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_freecooling
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Free Cooling' }}
                    alias: Velocità Free Cooling
                  - conditions:
                      - condition: template
                        value_template: >-
                          {{
                          states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                          == 'Iperventilazione'}}
                    sequence:
                      - action: input_boolean.turn_on
                        metadata: {}
                        data: {}
                        target:
                          entity_id: >-
                            input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                      - action: input_boolean.turn_off
                        metadata: {}
                        data: {}
                        target:
                          entity_id:
                            - input_boolean.vmc_master_spia_umidita_velocita_0
                            - input_boolean.vmc_master_spia_umidita_velocita_1
                            - input_boolean.vmc_master_spia_umidita_velocita_2
                            - input_boolean.vmc_master_spia_umidita_velocita_3
                            - input_boolean.vmc_master_spia_umidita_velocita_4
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_notturna
                            - >-
                              input_boolean.vmc_master_spia_umidita_velocita_freecooling
                      - repeat:
                          sequence:
                            - action: shell_command.vmc_master_iperventilazione
                              metadata: {}
                              data: {}
                            - delay:
                                hours: 0
                                minutes: 0
                                seconds: 5
                                milliseconds: 0
                          until:
                            - condition: template
                              value_template: >-
                                {{
                                states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                                == 'Iperventilazione' }}
                    alias: Velocità Iperventilazione
                enabled: true
        alias: >-
          Spia Umidità ON [SOLO SE LA VELOCITA' 0 E NON CI SONO ALTRE ALLERTE E
          FUORI DAL CALENDARIO] -> Velocità Impostata
      - conditions:
          - condition: trigger
            id:
              - spia_umidita_off
        sequence:
          - action: input_boolean.turn_off
            metadata: {}
            data: {}
            target:
              entity_id: input_boolean.vmc_master_umidita_verifica_soglia_valore_spia
          - choose:
              - conditions:
                  - condition: template
                    value_template: >-
                      {{states('input_boolean.vmc_master_spia_umidita_velocita_0')=='on'}}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_velocita_0
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Velocità 0' }}
                alias: Velocità 0
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_umidita_velocita_1')
                      == 'on' }}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_velocita_1
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Velocità 1' }}
                alias: Velocità 1
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_umidita_velocita_2')
                      == 'on' }}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_velocita_2
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Velocità 2' }}
                alias: Velocità 2
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_umidita_velocita_3')
                      == 'on' }}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_velocita_3
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Velocità 3' }}
                alias: Velocità 3
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_umidita_velocita_4')
                      == 'on' }}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_velocita_4
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Velocità 4' }}
                alias: Velocità 4
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_umidita_velocita_notturna')
                      == 'on' }}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_notturna
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Notturna' }}
                alias: Velocità Notturna
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_umidita_velocita_freecooling')
                      == 'on' }}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_freecooling
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Free Cooling' }}
                alias: Velocità Free Cooling
              - conditions:
                  - condition: template
                    value_template: >-
                      {{
                      states('input_boolean.vmc_master_spia_umidita_velocita_iperventilazione')
                      == 'on' }}
                sequence:
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_iperventilazione
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Iperventilazione' }}
                alias: Velocità Iperventilazione
        alias: " Spia Umidità OFF  [SOLO SE NON CI SONO ALTRE ALLERTE E FUORI DAL CALENDARIO]"
      - conditions:
          - condition: trigger
            id:
              - " Disattivazione Umidità Limite, precedentemente Armato ed Attivato"
        sequence:
          - if:
              - condition: template
                value_template: |-
                  {{ 
                    states('sensor.vmc_master_status_ip_interfaccia') == 'ON-Line' and
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia') != 'Non disponibile' and
                    (
                      states('input_boolean.vmc_master_spia_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_co2_o_voc_partenza_ritorno_velocita_0') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_0_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_co2_o_voc') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_co2_o_voc_pdr') == 'off' and

                      states('input_boolean.vmc_master_spia_velocita_0_un_solo_avvio') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_un_solo_avvio') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_un_solo_avvio') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_un_solo_avvio') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_un_solo_avvio') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_un_solo_avvio') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_un_solo_avvio') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio') == 'off'
                    ) and

                    (
                      states('input_boolean.vmc_master_spia_velocita_0_congelamento') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_congelamento') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_congelamento') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_congelamento') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_congelamento') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_congelamento') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_congelamento') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_congelamento') == 'off' and

                      states('input_boolean.vmc_master_spia_velocita_0_delta_temp_verifica_soglia_valore') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1_delta_temp_verifica_soglia_valore') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2_delta_temp_verifica_soglia_valore') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_3_delta_temp_verifica_soglia_valore') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_4_delta_temp_verifica_soglia_valore') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione_delta_temp_verifica_soglia_valore') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna_delta_temp_verifica_soglia_valore') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling_delta_temp_verifica_soglia_valore') == 'off'
                    ) and

                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freecooling') == 'off' and
                    states('input_boolean.vmc_master_spia_velocita_freecooling_un_solo_avvio_per_programmazione_freeheating') == 'off' and

                    (
                      states('input_boolean.vmc_master_spia_velocita_0') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_1') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_2') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_3') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_4') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_notturna') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_freecooling') == 'off' and
                      states('input_boolean.vmc_master_spia_velocita_iperventilazione') == 'off'
                    ) and

                    (
                      states('input_boolean.vmc_master_spia_calendario_lunedi_1') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_lunedi_2') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_martedi_1') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_martedi_2') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_mercoledi_1') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_mercoledi_2') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_giovedi_1') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_giovedi_2') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_venerdi_1') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_venerdi_2') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_sabato_1') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_sabato_2') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_domenica_1') == 'off' and
                      states('input_boolean.vmc_master_spia_calendario_domenica_2') == 'off'
                    )
                  }}
            then:
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_umidita_verifica_soglia_valore_spia
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_0
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
              - repeat:
                  sequence:
                    - action: shell_command.vmc_master_velocita_0
                      metadata: {}
                      data: {}
                    - delay:
                        hours: 0
                        minutes: 0
                        seconds: 5
                        milliseconds: 0
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                        == 'Velocità 0' }}
            else:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_master_opzioni_accendi_spegni_vmc_vs_umidita
        alias: >-
          Quando VMC ON/OFF, in Funzione dell'Umidità Interna cambia da Acceso/a
          a Spento/a [SOLO SE NON CI SONO ALTRE ALLERTE E FUORI DAL CALENDARIO]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_0
        sequence:
          - action: input_boolean.turn_on
            metadata: {}
            data: {}
            target:
              entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
          - action: input_boolean.turn_off
            metadata: {}
            data: {}
            target:
              entity_id:
                - input_boolean.vmc_master_spia_umidita_velocita_1
                - input_boolean.vmc_master_spia_umidita_velocita_2
                - input_boolean.vmc_master_spia_umidita_velocita_3
                - input_boolean.vmc_master_spia_umidita_velocita_4
                - input_boolean.vmc_master_spia_umidita_velocita_notturna
                - >-
                  input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                - input_boolean.vmc_master_spia_umidita_velocita_freecooling
          - repeat:
              sequence:
                - action: shell_command.vmc_master_velocita_0
                  metadata: {}
                  data: {}
                - delay:
                    hours: 0
                    minutes: 0
                    seconds: 5
                    milliseconds: 0
              until:
                - condition: template
                  value_template: >-
                    {{
                    states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                    == 'Velocità 0' }}
        alias: Umidità ON Vel. 0 [Spia Umidità ON]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_1
        sequence:
          - choose:
              - conditions:
                  - alias: >-
                      Non Ci sono Allerte Free Cool./Heat. E Selettore Velocità
                      Umidità == Free Cool./Heat.
                    condition: template
                    value_template: >-
                      {{ (states('input_select.vmc_master_speed_umidita') ==
                      'Free Cool./Heat.' and
                        not (
                          states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                            "Allerta Free Heating Programmato (Raffrescamento in atto)",
                            "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                            "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                            "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                            "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                            "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                            "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                            "Allerta Raffrescamento in atto",
                            "Allerta Riscaldamento in atto",
                            "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                            "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                            "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                            "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                            "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                            "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
                          ]
                        )) and (states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato'))
                      }}
                sequence:
                  - action: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_umidita_velocita_1
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_freecooling
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Free Cooling' }}
                alias: >-
                  Non Ci sono Allerte Free Cool./Heat. E Selettore Velocità
                  Umidità == Free Cool./Heat.
              - conditions:
                  - alias: >-
                      Ci sono Allerte Free Cool./Heat. E Selettore Velocità
                      Umidità == Free Cool./Heat.
                    condition: template
                    value_template: >-
                      {{ (states('input_select.vmc_master_speed_umidita') ==
                      'Free Cool./Heat.' and
                        (
                          states('sensor.vmc_master_alert_monitoraggio_free_heating_o_free_cooling_allert_interfaccia_avvisi') in [
                            "Allerta Free Heating Programmato (Raffrescamento in atto)",
                            "Allerta Free Heating Programmato (Raffrescamento in atto, Presenza di Inquinanti)",
                            "Allerta Free Heating Programmato (Raffrescamento Arrestato, Presenza di Inquinanti)",
                            "Allerta Free Cooling Programmato (Riscaldamento in atto)",
                            "Allerta Free Cooling Programmato (Riscaldamento Arrestato)",
                            "Allerta Free Cooling Programmato (Riscaldamento Arrestato, Presenza di Inquinanti)",
                            "Allerta Free Cooling Programmato (Riscaldamento in atto, Presenza di Inquinanti)",
                            "Allerta Raffrescamento in atto",
                            "Allerta Riscaldamento in atto",
                            "Allerta Riscaldamento in atto, Presenza di Inquinanti",
                            "Allerta Raffrescamento in atto, Presenza di Inquinanti",
                            "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento)",
                            "Non Avviare in Velocità Free Heating Programmato (Allerta Raffrescamento, Presenza di Inquinanti)",
                            "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento)",
                            "Non Avviare in Velocità Free Cooling Programmato (Allerta Riscaldamento, Presenza di Inquinanti)"
                          ]
                        )) and (states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato'))
                      }}
                sequence:
                  - action: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_velocita_1
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Velocità 1' }}
                alias: >-
                  Ci sono Allerte Free Cool./Heat. E Selettore Velocità Umidità
                  == Free Cool./Heat.
              - conditions:
                  - alias: >-
                      locità Umidità != Free Cool./Heat. E Seletore Velocità
                      Umidità != Velocità 1
                    condition: template
                    value_template: >-
                      {{states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')}}
                sequence:
                  - action: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_umidita_velocita_1
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_0
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                  - repeat:
                      sequence:
                        - action: shell_command.vmc_master_velocita_1
                          metadata: {}
                          data: {}
                        - delay:
                            hours: 0
                            minutes: 0
                            seconds: 5
                            milliseconds: 0
                      until:
                        - condition: template
                          value_template: >-
                            {{
                            states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                            == 'Velocità 1' }}
                alias: >-
                  Selettore Velocità Umidità != Free Cool./Heat. E Seletore
                  Velocità Umidità != Velocità 1
              - conditions:
                  - alias: >-
                      locità Umidità != Free Cool./Heat. E Seletore Velocità
                      Umidità == Velocità 1
                    condition: template
                    value_template: >-
                      {{states('input_select.vmc_master_speed_umidita')==states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')}}
                sequence:
                  - action: input_boolean.turn_on
                    metadata: {}
                    data: {}
                    target:
                      entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
                  - action: input_boolean.turn_off
                    metadata: {}
                    data: {}
                    target:
                      entity_id:
                        - input_boolean.vmc_master_spia_umidita_velocita_1
                        - input_boolean.vmc_master_spia_umidita_velocita_2
                        - input_boolean.vmc_master_spia_umidita_velocita_3
                        - input_boolean.vmc_master_spia_umidita_velocita_4
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_notturna
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                        - >-
                          input_boolean.vmc_master_spia_umidita_velocita_freecooling
                alias: >-
                  Selettore Velocità Umidità != Free Cool./Heat. E Seletore
                  Velocità Umidità == Velocità 1
        alias: Umidità ON Vel. 1 [Spia Umidità ON]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_2
        sequence:
          - if:
              - condition: template
                value_template: >-
                  {{states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')}}
                enabled: true
            then:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_2
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_0
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
              - repeat:
                  sequence:
                    - action: shell_command.vmc_master_velocita_2
                      metadata: {}
                      data: {}
                    - delay:
                        hours: 0
                        minutes: 0
                        seconds: 5
                        milliseconds: 0
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                        == 'Velocità 2' }}
            else:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
        alias: Umidità ON Vel. 2 [Spia Umidità ON]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_3
        sequence:
          - if:
              - condition: template
                value_template: >-
                  {{states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')}}
                enabled: true
            then:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_3
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_0
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
              - repeat:
                  sequence:
                    - action: shell_command.vmc_master_velocita_3
                      metadata: {}
                      data: {}
                    - delay:
                        hours: 0
                        minutes: 0
                        seconds: 5
                        milliseconds: 0
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                        == 'Velocità 3' }}
            else:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
        alias: Umidità ON Vel. 3 [Spia Umidità ON]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_4
        sequence:
          - if:
              - condition: template
                value_template: >-
                  {{states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')}}
                enabled: true
            then:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_4
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_0
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
              - repeat:
                  sequence:
                    - action: shell_command.vmc_master_velocita_4
                      metadata: {}
                      data: {}
                    - delay:
                        hours: 0
                        minutes: 0
                        seconds: 5
                        milliseconds: 0
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                        == 'Velocità 4' }}
            else:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
        alias: Umidità ON Vel. 4 [Spia Umidità ON]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_notturna
        sequence:
          - if:
              - condition: template
                value_template: >-
                  {{states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')}}
                enabled: true
            then:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_notturna
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_0
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
              - repeat:
                  sequence:
                    - action: shell_command.vmc_master_notturna
                      metadata: {}
                      data: {}
                    - delay:
                        hours: 0
                        minutes: 0
                        seconds: 5
                        milliseconds: 0
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                        == 'Notturna' }}
            else:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
        alias: Umidità ON Vel. Notturna [Spia Umidità ON]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_iperventilazione
        sequence:
          - if:
              - condition: template
                value_template: >-
                  {{states('input_select.vmc_master_speed_umidita')!=states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')}}
                enabled: true
            then:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: >-
                    input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_0
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
              - repeat:
                  sequence:
                    - action: shell_command.vmc_master_iperventilazione
                      metadata: {}
                      data: {}
                    - delay:
                        hours: 0
                        minutes: 0
                        seconds: 5
                        milliseconds: 0
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                        == 'Iperventilazione' }}
            else:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
        alias: Umidità ON Vel. Iperventilazione [Spia Umidità ON]
      - conditions:
          - condition: trigger
            id:
              - umidita_velocita_free_cooling
        sequence:
          - if:
              - condition: template
                enabled: true
                value_template: >-
                  {{
                  states('sensor.vmc_master_status_ventola_lettura_codice_interpretato_interfaccia')
                  in [
                    'Free Cooling', 
                    'Free Heating', 
                    'Free Cool./Heat.'] and states('input_select.vmc_master_speed_umidita') == 'Free Cool./Heat.' }}
            then:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_0
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
                    - input_boolean.vmc_master_spia_umidita_velocita_freecooling
            else:
              - action: input_boolean.turn_on
                metadata: {}
                data: {}
                target:
                  entity_id: input_boolean.vmc_master_spia_umidita_velocita_freecooling
              - action: input_boolean.turn_off
                metadata: {}
                data: {}
                target:
                  entity_id:
                    - input_boolean.vmc_master_spia_umidita_velocita_0
                    - input_boolean.vmc_master_spia_umidita_velocita_1
                    - input_boolean.vmc_master_spia_umidita_velocita_2
                    - input_boolean.vmc_master_spia_umidita_velocita_3
                    - input_boolean.vmc_master_spia_umidita_velocita_4
                    - input_boolean.vmc_master_spia_umidita_velocita_notturna
                    - >-
                      input_boolean.vmc_master_spia_umidita_velocita_iperventilazione
              - repeat:
                  sequence:
                    - action: shell_command.vmc_master_freecooling
                      metadata: {}
                      data: {}
                    - delay:
                        hours: 0
                        minutes: 0
                        seconds: 5
                        milliseconds: 0
                  until:
                    - condition: template
                      value_template: >-
                        {{
                        states('sensor.vmc_master_status_ventola_lettura_codice_interpretato')
                        == 'Free Cooling' }}
        alias: Umidità ON Vel. Free Cooling [Spia Umidità ON]
mode: restart
